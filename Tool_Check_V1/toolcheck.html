<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Tool Check - Ch·∫•m Call</title>
    <link rel="stylesheet" href="style.css">
    <!-- SheetJS library for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>

<body>

    <div class="container">
        <div class="header-bar">
            <h2>üîß Tool Check - Ch·∫•m Call</h2>
            <a href="Index.html" class="btn-back">‚Üê Quay l·∫°i</a>
        </div>

        <div class="table-wrapper">
            <table class="toolcheck-table" id="toolcheck-table">
                <thead id="tc-head"></thead>
                <tbody id="tc-body"></tbody>
            </table>
        </div>

        <!-- B·∫£ng k·∫øt qu·∫£ ch·∫•m ƒëi·ªÉm -->
        <div class="results-section">
            <h3>üìä K·∫øt Qu·∫£ Ch·∫•m ƒêi·ªÉm</h3>
            <div class="results-actions">
                <button class="btn-clear-results" onclick="clearResults()">üóëÔ∏è X√≥a t·∫•t c·∫£</button>
                <button class="btn-export" onclick="exportResults()">üì• Xu·∫•t Excel</button>
            </div>
            <div class="table-wrapper">
                <table class="results-table" id="results-table">
                    <thead id="results-head">
                        <tr>
                            <th>STT</th>
                            <th>Th·ªùi gian</th>
                            <th>Th√¥ng tin cu·ªôc g·ªçi</th>
                            <th>T·ªïng ƒëi·ªÉm</th>
                            <th>Thang ƒëi·ªÉm</th>
                            <th>ƒêi·ªÉm chi ti·∫øt</th>
                            <th>L·ªói vi ph·∫°m</th>
                            <th>Ghi ch√∫</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody id="results-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal Ch·∫•m Call -->
    <div id="chamcallModal" class="chamcall-modal">
        <div class="chamcall-modal-content scoring-modal">
            <h3>üìû Ch·∫•m Call - HEART Model</h3>
            <div class="row-info" id="modal-row-info">
                <!-- Th√¥ng tin d√≤ng s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
            </div>

            <!-- B·∫£ng ch·∫•m ƒëi·ªÉm -->
            <div class="scoring-table-wrapper">
                <table class="scoring-table">
                    <thead>
                        <tr>
                            <th class="col-model">Model</th>
                            <th class="col-tieuchi">Ti√™u ch√≠</th>
                            <th class="col-diengiai">Di·ªÖn Gi·∫£i</th>
                            <th class="col-input">Thang ƒêi·ªÉm</th>
                            <th class="col-score-value">ƒêi·ªÉm</th>
                            <th class="col-errors">Ch·ªçn l·ªói</th>
                            <th class="col-note-error">Note L·ªói</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Heart Touching - M·ªü l√≤ng ƒë√≥n - Ch·∫°m tr√°i tim -->
                        <tr class="model-header heart-touching">
                            <td rowspan="4" class="model-cell">
                                <div class="model-name">Heart Touching</div>
                                <div class="model-vn">M·ªü l√≤ng ƒë√≥n - Ch·∫°m tr√°i tim</div>
                            </td>
                            <td>1.1. Ch√†o m·ªü ƒë·∫ßu</td>
                            <td class="diengiai-cell">S·ª≠ d·ª•ng c√¢u ch√†o chu·∫©n, th√°i ƒë·ªô th√¢n thi·ªán, ni·ªÅm n·ªü</td>
                            <td><select class="score-select" data-criteria="1.1" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="1.1">
                                    <label><input type="checkbox" value="khong_chao"> Kh√¥ng ch√†o ƒë√∫ng
                                        chu·∫©n</label>
                                    <label><input type="checkbox" value="giong_moi"> Gi·ªçng m·ªát m·ªèi</label>
                                    <label><input type="checkbox" value="thieu_than_thien"> Thi·∫øu th√¢n
                                        thi·ªán</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="1.1"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="heart-touching">
                            <td>1.2. L·∫Øng nghe</td>
                            <td class="diengiai-cell">L·∫Øng nghe v√† ti·∫øp nh·∫≠n x√°c nh·∫≠n th√¥ng tin KH cung c·∫•p</td>
                            <td><select class="score-select" data-criteria="1.2" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="1.2">
                                    <label><input type="checkbox" value="cat_loi"> C·∫Øt l·ªùi KH</label>
                                    <label><input type="checkbox" value="khong_lang_nghe"> Kh√¥ng l·∫Øng
                                        nghe</label>
                                    <label><input type="checkbox" value="hieu_sai"> Hi·ªÉu sai √Ω KH</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="1.2"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="heart-touching">
                            <td>2.1. Ng√¥n t·ª´</td>
                            <td class="diengiai-cell">S·ª≠ d·ª•ng ng√¥n t·ª´ t√≠ch c·ª±c, d·ªÖ hi·ªÉu, th·ªÉ hi·ªán s·ª± k·∫øt n·ªëi
                            </td>
                            <td><select class="score-select" data-criteria="2.1" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="2.1">
                                    <label><input type="checkbox" value="ngon_tu_tieu_cuc"> Ng√¥n t·ª´ ti√™u
                                        c·ª±c</label>
                                    <label><input type="checkbox" value="kho_hieu"> Kh√≥ hi·ªÉu</label>
                                    <label><input type="checkbox" value="chuyen_nganh"> D√πng thu·∫≠t ng·ªØ chuy√™n
                                        ng√†nh</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="2.1"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="heart-touching">
                            <td>2.2. Ng·ªØ ƒëi·ªáu/Gi·ªçng n√≥i</td>
                            <td class="diengiai-cell">Ph√°t √¢m r√µ r√†ng, t·ªëc ƒë·ªô ph√π h·ª£p, ng·ªØ ƒëi·ªáu ƒë√∫ng</td>
                            <td><select class="score-select" data-criteria="2.2" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="2.2">
                                    <label><input type="checkbox" value="noi_nhanh"> N√≥i qu√° nhanh</label>
                                    <label><input type="checkbox" value="noi_cham"> N√≥i qu√° ch·∫≠m</label>
                                    <label><input type="checkbox" value="giong_buon"> Gi·ªçng bu·ªìn/m·ªát</label>
                                    <label><input type="checkbox" value="phat_am_sai"> Ph√°t √¢m kh√¥ng r√µ</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="2.2"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>

                        <!-- Empathy - Nghe t·ª´ t√¢m - Hi·ªÉu tr·ªçn c·∫£m -->
                        <tr class="model-header empathy">
                            <td rowspan="2" class="model-cell">
                                <div class="model-name">Empathy</div>
                                <div class="model-vn">Nghe t·ª´ t√¢m - Hi·ªÉu tr·ªçn c·∫£m</div>
                            </td>
                            <td>2.3. Th·∫•u hi·ªÉu</td>
                            <td class="diengiai-cell">Nh·∫≠n bi·∫øt v√† th·ªÉ hi·ªán s·ª± k·∫øt n·ªëi ph√π h·ª£p v·ªõi t√¨nh hu·ªëng,
                                c·∫£m
                                x√∫c
                                c·ªßa KH</td>
                            <td><select class="score-select" data-criteria="2.3" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="2.3">
                                    <label><input type="checkbox" value="thieu_dong_cam"> Thi·∫øu ƒë·ªìng c·∫£m</label>
                                    <label><input type="checkbox" value="phan_hoi_may_moc"> Ph·∫£n h·ªìi m√°y
                                        m√≥c</label>
                                    <label><input type="checkbox" value="khong_thau_hieu"> Kh√¥ng th·∫•u hi·ªÉu v·∫•n
                                        ƒë·ªÅ</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="2.3"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="empathy">
                            <td>2.4. G·ª£i t√™n KH/ x∆∞ng h√¥ ph√π h·ª£p</td>
                            <td class="diengiai-cell">G·ªçi t√™n KH/ x∆∞ng ph√π h·ª£p trong qu√° tr√¨nh giao ti·∫øp</td>
                            <td><select class="score-select" data-criteria="2.4" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="2.4">
                                    <label><input type="checkbox" value="khong_goi_ten"> Kh√¥ng g·ªçi t√™n
                                        KH</label>
                                    <label><input type="checkbox" value="xung_ho_sai"> X∆∞ng h√¥ kh√¥ng ph√π
                                        h·ª£p</label>
                                    <label><input type="checkbox" value="goi_sai_ten"> G·ªçi sai t√™n KH</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="2.4"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>

                        <!-- Attractive Actions - V√πng ƒë·ªông h√†nh - Gi·ªØ t·ª±a t√¢m -->
                        <tr class="model-header attractive">
                            <td rowspan="2" class="model-cell">
                                <div class="model-name">Attractive Actions</div>
                                <div class="model-vn">V√πng ƒë·ªông h√†nh - Gi·ªØ t·ª±a t√¢m</div>
                            </td>
                            <td>3.1. Qu·∫£n l√Ω cu·ªôc g·ªçi</td>
                            <td class="diengiai-cell">Ch·ªß ƒë·ªông h·ªó tr·ª£, gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ m·ªôt c√°ch t√≠ch c·ª±c</td>
                            <td><select class="score-select" data-criteria="3.1" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="3.1">
                                    <label><input type="checkbox" value="hold_lau"> Hold qu√° l√¢u</label>
                                    <label><input type="checkbox" value="khong_thong_bao"> Kh√¥ng th√¥ng b√°o khi
                                        hold</label>
                                    <label><input type="checkbox" value="chuyen_nhieu_lan"> Chuy·ªÉn m√°y nhi·ªÅu
                                        l·∫ßn</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="3.1"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="attractive">
                            <td>3.2. Nh·∫≠p li·ªáu</td>
                            <td class="diengiai-cell">Nh·∫≠p l·ªáu kh√¥ng ch√≠nh x√°c, nh·∫≠p l·ªáu tr√™n h·ªá th·ªëng ƒë√∫ng quy
                                ƒë·ªãnh
                            </td>
                            <td><select class="score-select" data-criteria="3.2" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="N/A">N/A</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="3.2">
                                    <label><input type="checkbox" value="nhap_sai"> Nh·∫≠p li·ªáu sai</label>
                                    <label><input type="checkbox" value="thieu_thong_tin"> Thi·∫øu th√¥ng
                                        tin</label>
                                    <label><input type="checkbox" value="khong_cap_nhat"> Kh√¥ng c·∫≠p nh·∫≠t h·ªá
                                        th·ªëng</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="3.2"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>

                        <!-- Reliable Resolution - Trao gi·∫£i ph√°p - Nh·∫≠n tin c·∫≠y -->
                        <tr class="model-header reliable">
                            <td rowspan="2" class="model-cell">
                                <div class="model-name">Reliable Resolution</div>
                                <div class="model-vn">Trao gi·∫£i ph√°p - Nh·∫≠n tin c·∫≠y</div>
                            </td>
                            <td>4.1. X√°c minh th√¥ng tin</td>
                            <td class="diengiai-cell">X√°c minh th√¥ng tin ch√≠nh x√°c theo quy ƒë·ªãnh</td>
                            <td><select class="score-select" data-criteria="4.1" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="N/A">N/A</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="4.1">
                                    <label><input type="checkbox" value="khong_xac_minh"> Kh√¥ng x√°c minh</label>
                                    <label><input type="checkbox" value="xac_minh_sai"> X√°c minh sai quy
                                        tr√¨nh</label>
                                    <label><input type="checkbox" value="bo_qua_buoc"> B·ªè qua b∆∞·ªõc x√°c
                                        minh</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="4.1"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="reliable">
                            <td>4.2. Gi·∫£i ph√°p</td>
                            <td class="diengiai-cell">Cung c·∫•p ph∆∞∆°ng √°n t·ªëi ∆∞u, r√µ r√†ng, tri·ªát ƒë·ªÉ</td>
                            <td><select class="score-select" data-criteria="4.2" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="P1">P1</option>
                                    <option value="P2">P2</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="4.2">
                                    <label><input type="checkbox" value="giai_phap_sai"> Gi·∫£i ph√°p sai</label>
                                    <label><input type="checkbox" value="khong_ro_rang"> Kh√¥ng r√µ r√†ng</label>
                                    <label><input type="checkbox" value="khong_day_du"> Kh√¥ng ƒë·∫ßy ƒë·ªß</label>
                                    <label><input type="checkbox" value="tu_van_sai"> T∆∞ v·∫•n sai quy
                                        tr√¨nh</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="4.2"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>

                        <!-- Thankful Closing - Kh√©p v√†o ƒë·∫πp - M·ªü k·∫øt n·ªëi -->
                        <tr class="model-header thankful">
                            <td rowspan="2" class="model-cell">
                                <div class="model-name">Thankful Closing</div>
                                <div class="model-vn">Kh√©p v√†o ƒë·∫πp - M·ªü k·∫øt n·ªëi</div>
                            </td>
                            <td>5.1. T∆∞ v·∫•n kh·∫£o s√°t</td>
                            <td class="diengiai-cell">Th·ª±c hi·ªán t∆∞ v·∫•n kh·∫£o s√°t theo quy ƒë·ªãnh</td>
                            <td><select class="score-select" data-criteria="5.1" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="N/A">N/A</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="5.1">
                                    <label><input type="checkbox" value="khong_khao_sat"> Kh√¥ng th·ª±c hi·ªán kh·∫£o
                                        s√°t</label>
                                    <label><input type="checkbox" value="khao_sat_sai"> Kh·∫£o s√°t sai quy
                                        tr√¨nh</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="5.1"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>
                        <tr class="thankful">
                            <td>5.2. Ch√†o k·∫øt th√∫c</td>
                            <td class="diengiai-cell">K·∫øt th√∫c cu·ªôc g·ªçi c·∫£m ∆°n, ch√†o th√¢n thi·ªán</td>
                            <td><select class="score-select" data-criteria="5.2" onchange="toggleErrorSelect(this)">
                                    <option value="Y" selected>Y</option>
                                    <option value="N">N</option>
                                    <option value="N/A">N/A</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="error-checkboxes" data-criteria="5.2">
                                    <label><input type="checkbox" value="khong_chao_ket"> Kh√¥ng ch√†o k·∫øt
                                        th√∫c</label>
                                    <label><input type="checkbox" value="ket_thuc_voi"> K·∫øt th√∫c v·ªôi
                                        v√†ng</label>
                                    <label><input type="checkbox" value="thieu_cam_on"> Thi·∫øu c·∫£m ∆°n KH</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="5.2"
                                    placeholder="Nh·∫≠p note l·ªói..."></textarea>
                            </td>
                        </tr>

                        <!-- Wow - ƒêi·ªÉm v∆∞·ª£t tr·ªôi -->
                        <tr class="model-header wow">
                            <td class="model-cell">
                                <div class="model-name">Wow</div>
                                <div class="model-vn">ƒêi·ªÉm v∆∞·ª£t tr·ªôi</div>
                            </td>
                            <td>6. Wow Factor</td>
                            <td class="diengiai-cell">C√°c y·∫øu t·ªë v∆∞·ª£t tr·ªôi trong cu·ªôc g·ªçi</td>
                            <td><select class="score-select" data-criteria="6.0" onchange="toggleErrorSelect(this)">
                                    <option value="" selected>--</option>
                                    <option value="Y">Y</option>
                                    <option value="N">N</option>
                                    <option value="N/A">N/A</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="wow-checkboxes" data-criteria="6.0">
                                    <label><input type="checkbox" value="kh_khen_ngoi"> 1. ƒê∆∞·ª£c KH khen ng·ª£i</label>
                                    <label><input type="checkbox" value="thong_tin_hieu_qua"> 2. Cung c·∫•p th√¥ng tin hi·ªáu
                                        qu·∫£</label>
                                    <label><input type="checkbox" value="dieu_huong_kh"> 3. Kƒ© nƒÉng ƒëi·ªÅu h∆∞·ªõng
                                        KH</label>
                                    <label><input type="checkbox" value="thuyet_phuc"> 4. Kƒ© nƒÉng thuy·∫øt ph·ª•c</label>
                                    <label><input type="checkbox" value="nhiet_tinh_tan_tam"> 5. H·ªó tr·ª£ nhi·ªát t√¨nh, t·∫≠n
                                        t√¢m</label>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="6.0"
                                    placeholder="Nh·∫≠p note Wow..."></textarea>
                            </td>
                        </tr>

                        <!-- Auto Fail - L·ªói nghi√™m tr·ªçng -->
                        <tr class="model-header autofail">
                            <td class="model-cell">
                                <div class="model-name">Auto Fail</div>
                                <div class="model-vn">L·ªói nghi√™m tr·ªçng</div>
                            </td>
                            <td>7. Auto Fail</td>
                            <td class="diengiai-cell">C√°c l·ªói nghi√™m tr·ªçng d·∫´n ƒë·∫øn fail cu·ªôc g·ªçi</td>
                            <td><select class="score-select" data-criteria="7.0" onchange="toggleErrorSelect(this)">
                                    <option value="" selected>--</option>
                                    <option value="Y">Y</option>
                                    <option value="N">N</option>
                                </select></td>
                            <td class="error-cell">
                                <div class="autofail-checkboxes" data-criteria="7.0">
                                    <div class="autofail-category">
                                        <strong>üî¥ Th√°i ƒë·ªô kh√¥ng ph√π h·ª£p:</strong>
                                        <label><input type="checkbox" value="af_ngon_tu_khong_phu_hop"> 1.1. Ng√¥n t·ª´
                                            kh√¥ng ph√π h·ª£p (ra l·ªánh, b·∫Øt b·∫ª, √°p ƒë·∫∑t, h·ªèi ng∆∞·ª£c, ƒë·ªï l·ªói KH)</label>
                                        <label><input type="checkbox" value="af_thach_thuc_kh"> 1.2. Khuy·∫øn kh√≠ch, th√°ch
                                            th·ª©c KH g√¢y b·∫•t l·ª£i/·∫£nh h∆∞·ªüng th∆∞∆°ng hi·ªáu</label>
                                        <label><input type="checkbox" value="af_thai_do_tho_o"> 1.3. Th√°i ƒë·ªô th·ªù ∆°, v√¥
                                            c·∫£m v·ªõi v·∫•n ƒë·ªÅ c·ªßa KH</label>
                                        <label><input type="checkbox" value="af_ket_thuc_som"> 1.4. K·∫øt th√∫c h·ªó tr·ª£ khi
                                            KH c√≤n th·∫Øc m·∫Øc, khi·∫øu n·∫°i, b·ª©c x√∫c</label>
                                        <label><input type="checkbox" value="af_im_lang_8s"> 1.5. Im l·∫∑ng t·ª´ 8s ƒë·ªÉ KH t·ª±
                                            g√°c m√°y</label>
                                        <label><input type="checkbox" value="af_khong_chuyen_tl"> 1.6. Kh√¥ng chuy·ªÉn TL
                                            h·ªó tr·ª£ khi KH m·∫•t b√¨nh tƒ©nh ho·∫∑c s·ª≠ d·ª•ng ng√¥n t·ª´ thi·∫øu vƒÉn h√≥a</label>
                                    </div>
                                    <div class="autofail-category">
                                        <strong>üî¥ Vi ph·∫°m quy ƒë·ªãnh b·∫£o m·∫≠t:</strong>
                                        <label><input type="checkbox" value="af_xac_minh_sai_rui_ro"> 2.1. X√°c minh sai
                                            quy ƒë·ªãnh trong tr∆∞·ªùng h·ª£p r·ªßi ro cao</label>
                                        <label><input type="checkbox" value="af_xac_minh_sai_khong_ho_tro"> 2.2. X√°c
                                            minh sai quy ƒë·ªãnh d·∫´n ƒë·∫øn kh√¥ng h·ªó tr·ª£ KH</label>
                                        <label><input type="checkbox" value="af_cung_cap_tt_khoan_vay"> 2.3. Cung c·∫•p
                                            th√¥ng tin chi ti·∫øt v·ªÅ kho·∫£n vay/th·∫ª t√≠n d·ª•ng khi ch∆∞a x√°c ƒë·ªãnh ch√≠nh
                                            ch·ªß</label>
                                        <label><input type="checkbox" value="af_cung_cap_tt_ca_nhan"> 2.4. Cung c·∫•p
                                            th√¥ng tin c√° nh√¢n c·ªßa KH cho c√°c ƒë∆°n v·ªã kh√°c khi kh√¥ng ƒë∆∞·ª£c ph√©p</label>
                                        <label><input type="checkbox" value="af_liet_ke_cau_hoi_xac_minh"> 2.5. Cung
                                            c·∫•p/li·ªát k√™ c√¢u h·ªèi x√°c minh ho·∫∑c c√¢u tr·∫£ l·ªùi cho KH</label>
                                    </div>
                                    <div class="autofail-category">
                                        <strong>üî¥ Kh√¥ng h·ªó tr·ª£ ho·∫∑c cung c·∫•p th√¥ng tin sai g√¢y r·ªßi ro:</strong>
                                        <label><input type="checkbox" value="af_khong_ho_tro_yeu_cau"> 3.1. Kh√¥ng h·ªó tr·ª£
                                            y√™u c·∫ßu c·ªßa KH m·∫∑c d√π v·∫•n ƒë·ªÅ c√≥ th·ªÉ h·ªó tr·ª£</label>
                                        <label><input type="checkbox" value="af_cung_cap_sai_khoan_tien"> 3.2. Cung c·∫•p
                                            sai c√°c kho·∫£n ti·ªÅn, ph√≠ KH c·∫ßn thanh to√°n (Loan: thi·∫øu t·ª´ 30k, Card: kh√¥ng
                                            gi·ªõi h·∫°n)</label>
                                        <label><input type="checkbox" value="af_hua_hen_khong_duoc_phep"> 3.3. H·ª©a h·∫πn
                                            h·ªó tr·ª£ cho KH khi quy tr√¨nh kh√¥ng ƒë∆∞·ª£c ph√©p nh∆∞ng kh√¥ng kh·∫Øc ph·ª•c/ƒë√≠nh
                                            ch√≠nh</label>
                                    </div>
                                    <div class="autofail-category">
                                        <strong>üî¥ X·ª≠ l√Ω h·ªá th·ªëng:</strong>
                                        <label><input type="checkbox" value="af_tao_ticket_khong_chuyen"> 4.1. T·∫°o
                                            ticket nh∆∞ng kh√¥ng chuy·ªÉn ƒëi ƒë·ªÉ x·ª≠ l√Ω cho KH</label>
                                        <label><input type="checkbox" value="af_ticket_sai_code"> 4.2. T·∫°o ticket v√†
                                            chuy·ªÉn ƒëi nh∆∞ng nh·∫≠p sai code/subcode/property/remark d·∫´n ƒë·∫øn v·∫•n ƒë·ªÅ KH
                                            kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω</label>
                                        <label><input type="checkbox" value="af_chuyen_pblq_sai"> 4.3. T·∫°o ticket chuy·ªÉn
                                            sang PBLQ h·ªó tr·ª£ KH trong tr∆∞·ªùng h·ª£p kh√¥ng th·ªèa ƒëi·ªÅu ki·ªán h·ªó tr·ª£</label>
                                        <label><input type="checkbox" value="af_khong_tao_ticket"> 4.4. Kh√¥ng t·∫°o ticket
                                            cho trong tr∆∞·ªùng h·ª£p th√¥ng tin c·∫ßn chuy·ªÉn ƒëi ƒë·ªÉ x·ª≠ l√Ω cho KH</label>
                                        <label><input type="checkbox" value="af_chuyen_line_sai"> 4.5. Kh√¥ng th·ª±c hi·ªán
                                            chuy·ªÉn line ƒë√∫ng quy ƒë·ªãnh</label>
                                        <label><input type="checkbox" value="af_cho_may_90s"> 4.6. Cho m√°y ƒë·ªÉ kh√°ch h√†ng
                                            ki·ªÉm th√¥ng tin, nh∆∞ng sau 90 gi√¢y kh√¥ng t∆∞∆°ng t√°c l·∫°i v·ªõi KH v√† r·ªõt
                                            call</label>
                                        <label><input type="checkbox" value="af_giu_may_4phut"> 4.7. Y√™u c·∫ßu KH gi·ªØ m√°y
                                            qu√° 4 ph√∫t m√† kh√¥ng c√≥ t∆∞∆°ng t√°c</label>
                                    </div>
                                    <div class="autofail-category">
                                        <strong>üî¥ Gian L·∫≠n:</strong>
                                        <label><input type="checkbox" value="af_gian_lan"> Gian l·∫≠n t√≠n hi·ªáu k√©m, Gian
                                            l·∫≠n l·ªói h·ªá th·ªëng...</label>
                                    </div>
                                </div>
                            </td>
                            <td class="note-error-cell">
                                <textarea class="note-error-input" data-criteria="7.0"
                                    placeholder="Nh·∫≠p note Auto Fail..."></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- T·ªïng ƒëi·ªÉm, ghi ch√∫ v√† n√∫t b·∫•m c√πng h√†ng -->
            <div class="scoring-footer">
                <div class="footer-left">
                    <label>üìä T·ªïng ƒëi·ªÉm:</label>
                    <span id="total-score" class="total-score score-positive">97 ƒëi·ªÉm</span>
                </div>
                <div class="footer-center">
                    <label>Ghi ch√∫:</label>
                    <input type="text" id="scoring-note" class="note-input" placeholder="Nh·∫≠p ghi ch√∫...">
                </div>
                <div class="footer-right">
                    <div id="save-initial-buttons">
                        <button class="btn-save" onclick="showConfirmSave()">üíæ L∆∞u ƒëi·ªÉm</button>
                        <button class="btn-modal-close" onclick="closeChamCallModal()">ƒê√≥ng</button>
                    </div>
                    <div id="save-confirm-buttons" style="display: none;">
                        <span class="confirm-text">‚ö†Ô∏è Ch·∫Øc ch·∫Øn l∆∞u?</span>
                        <button class="btn-confirm-save" onclick="confirmSaveScoring()">‚úÖ L∆∞u</button>
                        <button class="btn-go-back" onclick="cancelSaveScoring()">‚Ü©Ô∏è Quay l·∫°i</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let tableData = [];
        let tableCols = [];
        let currentRowIndex = -1;

        // B·∫£ng ƒëi·ªÉm theo ti√™u ch√≠ (t·ª´ h√¨nh ·∫£nh user cung c·∫•p)
        const scorePoints = {
            '1.1': { Y: 5, P1: 0, P2: 0, N: 0 },     // Ch√†o m·ªü ƒë·∫ßu: max 5
            '1.2': { Y: 10, P1: 5, P2: 0, N: 0 },    // L·∫Øng nghe: max 10, thi·∫øu ki√™n nh·∫´n = 5
            '2.1': { Y: 10, P1: 5, P2: 0, N: 0 },    // Ng√¥n t·ª´: max 10
            '2.2': { Y: 5, P1: 5, P2: 0, N: 0 },     // Ng·ªØ ƒëi·ªáu: max 5
            '2.3': { Y: 10, P1: 5, P2: 0, N: 0 },    // Th·∫•u hi·ªÉu: max 10
            '2.4': { Y: 2, P1: 0, P2: 0, N: 0 },     // G·ªçi t√™n kh√°ch h√†ng: max 2
            '3.1': { Y: 5, P1: 0, P2: 0, N: 0 },     // Qu·∫£n l√Ω cu·ªôc g·ªçi: max 5
            '3.2': { Y: 7, P1: 0, P2: 0, N: 0 },     // Nh·∫≠p li·ªáu: max 7
            '4.1': { Y: 5, P1: 0, P2: 0, N: 0, 'N/A': '-' },  // X√°c minh th√¥ng tin: max 5
            '4.2': { Y: 30, P1: 20, P2: 15, N: 0 },  // Gi·∫£i ph√°p: Y=30, P1=20, P2=15
            '5.1': { Y: 3, P1: 0, P2: 0, N: 0, 'N/A': 0 },  // T∆∞ v·∫•n kh·∫£o s√°t: max 3
            '5.2': { Y: 5, P1: 0, P2: 0, N: 0, 'N/A': 0 },     // Ch√†o k·∫øt th√∫c: max 5
            '6.0': { Y: 3, N: 0, 'N/A': 0 },       // Wow: 3 ƒëi·ªÉm
            '7.0': { Y: 'FAIL', N: '-', 'N/A': '-' } // Auto Fail
        };

        // C·∫≠p nh·∫≠t gi√° tr·ªã ƒëi·ªÉm khi thay ƒë·ªïi thang ƒëi·ªÉm
        function updateScoreValue(criteria, value) {
            const scoreCell = document.querySelector(`.score-value[data-criteria="${criteria}"]`);
            if (scoreCell) {
                const points = scorePoints[criteria] || {};
                let pointValue = points[value];

                // X·ª≠ l√Ω gi√° tr·ªã r·ªóng
                if (value === '' || value === undefined) {
                    pointValue = '-';
                } else if (pointValue === undefined) {
                    pointValue = 0;
                }

                scoreCell.textContent = pointValue;

                // Style based on value
                scoreCell.className = 'score-value';
                if (value === '' || value === undefined) {
                    scoreCell.classList.add('score-empty');
                } else if (pointValue === 'FAIL') {
                    scoreCell.classList.add('score-fail');
                } else if (pointValue === '+') {
                    scoreCell.classList.add('score-bonus');
                } else if (pointValue === '-') {
                    scoreCell.classList.add('score-na');
                } else if (pointValue > 0) {
                    scoreCell.classList.add('score-positive');
                } else {
                    scoreCell.classList.add('score-zero');
                }
            }
        }

        // ƒêi·ªÉm t·ªëi ƒëa cho m·ªói ti√™u ch√≠
        const maxScorePoints = {
            '1.1': 5, '1.2': 10, '2.1': 10, '2.2': 5,
            '2.3': 10, '2.4': 2, '3.1': 5, '3.2': 7,
            '4.1': 5, '4.2': 30, '5.1': 3, '5.2': 5,
            '6.0': 3
        };

        // T√≠nh t·ªïng ƒëi·ªÉm v·ªõi logic ph√¢n ph·ªëi N/A
        function calculateTotalScore() {
            let hasAutoFail = false;
            let naPoints = 0; // T·ªïng ƒëi·ªÉm t·ª´ c√°c ti√™u ch√≠ N/A
            let wowIsY = false;

            // C√°c ti√™u ch√≠ c√≥ th·ªÉ ph√¢n ph·ªëi (kh√¥ng bao g·ªìm 7.0)
            const distributableCriteria = ['1.1', '1.2', '2.1', '2.2', '2.3', '2.4', '3.1', '3.2', '4.1', '4.2', '5.1', '5.2'];

            // Ki·ªÉm tra Wow status
            const wowSelect = document.querySelector('.score-select[data-criteria="6.0"]');
            if (wowSelect && wowSelect.value === 'Y') {
                wowIsY = true;
            }

            // Thu th·∫≠p th√¥ng tin c√°c ti√™u ch√≠
            const criteriaData = [];

            document.querySelectorAll('.score-select').forEach(select => {
                const criteria = select.dataset.criteria;
                const value = select.value;
                const points = scorePoints[criteria] || {};
                const pointValue = points[value];
                const maxPoints = maxScorePoints[criteria] || 0;

                if (criteria === '7.0' && value === 'Y') {
                    hasAutoFail = true;
                }

                // N·∫øu l√† N/A v√† c√≥ ƒëi·ªÉm max, t√≠ch l≈©y ƒë·ªÉ ph√¢n ph·ªëi
                if (value === 'N/A' && maxScorePoints[criteria]) {
                    naPoints += maxScorePoints[criteria];
                } else if (criteria !== '7.0') {
                    // L∆∞u th√¥ng tin ti√™u ch√≠ ƒë·ªÉ t√≠nh ph√¢n ph·ªëi
                    criteriaData.push({
                        criteria,
                        value,
                        baseScore: typeof pointValue === 'number' ? pointValue : 0,
                        maxScore: maxPoints,
                        isWow: criteria === '6.0'
                    });
                }
            });

            // T√≠nh danh s√°ch ti√™u ch√≠ nh·∫≠n ph√¢n ph·ªëi
            let receivingCriteria = criteriaData.filter(c => {
                // Kh√¥ng bao g·ªìm Wow n·∫øu Wow = N
                if (c.isWow && !wowIsY) return false;
                return true;
            });

            // T√≠nh bonus cho m·ªói ti√™u ch√≠
            const bonusPerCriteria = receivingCriteria.length > 0 ? naPoints / receivingCriteria.length : 0;

            // T√≠nh t·ªïng ƒëi·ªÉm v·ªõi ph√¢n ph·ªëi t·ª∑ l·ªá
            let total = 0;
            receivingCriteria.forEach(c => {
                // ƒêi·ªÉm c∆° b·∫£n
                total += c.baseScore;

                // Bonus t·ª´ N/A: t√≠nh theo t·ª∑ l·ªá ƒëi·ªÉm ƒë·∫°t ƒë∆∞·ª£c / ƒëi·ªÉm max
                if (bonusPerCriteria > 0 && c.maxScore > 0) {
                    const ratio = c.baseScore / c.maxScore;
                    total += bonusPerCriteria * ratio;
                }
            });

            // N·∫øu Wow = N, kh√¥ng ƒë·∫øm Wow v√†o, nh∆∞ng v·∫´n c·ªông ƒëi·ªÉm Wow n·∫øu c√≥
            if (!wowIsY) {
                const wowData = criteriaData.find(c => c.isWow);
                if (wowData) {
                    total += wowData.baseScore;
                }
            }

            const totalElement = document.getElementById('total-score');
            if (totalElement) {
                if (hasAutoFail) {
                    totalElement.textContent = '0 ƒëi·ªÉm';
                    totalElement.className = 'total-score score-fail';
                } else {
                    totalElement.textContent = Math.round(total * 100) / 100 + ' ƒëi·ªÉm';
                    totalElement.className = 'total-score ' + (total >= 70 ? 'score-positive' : 'score-zero');
                }
            }

            return hasAutoFail ? 0 : total;
        }

        // Nh·∫≠n d·ªØ li·ªáu t·ª´ sessionStorage
        window.onload = function () {
            const storedData = sessionStorage.getItem('toolcheckData');
            const storedCols = sessionStorage.getItem('toolcheckCols');

            if (storedData && storedCols) {
                tableData = JSON.parse(storedData);
                tableCols = JSON.parse(storedCols);
                renderTable();
            } else {
                document.getElementById('tc-body').innerHTML = '<tr><td colspan="100%">Kh√¥ng c√≥ d·ªØ li·ªáu. Vui l√≤ng quay l·∫°i trang ch√≠nh.</td></tr>';
            }

            // Load k·∫øt qu·∫£ ƒë√£ l∆∞u
            renderResultsTable();
        };

        // C√°c c·ªôt c·∫ßn lo·∫°i b·ªè kh·ªèi hi·ªÉn th·ªã
        const excludeDisplayCols = ['th·ªèa ƒëi·ªÅu ki·ªán', 'ƒë·∫øm data', 'Ch·∫•m', 'Ng√†y l·∫•y data', 'Date SP1'];

        function renderTable() {
            // L·ªçc c√°c c·ªôt c·∫ßn hi·ªÉn th·ªã
            const displayCols = tableCols.filter(c => !excludeDisplayCols.includes(c));

            // T·∫°o header v·ªõi c·ªôt "Ch·∫•m Call" ·ªü ƒë·∫ßu
            const headerHTML = `<tr><th>Ch·∫•m Call</th>${displayCols.map(c => `<th>${c}</th>`).join('')}</tr>`;
            document.getElementById('tc-head').innerHTML = headerHTML;

            // T·∫°o body v·ªõi button "B·∫Øt ƒë·∫ßu" ·ªü c·ªôt ƒë·∫ßu
            const bodyHTML = tableData.map((row, index) => `
                <tr>
                    <td><button class="btn-start" onclick="openChamCallModal(${index})">B·∫Øt ƒë·∫ßu</button></td>
                    ${displayCols.map(c => `<td>${row[c] || "0"}</td>`).join('')}
                </tr>
            `).join('');
            document.getElementById('tc-body').innerHTML = bodyHTML;
        }

        function openChamCallModal(rowIndex) {
            currentRowIndex = rowIndex;
            const row = tableData[rowIndex];

            // L·ªçc c√°c c·ªôt c·∫ßn hi·ªÉn th·ªã trong modal
            const displayCols = tableCols.filter(c => !excludeDisplayCols.includes(c));

            // Hi·ªÉn th·ªã th√¥ng tin d√≤ng d·∫°ng b·∫£ng ngang
            let headerRow = '<tr>';
            let dataRow = '<tr>';
            displayCols.forEach(col => {
                headerRow += `<th>${col}</th>`;
                dataRow += `<td>${row[col] || "0"}</td>`;
            });
            headerRow += '</tr>';
            dataRow += '</tr>';

            const infoHTML = `<table class="row-info-table">${headerRow}${dataRow}</table>`;
            document.getElementById('modal-row-info').innerHTML = infoHTML;

            // Reset t·∫•t c·∫£ c√°c dropdown v·ªÅ gi√° tr·ªã r·ªóng (m·∫∑c ƒë·ªãnh)
            document.querySelectorAll('.score-select').forEach(select => {
                // Th√™m option r·ªóng n·∫øu ch∆∞a c√≥
                if (!select.querySelector('option[value=""]')) {
                    const emptyOption = document.createElement('option');
                    emptyOption.value = '';
                    emptyOption.textContent = '--';
                    select.insertBefore(emptyOption, select.firstChild);
                }
                select.value = '';
            });

            // ·∫®n t·∫•t c·∫£ error-checkboxes v√† reset
            document.querySelectorAll('.error-checkboxes').forEach(container => {
                container.style.display = 'none';
                // Reset t·∫•t c·∫£ checkbox
                container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            });

            // Reset t·∫•t c·∫£ note error inputs
            document.querySelectorAll('.note-error-input').forEach(textarea => {
                textarea.value = '';
            });

            // Reset wow checkboxes v√† ·∫©n container
            document.querySelectorAll('.wow-checkboxes').forEach(container => {
                container.style.display = 'none';
                container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            });

            // Reset Wow dropdown v·ªÅ r·ªóng
            const wowSelect = document.querySelector('.score-select[data-criteria="6.0"]');
            if (wowSelect) {
                wowSelect.value = '';
            }

            // Reset Auto Fail checkboxes v√† ·∫©n container
            document.querySelectorAll('.autofail-checkboxes').forEach(container => {
                container.style.display = 'none';
                container.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            });

            // Reset Auto Fail dropdown v·ªÅ r·ªóng
            const autoFailSelect = document.querySelector('.score-select[data-criteria="7.0"]');
            if (autoFailSelect) {
                autoFailSelect.value = '';
            }

            document.getElementById('scoring-note').value = '';

            // Ch√®n √¥ ƒëi·ªÉm v√†o m·ªói h√†ng n·∫øu ch∆∞a c√≥
            document.querySelectorAll('.score-select').forEach(select => {
                const criteria = select.dataset.criteria;
                const td = select.closest('td');

                // Ki·ªÉm tra xem √¥ ƒëi·ªÉm ƒë√£ t·ªìn t·∫°i ch∆∞a
                let scoreCell = document.querySelector(`.score-value[data-criteria="${criteria}"]`);
                if (!scoreCell) {
                    // T·∫°o √¥ ƒëi·ªÉm m·ªõi
                    const newTd = document.createElement('td');
                    newTd.className = 'score-value-cell';

                    const scoreSpan = document.createElement('span');
                    scoreSpan.className = 'score-value score-positive';
                    scoreSpan.dataset.criteria = criteria;

                    // L·∫•y gi√° tr·ªã ƒëi·ªÉm ban ƒë·∫ßu
                    const points = scorePoints[criteria] || {};
                    const initialValue = points[select.value];
                    scoreSpan.textContent = initialValue !== undefined ? initialValue : 0;

                    newTd.appendChild(scoreSpan);
                    td.after(newTd);
                }
            });

            // Kh·ªüi t·∫°o t·∫•t c·∫£ ƒëi·ªÉm
            document.querySelectorAll('.score-select').forEach(select => {
                const criteria = select.dataset.criteria;
                updateScoreValue(criteria, select.value);
            });

            // T√≠nh t·ªïng ƒëi·ªÉm ban ƒë·∫ßu
            calculateTotalScore();

            // Hi·ªÉn th·ªã modal
            document.getElementById('chamcallModal').style.display = 'block';
        }

        function closeChamCallModal() {
            document.getElementById('chamcallModal').style.display = 'none';
            currentRowIndex = -1;
            // Reset v·ªÅ n√∫t ban ƒë·∫ßu
            cancelSaveScoring();
        }

        // Hi·ªÉn th·ªã n√∫t x√°c nh·∫≠n l∆∞u ƒëi·ªÉm
        function showConfirmSave() {
            document.getElementById('save-initial-buttons').style.display = 'none';
            document.getElementById('save-confirm-buttons').style.display = 'flex';
        }

        // Quay l·∫°i n√∫t ban ƒë·∫ßu
        function cancelSaveScoring() {
            document.getElementById('save-confirm-buttons').style.display = 'none';
            document.getElementById('save-initial-buttons').style.display = 'flex';
        }

        // X√°c nh·∫≠n v√† th·ª±c s·ª± l∆∞u ƒëi·ªÉm
        function confirmSaveScoring() {
            saveScoring();
            // Reset v·ªÅ n√∫t ban ƒë·∫ßu sau khi l∆∞u
            cancelSaveScoring();
        }

        // H√†m toggle hi·ªÉn th·ªã error-checkboxes khi ƒëi·ªÉm kh√¥ng ph·∫£i Y ho·∫∑c N/A
        function toggleErrorSelect(scoreSelect) {
            const criteria = scoreSelect.dataset.criteria;

            // X·ª≠ l√Ω ri√™ng cho Wow (6.0) - ng∆∞·ª£c v·ªõi c√°c ti√™u ch√≠ kh√°c
            if (criteria === '6.0') {
                const wowContainer = document.querySelector(`.wow-checkboxes[data-criteria="${criteria}"]`);
                if (scoreSelect.value === 'Y') {
                    wowContainer.style.display = 'block';
                } else {
                    wowContainer.style.display = 'none';
                    wowContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                }
                updateScoreValue(criteria, scoreSelect.value);
                calculateTotalScore();
                return;
            }

            // X·ª≠ l√Ω ri√™ng cho Auto Fail (7.0) - t∆∞∆°ng t·ª± Wow
            if (criteria === '7.0') {
                const autoFailContainer = document.querySelector(`.autofail-checkboxes[data-criteria="${criteria}"]`);
                if (scoreSelect.value === 'Y') {
                    autoFailContainer.style.display = 'block';
                } else {
                    autoFailContainer.style.display = 'none';
                    autoFailContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                }
                updateScoreValue(criteria, scoreSelect.value);
                calculateTotalScore();
                return;
            }

            // X·ª≠ l√Ω b√¨nh th∆∞·ªùng cho c√°c ti√™u ch√≠ kh√°c
            const errorContainer = document.querySelector(`.error-checkboxes[data-criteria="${criteria}"]`);

            if (scoreSelect.value !== 'Y' && scoreSelect.value !== 'N/A') {
                // Hi·ªÉn th·ªã checkboxes l·ªói n·∫øu ƒëi·ªÉm kh√¥ng ph·∫£i Y ho·∫∑c N/A
                errorContainer.style.display = 'block';
            } else {
                // ·∫®n v√† reset n·∫øu ƒëi·ªÉm l√† Y ho·∫∑c N/A
                errorContainer.style.display = 'none';
                errorContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            }

            // C·∫≠p nh·∫≠t ƒëi·ªÉm
            updateScoreValue(criteria, scoreSelect.value);
            calculateTotalScore();
        }

        // Hi·ªÉn th·ªã n√∫t x√°c nh·∫≠n l∆∞u ƒëi·ªÉm
        function showConfirmSave() {
            document.getElementById('save-initial-buttons').style.display = 'none';
            document.getElementById('save-confirm-buttons').style.display = 'flex';
        }

        // Quay l·∫°i n√∫t ban ƒë·∫ßu
        function cancelSaveScoring() {
            document.getElementById('save-confirm-buttons').style.display = 'none';
            document.getElementById('save-initial-buttons').style.display = 'flex';
        }

        // X√°c nh·∫≠n v√† th·ª±c s·ª± l∆∞u ƒëi·ªÉm
        function confirmSaveScoring() {
            saveScoring();
            // Reset v·ªÅ n√∫t ban ƒë·∫ßu sau khi l∆∞u
            cancelSaveScoring();
        }

        function saveScoring() {
            if (currentRowIndex < 0) return;

            // Thu th·∫≠p ƒëi·ªÉm t·ª´ c√°c dropdown
            const scores = {};
            const errors = {};
            const errorNotes = {};
            let allFilled = true;

            document.querySelectorAll('.score-select').forEach(select => {
                const criteria = select.dataset.criteria;
                const value = select.value;
                scores[criteria] = value;
                if (!value) allFilled = false;

                // Thu th·∫≠p l·ªói ƒë√£ ch·ªçn (checkboxes) n·∫øu ƒëi·ªÉm kh√¥ng ph·∫£i Y
                // B·ªè qua c√°c ti√™u ch√≠ ƒë·∫∑c bi·ªát (Wow 6.0 v√† Auto Fail 7.0)
                if (value !== 'Y' && criteria !== '6.0' && criteria !== '7.0') {
                    const errorContainer = document.querySelector(`.error-checkboxes[data-criteria="${criteria}"]`);
                    if (errorContainer) {
                        const checkedErrors = Array.from(errorContainer.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
                        if (checkedErrors.length > 0) {
                            errors[criteria] = checkedErrors;
                        }
                    }
                }

                // Thu th·∫≠p note l·ªói
                const noteErrorInput = document.querySelector(`.note-error-input[data-criteria="${criteria}"]`);
                if (noteErrorInput && noteErrorInput.value.trim()) {
                    errorNotes[criteria] = noteErrorInput.value.trim();
                }
            });

            // Thu th·∫≠p Wow factors (lu√¥n hi·ªÉn th·ªã, kh√¥ng ph·ª• thu·ªôc v√†o ƒëi·ªÉm)
            const wowFactors = [];
            const wowContainer = document.querySelector('.wow-checkboxes');
            if (wowContainer) {
                wowContainer.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                    wowFactors.push(cb.value);
                });
            }

            // Thu th·∫≠p Auto Fail factors
            const autoFailFactors = [];
            const autoFailContainer = document.querySelector('.autofail-checkboxes');
            if (autoFailContainer) {
                autoFailContainer.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                    autoFailFactors.push(cb.value);
                });
            }

            // Ki·ªÉm tra ƒë√£ ch·∫•m ƒë·ªß ƒëi·ªÉm ch∆∞a
            if (!allFilled) {
                if (!confirm('B·∫°n ch∆∞a ch·∫•m ƒë·ªß t·∫•t c·∫£ c√°c ti√™u ch√≠. V·∫´n mu·ªën l∆∞u?')) {
                    return;
                }
            }

            // L·∫•y ghi ch√∫
            const note = document.getElementById('scoring-note').value;

            // T√≠nh t·ªïng ƒëi·ªÉm tr∆∞·ªõc khi l∆∞u
            const totalScoreValue = calculateTotalScore();

            // T·∫°o object k·∫øt qu·∫£
            const result = {
                rowIndex: currentRowIndex,
                rowData: tableData[currentRowIndex],
                scores: scores,
                errors: errors,
                errorNotes: errorNotes,
                wowFactors: wowFactors,
                autoFailFactors: autoFailFactors,
                totalScore: totalScoreValue,
                note: note,
                timestamp: new Date().toISOString()
            };

            // L∆∞u v√†o localStorage
            let savedScores = JSON.parse(localStorage.getItem('toolcheckScores') || '[]');
            savedScores.push(result);
            localStorage.setItem('toolcheckScores', JSON.stringify(savedScores));

            // C·∫≠p nh·∫≠t b·∫£ng k·∫øt qu·∫£
            renderResultsTable();

            // Hi·ªÉn th·ªã th√¥ng b√°o
            alert('‚úÖ ƒê√£ l∆∞u ƒëi·ªÉm th√†nh c√¥ng!');

            // ƒê√≥ng modal
            closeChamCallModal();

            console.log('Saved scoring:', result);
        }

        // Render b·∫£ng k·∫øt qu·∫£
        function renderResultsTable() {
            const savedScores = JSON.parse(localStorage.getItem('toolcheckScores') || '[]');
            const tbody = document.getElementById('results-body');

            if (savedScores.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" class="no-results">Ch∆∞a c√≥ k·∫øt qu·∫£ ch·∫•m ƒëi·ªÉm n√†o</td></tr>';
                return;
            }

            const errorLabels = {
                'khong_chao': 'Kh√¥ng ch√†o ƒë√∫ng chu·∫©n',
                'giong_moi': 'Gi·ªçng m·ªát m·ªèi',
                'thieu_than_thien': 'Thi·∫øu th√¢n thi·ªán',
                'cat_loi': 'C·∫Øt l·ªùi KH',
                'khong_lang_nghe': 'Kh√¥ng l·∫Øng nghe',
                'hieu_sai': 'Hi·ªÉu sai √Ω KH',
                'ngon_tu_tieu_cuc': 'Ng√¥n t·ª´ ti√™u c·ª±c',
                'kho_hieu': 'Kh√≥ hi·ªÉu',
                'chuyen_nganh': 'D√πng thu·∫≠t ng·ªØ CN',
                'noi_nhanh': 'N√≥i qu√° nhanh',
                'noi_cham': 'N√≥i qu√° ch·∫≠m',
                'giong_buon': 'Gi·ªçng bu·ªìn/m·ªát',
                'phat_am_sai': 'Ph√°t √¢m kh√¥ng r√µ',
                'thieu_dong_cam': 'Thi·∫øu ƒë·ªìng c·∫£m',
                'phan_hoi_may_moc': 'Ph·∫£n h·ªìi m√°y m√≥c',
                'khong_thau_hieu': 'Kh√¥ng th·∫•u hi·ªÉu',
                'khong_goi_ten': 'Kh√¥ng g·ªçi t√™n KH',
                'xung_ho_sai': 'X∆∞ng h√¥ sai',
                'goi_sai_ten': 'G·ªçi sai t√™n',
                'hold_lau': 'Hold qu√° l√¢u',
                'khong_thong_bao': 'Kh√¥ng th√¥ng b√°o hold',
                'chuyen_nhieu_lan': 'Chuy·ªÉn m√°y nhi·ªÅu l·∫ßn',
                'nhap_sai': 'Nh·∫≠p li·ªáu sai',
                'thieu_thong_tin': 'Thi·∫øu th√¥ng tin',
                'khong_cap_nhat': 'Kh√¥ng c·∫≠p nh·∫≠t',
                'khong_xac_minh': 'Kh√¥ng x√°c minh',
                'xac_minh_sai': 'X√°c minh sai',
                'bo_qua_buoc': 'B·ªè qua x√°c minh',
                'giai_phap_sai': 'Gi·∫£i ph√°p sai',
                'khong_ro_rang': 'Kh√¥ng r√µ r√†ng',
                'khong_day_du': 'Kh√¥ng ƒë·∫ßy ƒë·ªß',
                'tu_van_sai': 'T∆∞ v·∫•n sai',
                'khong_khao_sat': 'Kh√¥ng kh·∫£o s√°t',
                'khao_sat_sai': 'Kh·∫£o s√°t sai',
                'khong_chao_ket': 'Kh√¥ng ch√†o k·∫øt',
                'ket_thuc_voi': 'K·∫øt th√∫c v·ªôi',
                'thieu_cam_on': 'Thi·∫øu c·∫£m ∆°n',
                // Wow positive factors
                'kh_khen_ngoi': 'ƒê∆∞·ª£c KH khen ng·ª£i',
                'thong_tin_hieu_qua': 'Cung c·∫•p TT hi·ªáu qu·∫£',
                'dieu_huong_kh': 'Kƒ© nƒÉng ƒëi·ªÅu h∆∞·ªõng KH',
                'thuyet_phuc': 'Kƒ© nƒÉng thuy·∫øt ph·ª•c',
                'nhiet_tinh_tan_tam': 'H·ªó tr·ª£ nhi·ªát t√¨nh'
            };

            let html = '';
            savedScores.forEach((item, index) => {
                // Format th·ªùi gian
                const date = new Date(item.timestamp);
                const timeStr = date.toLocaleString('vi-VN');

                // Format th√¥ng tin cu·ªôc g·ªçi
                const callInfo = Object.entries(item.rowData || {}).slice(0, 3)
                    .map(([k, v]) => `<b>${k}:</b> ${v}`).join('<br>');

                // Format t·ªïng ƒëi·ªÉm
                let totalScoreHtml = '';
                const hasAutoFail = item.scores && item.scores['7.0'] === 'Y';

                if (hasAutoFail) {
                    totalScoreHtml = '<span class="total-score-badge score-fail">0 ƒëi·ªÉm</span>';
                } else if (item.totalScore !== undefined && item.totalScore !== null) {
                    const score = typeof item.totalScore === 'number' ? Math.round(item.totalScore * 100) / 100 : item.totalScore;
                    const scoreClass = score >= 70 ? 'score-positive' : 'score-zero';
                    totalScoreHtml = `<span class="total-score-badge ${scoreClass}">${score} ƒëi·ªÉm</span>`;
                } else {
                    totalScoreHtml = '<span style="color:#999;">Ch∆∞a c√≥</span>';
                }

                // Format Thang ƒëi·ªÉm (Y/N/P1/P2/N/A cho t·ª´ng ti√™u ch√≠)
                const criteriaLabels = {
                    '1.1': 'Ch√†o', '1.2': 'L·∫Øng nghe', '2.1': 'Ng√¥n t·ª´', '2.2': 'Ng·ªØ ƒëi·ªáu',
                    '2.3': 'Th·∫•u hi·ªÉu', '2.4': 'X∆∞ng h√¥', '3.1': 'Qu·∫£n l√Ω', '3.2': 'Nh·∫≠p li·ªáu',
                    '4.1': 'X√°c minh', '4.2': 'Gi·∫£i ph√°p', '5.1': 'Kh·∫£o s√°t', '5.2': 'Ch√†o k·∫øt',
                    '6.0': 'Wow', '7.0': 'Auto Fail'
                };
                let thangDiemHtml = '';
                Object.entries(item.scores || {}).forEach(([k, v]) => {
                    const badgeClass = v === 'N/A' ? 'score-NA' : `score-${v}`;
                    const label = criteriaLabels[k] || k;
                    thangDiemHtml += `<span class="score-badge ${badgeClass}" title="${label}">${k}: ${v}</span> `;
                });
                if (!thangDiemHtml) thangDiemHtml = '<span style="color:#999;">-</span>';

                // Format ƒêi·ªÉm chi ti·∫øt (ƒëi·ªÉm s·ªë t·ª´ng ti√™u ch√≠)
                let diemChiTietHtml = '';
                Object.entries(item.scores || {}).forEach(([k, v]) => {
                    const points = scorePoints[k] || {};
                    let pointValue = points[v];
                    if (pointValue === undefined) pointValue = 0;

                    let pointClass = 'score-detail-normal';
                    if (pointValue === 'FAIL') {
                        pointClass = 'score-detail-fail';
                    } else if (pointValue === '-' || pointValue === 0) {
                        pointClass = 'score-detail-zero';
                    } else if (typeof pointValue === 'number' && pointValue > 0) {
                        pointClass = 'score-detail-positive';
                    }

                    const label = criteriaLabels[k] || k;
                    diemChiTietHtml += `<span class="score-detail-badge ${pointClass}" title="${label}">${k}: ${pointValue}</span> `;
                });
                if (!diemChiTietHtml) diemChiTietHtml = '<span style="color:#999;">-</span>';

                // Format l·ªói
                let errorsHtml = '';
                Object.entries(item.errors || {}).forEach(([criteria, errs]) => {
                    errs.forEach(err => {
                        const label = errorLabels[err] || err;
                        errorsHtml += `<span class="error-tag">${criteria}: ${label}</span> `;
                    });
                    // Th√™m note l·ªói n·∫øu c√≥
                    if (item.errorNotes && item.errorNotes[criteria]) {
                        errorsHtml += `<span class="error-note-tag">[${criteria}]: ${item.errorNotes[criteria]}</span> `;
                    }
                });
                // Hi·ªÉn th·ªã note l·ªói cho c√°c ti√™u ch√≠ kh√¥ng c√≥ checkbox ƒë∆∞·ª£c ch·ªçn
                Object.entries(item.errorNotes || {}).forEach(([criteria, note]) => {
                    if (!item.errors || !item.errors[criteria]) {
                        errorsHtml += `<span class="error-note-tag">[${criteria}]: ${note}</span> `;
                    }
                });
                if (!errorsHtml) errorsHtml = '<span style="color:#28a745;">Kh√¥ng c√≥ l·ªói</span>';

                // Format Wow factors
                let wowHtml = '';
                (item.wowFactors || []).forEach(factor => {
                    const label = errorLabels[factor] || factor;
                    wowHtml += `<span class="wow-tag">${label}</span> `;
                });
                if (wowHtml) {
                    errorsHtml += '<br>‚úÖ ' + wowHtml;
                }

                // Format Auto Fail factors
                let autoFailHtml = '';
                (item.autoFailFactors || []).forEach(factor => {
                    autoFailHtml += `<span class="autofail-tag">${factor}</span> `;
                });
                if (autoFailHtml) {
                    errorsHtml += '<br>üî¥ AUTO FAIL: ' + autoFailHtml;
                }

                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${timeStr}</td>
                        <td>${callInfo}</td>
                        <td>${totalScoreHtml}</td>
                        <td class="thang-diem-cell">${thangDiemHtml}</td>
                        <td class="diem-chi-tiet-cell">${diemChiTietHtml}</td>
                        <td>${errorsHtml}</td>
                        <td>${item.note || '-'}</td>
                        <td><button class="btn-delete-row" onclick="deleteResult(${index})">X√≥a</button></td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // X√≥a m·ªôt k·∫øt qu·∫£
        function deleteResult(index) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a k·∫øt qu·∫£ n√†y?')) return;

            let savedScores = JSON.parse(localStorage.getItem('toolcheckScores') || '[]');
            savedScores.splice(index, 1);
            localStorage.setItem('toolcheckScores', JSON.stringify(savedScores));
            renderResultsTable();
        }

        // X√≥a t·∫•t c·∫£ k·∫øt qu·∫£
        function clearResults() {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a T·∫§T C·∫¢ k·∫øt qu·∫£?')) return;

            localStorage.removeItem('toolcheckScores');
            renderResultsTable();
            alert('‚úÖ ƒê√£ x√≥a t·∫•t c·∫£ k·∫øt qu·∫£!');
        }

        // Xu·∫•t k·∫øt qu·∫£ ra Excel (.xlsx)
        function exportResults() {
            const savedScores = JSON.parse(localStorage.getItem('toolcheckScores') || '[]');
            if (savedScores.length === 0) {
                alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!');
                return;
            }

            // L·∫•y t·∫•t c·∫£ c√°c c·ªôt t·ª´ rowData, lo·∫°i b·ªè c√°c c·ªôt kh√¥ng c·∫ßn
            const excludeCols = ['th·ªèa ƒëi·ªÅu ki·ªán', 'ƒë·∫øm data', 'Ch·∫•m', 'Ng√†y l·∫•y data', 'Date SP1'];
            const allRowDataKeys = new Set();
            savedScores.forEach(item => {
                if (item.rowData) {
                    Object.keys(item.rowData).forEach(key => {
                        if (!excludeCols.some(ex => key.toLowerCase().trim() === ex.toLowerCase().trim())) {
                            allRowDataKeys.add(key);
                        }
                    });
                }
            });
            const rowDataCols = Array.from(allRowDataKeys);

            // T·∫°o d·ªØ li·ªáu cho Excel
            const excelData = [];

            // Header row - bao g·ªìm c·∫£ th√¥ng tin cu·ªôc g·ªçi
            const headers = [
                'STT', 'Th·ªùi gian',
                ...rowDataCols,  // C√°c c·ªôt t·ª´ toolcheck
                'T·ªïng ƒëi·ªÉm',  // Th√™m c·ªôt T·ªïng ƒëi·ªÉm
                '1.1 Ch√†o', 'ƒêi·ªÉm 1.1',
                '1.2 L·∫Øng nghe', 'ƒêi·ªÉm 1.2',
                '2.1 Ng√¥n t·ª´', 'ƒêi·ªÉm 2.1',
                '2.2 Ng·ªØ ƒëi·ªáu', 'ƒêi·ªÉm 2.2',
                '2.3 Th·∫•u hi·ªÉu', 'ƒêi·ªÉm 2.3',
                '2.4 X∆∞ng h√¥', 'ƒêi·ªÉm 2.4',
                '3.1 Qu·∫£n l√Ω', 'ƒêi·ªÉm 3.1',
                '3.2 Nh·∫≠p li·ªáu', 'ƒêi·ªÉm 3.2',
                '4.1 X√°c minh', 'ƒêi·ªÉm 4.1',
                '4.2 Gi·∫£i ph√°p', 'ƒêi·ªÉm 4.2',
                '5.1 Kh·∫£o s√°t', 'ƒêi·ªÉm 5.1',
                '5.2 Ch√†o k·∫øt', 'ƒêi·ªÉm 5.2',
                '6. Wow', 'ƒêi·ªÉm 6.0', 'Wow Factors',
                '7. Auto Fail', 'Auto Fail Factors',
                'L·ªói vi ph·∫°m', 'Note L·ªói', 'Ghi ch√∫'
            ];
            excelData.push(headers);

            // Data rows
            savedScores.forEach((item, index) => {
                const date = new Date(item.timestamp).toLocaleString('vi-VN');
                const scores = item.scores || {};
                const rowData = item.rowData || {};

                // T√≠nh ƒëi·ªÉm cho t·ª´ng ti√™u ch√≠
                const getPointValue = (criteria, value) => {
                    const points = scorePoints[criteria] || {};
                    const pointValue = points[value];
                    if (pointValue === undefined) return 0;
                    if (pointValue === 'FAIL') return 0;
                    if (pointValue === '-') return '-';
                    return pointValue;
                };

                // T√≠nh t·ªïng ƒëi·ªÉm
                let totalScore = item.totalScore;
                if (scores['7.0'] === 'Y') {
                    totalScore = 0;
                } else if (typeof totalScore === 'number') {
                    totalScore = Math.round(totalScore * 100) / 100;
                }

                // T·∫≠p h·ª£p l·ªói
                const errorsArr = [];
                Object.entries(item.errors || {}).forEach(([k, v]) => {
                    v.forEach(e => errorsArr.push(`${k}: ${e}`));
                });

                // T·∫≠p h·ª£p note l·ªói
                const errorNotesArr = [];
                Object.entries(item.errorNotes || {}).forEach(([k, v]) => {
                    errorNotesArr.push(`[${k}]: ${v}`);
                });

                // T·∫≠p h·ª£p Wow factors
                const wowFactorsArr = (item.wowFactors || []).map(f => {
                    const wowLabels = {
                        'kh_khen_ngoi': 'ƒê∆∞·ª£c KH khen ng·ª£i',
                        'thong_tin_hieu_qua': 'Cung c·∫•p TT hi·ªáu qu·∫£',
                        'dieu_huong_kh': 'Kƒ© nƒÉng ƒëi·ªÅu h∆∞·ªõng KH',
                        'thuyet_phuc': 'Kƒ© nƒÉng thuy·∫øt ph·ª•c',
                        'nhiet_tinh_tan_tam': 'H·ªó tr·ª£ nhi·ªát t√¨nh'
                    };
                    return wowLabels[f] || f;
                });

                // T·∫≠p h·ª£p Auto Fail factors
                const autoFailFactorsArr = (item.autoFailFactors || []);

                // T·∫°o row v·ªõi d·ªØ li·ªáu toolcheck
                const row = [
                    index + 1,
                    date,
                    ...rowDataCols.map(col => rowData[col] || ''),  // Gi√° tr·ªã t·ª´ toolcheck
                    totalScore,  // T·ªïng ƒëi·ªÉm
                    scores['1.1'] || '', getPointValue('1.1', scores['1.1']),
                    scores['1.2'] || '', getPointValue('1.2', scores['1.2']),
                    scores['2.1'] || '', getPointValue('2.1', scores['2.1']),
                    scores['2.2'] || '', getPointValue('2.2', scores['2.2']),
                    scores['2.3'] || '', getPointValue('2.3', scores['2.3']),
                    scores['2.4'] || '', getPointValue('2.4', scores['2.4']),
                    scores['3.1'] || '', getPointValue('3.1', scores['3.1']),
                    scores['3.2'] || '', getPointValue('3.2', scores['3.2']),
                    scores['4.1'] || '', getPointValue('4.1', scores['4.1']),
                    scores['4.2'] || '', getPointValue('4.2', scores['4.2']),
                    scores['5.1'] || '', getPointValue('5.1', scores['5.1']),
                    scores['5.2'] || '', getPointValue('5.2', scores['5.2']),
                    scores['6.0'] || '', getPointValue('6.0', scores['6.0']), wowFactorsArr.join('; ') || '',
                    scores['7.0'] || '', autoFailFactorsArr.join('; ') || '',
                    errorsArr.join('; ') || 'Kh√¥ng c√≥ l·ªói',
                    errorNotesArr.join('; ') || '',
                    item.note || ''
                ];
                excelData.push(row);
            });

            // T·∫°o workbook v√† worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(excelData);

            // Set column widths ƒë·ªông
            const colWidths = [
                { wch: 5 },   // STT
                { wch: 20 },  // Th·ªùi gian
            ];
            // Th√™m width cho c√°c c·ªôt rowData
            rowDataCols.forEach(() => colWidths.push({ wch: 15 }));
            // T·ªïng ƒëi·ªÉm
            colWidths.push({ wch: 12 });
            // Th√™m width cho c√°c c·ªôt thang ƒëi·ªÉm v√† ƒëi·ªÉm chi ti·∫øt (m·ªói ti√™u ch√≠ 2 c·ªôt)
            for (let i = 0; i < 26; i++) colWidths.push({ wch: 10 });
            // L·ªói v√† Ghi ch√∫
            colWidths.push({ wch: 40 }, { wch: 30 }, { wch: 30 });

            ws['!cols'] = colWidths;

            // Th√™m worksheet v√†o workbook
            XLSX.utils.book_append_sheet(wb, ws, 'K·∫øt qu·∫£ ch·∫•m ƒëi·ªÉm');

            // Xu·∫•t file
            const fileName = 'ket_qua_cham_diem_' + new Date().toISOString().slice(0, 10) + '.xlsx';
            XLSX.writeFile(wb, fileName);
        }

        // Click b√™n ngo√†i modal ƒë·ªÉ ƒë√≥ng
        window.onclick = function (event) {
            if (event.target.className === 'chamcall-modal') {
                event.target.style.display = 'none';
            }
        };
    </script>

</body>

</html>