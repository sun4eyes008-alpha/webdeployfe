<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LOAN</title>
  <link rel="icon" type="image/x-icon" href="./Asset/img-video/fec_logo-1.png">
  <link rel="stylesheet" href="./Asset/style2.css" />
  <link rel="stylesheet" href="./Asset/theme-default.css" />

  <link rel="stylesheet" href="./Asset/theme-tet.css" />

  <!--   <link rel="stylesheet" href="./Asset/theme-he.css" /> -->
  <!--  <link rel="stylesheet" href="./Asset/theme-thu.css" />
  <link rel="stylesheet" href="./Asset/theme-dong.css" /> -->

  <style>
    /* Bỏ gạch chân cho các link trong header */
    a.tab-btn,
    a.pdf-link-btn,
    .dropdown-menu a.dropdown-item {
      text-decoration: none;
      color: inherit;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header id="main-header">
    <div class="header-container">
      <button class="sidebar-toggle" id="sidebar-toggle">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
      <div class="logo-container">
        <a href="index.html">
          <img src="./Asset/logo/logo-fecredit.svg" alt="FECredit" class="logo" />
        </a>
      </div>

      <!-- NEW SEARCH BAR -->
      <div class="search-container">
        <input type="search" id="header-search" placeholder="Tìm kiếm thông tin..." />
        <div id="search-results-container" class="search-results"></div>
      </div>

      <div class="header-tabs">
        <div class="dropdown">
          <button class="tab-btn dropdown-toggle">PLTT</button>
          <div class="dropdown-menu">
            <a href="loan_v2.html" class="dropdown-item" id="loan-btn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path d="M1.5 3a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-12a.5.5 0 0 1-.5-.5v-2z" />
                <path d="M1 6.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1z" />
                <path
                  d="M1 9.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1zm13.5 2.5a.5.5 0 0 0-.5-.5h-13a.5.5 0 0 0 0 1h13a.5.5 0 0 0 .5-.5z" />
              </svg>
              Loan
            </a>
            <a href="card_v6.html" class="dropdown-item">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z" />
                <path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z" />
              </svg>
              Card
            </a>
            <a href="outbound_v6.html" class="dropdown-item">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511zM11 .5a.5.5 0 0 1 .5.5V3h2.5a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0V4h-2.5a.5.5 0 0 1 0-1H10V.5a.5.5 0 0 1 .5-.5z" />
              </svg>
              Outbound
            </a>
            <a href="ubank_v6.html" class="dropdown-item">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M8 .95 1.75 4h12.5L8 .95zM1 5.5v1h14v-1H1zm.25 2.5a.5.5 0 0 0 0 1h13.5a.5.5 0 0 0 0-1H1.25zM1 10.5v1h14v-1H1zM1.75 13h12.5l-6.25 3.05L1.75 13zM1 14.25v-1h14v1H1z" />
              </svg>

              Ubank
            </a>
          </div>
        </div>
        <a href="#preset=TIN_TUC" class="tab-btn pdf-link-btn" data-preset="TIN_TUC">TIN TỨC</a>
        <div class="dropdown">
          <button class="tab-btn dropdown-toggle">QUY ĐỊNH CHUNG</button>
          <div class="dropdown-menu">
            <!-- Xác Minh Thông Tin với submenu -->
            <div class="dropdown-item has-submenu">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z" />
              </svg>
              Xác Minh Thông Tin
              <div class="dropdown-submenu">
                <a href="#preset=QD_CHUNG" class="dropdown-item pdf-link-btn" data-preset="QD_CHUNG">Quy định chung</a>
                <a href="#preset=PHAN_LOAI_RUI_RO" class="dropdown-item pdf-link-btn"
                  data-preset="PHAN_LOAI_RUI_RO">Phân loại rủi ro</a>
                <div class="dropdown-item has-submenu">
                  Câu hỏi xác minh
                  <div class="dropdown-submenu">
                    <a href="#preset=XMTT_LEVEL_A" class="dropdown-item pdf-link-btn" data-preset="XMTT_LEVEL_A">Level A
                      - Thông tin KH</a>
                    <a href="#preset=XMTT_LEVEL_B" class="dropdown-item pdf-link-btn" data-preset="XMTT_LEVEL_B">Level B
                      - Thông tin HĐ</a>
                  </div>
                </div>
              </div>
            </div>
            <a href="#preset=TIEP_NHAN_CUOC_GOI" class="dropdown-item pdf-link-btn" data-preset="TIEP_NHAN_CUOC_GOI">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                  d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z" />
              </svg>
              Tiếp Nhận Cuộc Gọi
            </a>
            <a href="#preset=XU_LY_EMAIL_CHAT" class="dropdown-item pdf-link-btn" data-preset="XU_LY_EMAIL_CHAT">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z" />
              </svg>
              Xử lý Email/Chat
            </a>
            <a href="#preset=HUONG_DAN_NHAP_LIEU" class="dropdown-item pdf-link-btn" data-preset="HUONG_DAN_NHAP_LIEU">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM5 4h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1zm0 2h3a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1z" />
              </svg>
              Hướng Dẫn Nhập Liệu
            </a>
            <!-- Quy định hỗ trợ người thứ 3 với submenu -->
            <div class="dropdown-item has-submenu">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                <path
                  d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7Zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm-5.784 6A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216ZM4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z" />
              </svg>
              Quy định hỗ trợ người thứ 3
              <div class="dropdown-submenu">
                <a href="#preset=DU_NO_THOA_THUAN" class="dropdown-item pdf-link-btn" data-preset="DU_NO_THOA_THUAN">Dư
                  nợ/Thỏa thuận khoản
                  vay</a>
                <a href="#preset=BOI_THUONG_BAO_HIEM" class="dropdown-item pdf-link-btn"
                  data-preset="BOI_THUONG_BAO_HIEM">Bồi thường bảo hiểm</a>
                <a href="#preset=NGUNG_NHAC_NO_DAN_SU" class="dropdown-item pdf-link-btn"
                  data-preset="NGUNG_NHAC_NO_DAN_SU">Ngưng nhắc nợ dân
                  sự</a>
                <a href="#preset=HOAN_TIEN" class="dropdown-item pdf-link-btn" data-preset="HOAN_TIEN">Hoàn tiền</a>
                <a href="#preset=CAC_YEU_CAU_KHAC" class="dropdown-item pdf-link-btn" data-preset="CAC_YEU_CAU_KHAC">Các
                  yêu cầu khác</a>
              </div>
            </div>
          </div>
        </div>
        <a href="#preset=TAI_LIEU_THAM_KHAO" class="tab-btn pdf-link-btn" data-preset="TAI_LIEU_THAM_KHAO">TÀI LIỆU THAM
          KHẢO</a>
        <a href="#preset=HUONG_DAN_HE_THONG" class="tab-btn pdf-link-btn" data-preset="HUONG_DAN_HE_THONG">HƯỚNG DẪN HỆ
          THỐNG</a>
        <a href="#preset=CHANGE_LOG" class="tab-btn pdf-link-btn" data-preset="CHANGE_LOG" data-tab="change-log"
          id="change-log-btn">
          CHANGE LOG
        </a>
      </div>
    </div>
  </header>

  <!-- Sidebar -->
  <nav id="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-page-title">
        <svg class="sidebar-title-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
          <path d="M1.5 3a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-12a.5.5 0 0 1-.5-.5v-2z"></path>
          <path d="M1 6.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1z"></path>
          <path
            d="M1 9.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1zm13.5 2.5a.5.5 0 0 0-.5-.5h-13a.5.5 0 0 0 0 1h13a.5.5 0 0 0 .5-.5z">
          </path>
        </svg>
        <span>LOAN</span>
      </div>
      <div class="sidebar-tabs-container" id="sidebar-tabs">
        <button class="sidebar-tab-btn active" data-source="truyvan">TRUY VẤN</button>
        <button class="sidebar-tab-btn" data-source="feedback">PHẢN ÁNH</button>
      </div>
    </div>
    <div class="sidebar-content">
      <div id="dynamic-filters-container"></div>
    </div>
  </nav>

  <!-- Main Content -->
  <main id="main-content">
    <!-- Condition Panel (above XMTT) -->
    <div id="dieukien-panel" class="dieukien-panel hidden">
      <div class="dieukien-box" id="dieukien-box">
        <button class="expand-btn" data-target="dieukien-box">⤢</button>
        <div id="dieukien-result" class="box-content">
          <p>Điều kiện sẽ hiển thị ở đây khi chọn</p>
        </div>
      </div>
    </div>

    <!-- Sub Header -->
    <div id="sub-header" class="resizable">
      <!-- Row chứa 3 box XMTT có thể resize -->
      <div class="xmtt-row" id="xmtt-row">
        <!-- XMTT IB Box -->
        <div class="sub-header-box xmtt-ib-box" id="xmtt-ib-box">
          <button class="expand-btn" data-target="xmtt-ib-box">⤢</button>
          <div class="column-header">
            <h5>XÁC MINH THÔNG TIN INBOUND</h5>
          </div>
          <div id="xmtt-ib-content" class="box-content">
            <p>...</p>
          </div>
        </div>
        <!-- Resize Handle 1 -->
        <div class="resize-handle" data-resize="1"></div>
        <!-- XMTT CHAT Box -->
        <div class="sub-header-box xmtt-chat-box" id="xmtt-chat-box">
          <button class="expand-btn" data-target="xmtt-chat-box">⤢</button>
          <div class="column-header">
            <h5>XÁC MINH THÔNG TIN CHAT</h5>
          </div>
          <div id="xmtt-chat-content" class="box-content">
            <p>...</p>
          </div>
        </div>
        <!-- Resize Handle 2 -->
        <div class="resize-handle" data-resize="2"></div>
        <!-- XMTT EMAIL Box -->
        <div class="sub-header-box xmtt-email-box" id="xmtt-email-box">
          <button class="expand-btn" data-target="xmtt-email-box">⤢</button>
          <div class="column-header">
            <h5>XÁC MINH THÔNG TIN EMAIL</h5>
          </div>
          <div id="xmtt-email-content" class="box-content">
            <p>...</p>
          </div>
        </div>
      </div>
      <!-- Notes Box -->
      <div class="sub-header-box" id="notes-box">
        <button class="expand-btn" data-target="notes-box">⤢</button>
        <div id="notes-result" class="box-content">
          <p>Thông báo và lưu ý sẽ hiển thị ở đây</p>
        </div>
      </div>
    </div>

    <!-- Body Content (Content Viewer - supports both PDF and HTML) -->
    <div id="body-proper">
      <iframe id="pdf-viewer" src="" style="width: 100%; height: 100%; border: none"></iframe>
      <div id="html-viewer"
        style="width: 100%; height: 100%; overflow: auto; display: none; padding: 20px; background: white;"></div>
    </div>
  </main>

  <div id="custom-popup" class="popup-container hidden">
    <button id="popup-close-btn">✖</button>
    <div id="popup-content"></div>
  </div>

  <div id="overlay"></div>
  <div id="toast-container"></div>

  <div class="scroll-buttons">
    <button id="scroll-to-top" class="scroll-btn">▲</button>
    <button id="scroll-to-bottom" class="scroll-btn">▼</button>
  </div>

  <!-- FLOWCHART_DATA_START -->
  <script>
/**
 * GENERATED BY FLOWCHART EDITOR
 */

// --- GROUP: Chưa phân loại ---
const XMTT_1 = `1. Không cần XMTT`;
const XMTT_2 = `2. CMND/CCCD`;
const XMTT_3 = `3. CCCD/CMND/SHD`;
const XMTT_4 = `4. Đúng SĐT + CMND/CCCD + 1A`;
const XMTT_5 = `5. Đúng SĐT + CMND + Sai 1A`;
const XMTT_6 = `6. Đúng SĐT + CMND + 1A + 1B`;
const XMTT_7 = `7. Đúng SĐT update + CMND + 2A + 1B`;
const XMTT_8 = `8. Sai SĐT
  a. còn dùng SDT cũ: dùng đúng SDT gọi lại
  b. Không còn dùng SDT:
   - HĐ Closed hết: CMND/CCCD + 1A
   - HĐ còn mở: CMND/CCCD + 2A  đồng thời hướng dẫn cập nhật SDT.`;
const XMTT_9 = `9. Sai SĐT + CMND + 1A`;
const XMTTIB_10 = `<td style="background-color:white; line-height:1.4;">
  - <strong>Đúng SĐT:</strong> <strong style="color:red">1A</strong> 
  (nếu <strong>sai</strong> <strong style="color:red">1A</strong>, chỉ cung cấp số HĐ/số tiền đến hạn thanh toán)

  - <strong>Sai SĐT:</strong>

    + Không còn HĐ nào active: <strong style="color:red">2A</strong>

    + Còn HĐ active: <strong style="color:red">1A</strong> 
  (chỉ cung cấp số HĐ/số tiền đến hạn thanh toán)
</td>`;
const LTNSlide4 = `<td style="background-color:white; line-height:1.4;">
  - <strong>Đúng SĐT:</strong> <strong style="color:red">1A</strong> 
  (nếu <strong>sai</strong> <strong style="color:red">1A</strong>, chỉ cung cấp số HĐ/số tiền đến hạn thanh toán)
<br/>
  - <strong>Sai SĐT:</strong>
<br>
    + Không còn HĐ nào active: <strong style="color:red">2A</strong>
<br>
    + Còn HĐ active: <strong style="color:red">1A</strong> 
  (chỉ cung cấp số HĐ/số tiền đến hạn thanh toán)
</td>`;
const LTNSlide11 = `<td style="background-color:white; vertical-align:middle">
  <strong style="color:red">Đúng / Sai SĐT:</strong> <strong>1A</strong>
</td>`;
const ECLTNSlide4 = `<td style="background-color:white; line-height:1.4;">
  - Chat: <strong>Post Login</strong>
<br/>
  - Email/Chat không post login: 
  <a href="file://deltavn.vn/Deltashare/DeptData/_CallCenter/CSPORTAL/Website/uat/UATWEBQC/pdfile/THANH_TOAN_CIC/PDF_HUONG_DAN_TRA_CUU.pdf" style="color:#0070c0; text-decoration:underline;">xem tại đây</a>
</td>
`;
const ECLTNSlide11 = `<td style="background-color:white; vertical-align:middle; line-height:1.4;">
  <strong style="color:red">Chat:</strong> <strong>Post login FEOL 2.0</strong>
<br>
  <strong style="color:red">Email/Chat không post login:</strong> <strong>Không cần XMTT</strong>
</td>`;
const LUUYLTNSlide4 = `<td style="background-color:white; line-height:1.4; vertical-align:middle;">
  <strong style="color:red">Fail XMTT nhưng KH gay gắt</strong> yêu cầu cung cấp thông tin chi tiết: 
  CS khai thác <strong>SĐT liên hệ</strong> và <strong>gửi email</strong> đến anh 
  <a href="mailto:tu.tran@fecredit.com.vn" style="color:#0070c0; text-decoration:underline;">
    tu.tran@fecredit.com.vn
  </a> để xem xét hỗ trợ
</td>
`;
const LUUYLTNSlide11 = `<td style="background-color:white; line-height:1.4; vertical-align:top;">
  • <strong style="color:red">HĐ bán nợ TOÀN PHẦN, CHỈ CUNG CẤP:</strong> số hợp đồng, thông tin chung công ty, kiểm tra tiền vào hệ thống 
  (ngoại trừ thông tin giao dịch bán nợ – 
  <a href="#" style="color:#0070c0; text-decoration:underline;">xem tại đây</a>)
<br>
  • <strong style="color:red">KHÔNG CHỦ ĐỘNG</strong> cung cấp việc HĐ đã bán nợ; chỉ cung cấp nếu khách hàng hỏi.
<br>
  • Sau thời điểm bán nợ, FE ngừng báo cáo tín dụng; lịch sử tín dụng cập nhật nhóm nợ cao nhất theo lịch sử thanh toán của KH.
</td> `;

// --- GROUP: Cập nhật thông tin ---

// --- SUBGROUP: Cập nhật thông tin > cập nhật SDT ---
const Cap_nhat_sdt_feo_khong_thanh_cong = `<p><strong>Lưu &yacute;: </strong>Nếu KH gay gắt kh&ocirc;ng đồng &yacute; thực hiện theo hướng dẫn, CS hỗ trợ theo <a href="file:///T:/DeptData/_CallCenter/CSPORTAL/Website/uat/UATWEBQC/loan_v2.html#source=truyvan&amp;s=NoIgjAzAdABAKgJQIIwMKAu8AqvQD3g0AiAgG3gByA4iADQgBiAojAPIB2ANgJZMCmMATFAAyUQAGUDreGxjomAcxgARQKd4MoagCHAYxhiJAaQAWGkAF0gA&quot;">Lỗi ứng dụng</a></p>`;


window.HEADER_PRESETS = {
  "TIN_TUC": {
    "pdf": "khuyenmai.pdf",
    "xmttib": XMTT_1,
    "note": "<strong>Khuyến mãi mới nhất:</strong><br>- Giảm 10% lãi suất cho vay mua xe máy trong tháng 1/2026<br>- Tặng voucher 500k cho khách hàng mới đăng ký qua app",
    "displayName": "Tin Tức Mới"
  },
  "QD_CHUNG": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/quydinhchung.pdf",
    "displayName": "Quy định chung XMTT"
  },
  "PHAN_LOAI_RUI_RO": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/phanloairuiroloan.pdf",
    "displayName": "Phân Loại Rủi Ro XMTT"
  },
  "XMTT_LEVEL_A": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/cauhoixmttloan_levela.pdf",
    "displayName": "Câu hỏi Xác Minh Level A"
  },
  "XMTT_LEVEL_B": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/cauhoixmttloan_levelb.pdf",
    "displayName": "Câu hỏi Xác Minh Level B"
  },
  "TIEP_NHAN_CUOC_GOI": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/quydinhtiepnhancuogoi.pdf",
    "displayName": "Quy Định Tiếp Nhân Cuộc Gọi"
  },
  "XU_LY_EMAIL_CHAT": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/quydinhxulyemail_chat.pdf",
    "displayName": "Quy Định Xử Lý Email/ Chat"
  },
  "HUONG_DAN_NHAP_LIEU": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/quydinhnhaplieu.pdf",
    "displayName": "Hướng Dẫn Nhập Liệu"
  },
  "DU_NO_THOA_THUAN": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/dunothoaThuanKhoanVay.pdf",
    "displayName": "Dư Nợ Thỏa Thuận (Người Thứ 3)",
    "dieukien": ""
  },
  "BOI_THUONG_BAO_HIEM": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/boithuongbaohiem.pdf",
    "displayName": "Bồi Thường Bảo Hiểm (Người Thứ 3)",
    "dieukien": ""
  },
  "NGUNG_NHAC_NO_DAN_SU": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/ngungnhacnodansu.pdf",
    "displayName": "Ngưng Nhắc Nợ Dân Sự (Người Thứ 3)",
    "dieukien": ""
  },
  "HOAN_TIEN": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/hoantien.pdf",
    "displayName": "Hoàn Tiền (Người Thứ 3)",
    "dieukien": ""
  },
  "CAC_YEU_CAU_KHAC": {
    "pdf": "./QUY_DINH_CHUNG/LOAN/cacyeucaukhac.pdf",
    "displayName": "Các Yêu Cầu Khác (Người Thứ 3)",
    "dieukien": ""
  },
  "TAI_LIEU_THAM_KHAO": {
    "pdf": "TAI LIEU THAM KHAO.pdf",
    "xmttib": XMTT_1,
    "xmttemail": "Không cần XMTT cho Email",
    "xmttchat": "Post Login FEOL 2.0",
    "note": "Tài liệu tham khảo các quy định, chính sách và hướng dẫn nghiệp vụ",
    "displayName": "Tài Liệu Tham Khảo"
  },
  "HUONG_DAN_HE_THONG": {
    "pdf": "HUONG DAN HE THONG.pdf",
    "displayName": "Hướng Dẫn Hệ Thống"
  },
  "CHANGE_LOG": {
    "pdf": "CHANGE LOG.pdf",
    "displayName": "Change Log"
  }
};

window.flowchartData = {
  "1. THÔNG TIN CHUNG": {
    "Thông Tin Công Ty": {
      "Thông Tin Công Ty & Thương Hiệu": {
        "pdf": "1_THONG_TIN_CONG_TY/Thong_tin_cong_ty_thuong_hieu.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Thông tin công ty & thương hiệu",
        "dieukien": "",
        "xmttecom": ""
      },
      "Các Kênh CSKH": {
        "pdf": "1_THONG_TIN_CONG_TY/Cac_kenh_CSKH.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Các kênh CSKH",
        "dieukien": "",
        "xmttecom": ""
      },
      "Công Văn & Thư Tín": {
        "pdf": "Cong_van_thu_tin.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Công Văn / Thư Tín",
        "dieukien": "",
        "xmttecom": ""
      },
      "Quy Trình Gửi ZNS": {
        "pdf": "1_THONG_TIN_CONG_TY/Quy_trinh_gui_ZNS.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Quy trình gửi ZNS",
        "dieukien": "",
        "xmttecom": ""
      }
    },
    "Hợp Tác Kinh Doanh": {
      "pdf": "2_HOP_TAC_KINH_DOANH/Hop_tac_kinh_doanh.pdf",
      "contentType": "",
      "htmlContent": "",
      "htmlUrl": "",
      "xmttib": "",
      "note": "",
      "displayName": "Hợp Tác Kinh Doanh",
      "dieukien": "<p><strong>Điều kiện ghi nhận hợp t&aacute;c:</strong><br>+ Mặt h&agrave;ng KH đang kinh doanh thuộc danh mục được hỗ trợ <a href=\"pdfile-loan\\1_THONG_TIN_CHUNG\\2_HOP_TAC_KINH_DOANH\\Danh_sach_mat_hang_hop_tac_kinh_doanh.pdf\" target=\"_blank\" rel=\"noopener\">xem tại đ&acirc;y</a><br>+ Ng&agrave;y cấp giấy ph&eacute;p kinh doanh &ge; 2 năm</p>",
      "xmttecom": ""
    },
    "Xóa Dữ Liệu Cá Nhân": {
      "pdf": "3_XOA_DU_LIEU_CA_NHAN/Xoa_du_lieu_ca_nhan.pdf",
      "contentType": "",
      "htmlContent": "",
      "htmlUrl": "",
      "xmttib": "",
      "note": "",
      "displayName": "Xóa Dữ Liệu Cá Nhân",
      "dieukien": "<p>1. Phiếu y&ecirc;u cầu xử l&yacute; dữ liệu c&aacute; nh&acirc;n: <a href=\"pdfile-loan/1_THONG_TIN_CHUNG/3_XOA_DU_LIEU_CA_NHAN/Phieu_yeu_cau_xu_ly_du_lieu_ca_nhan.pdf\" target=\"_blank\" rel=\"noopener\">tại đ&acirc;y</a><br>2. Tham khảo nghị định về bảo vệ dữ liệu c&aacute; nh&acirc;n:<a href=\"pdfile-loan/1_THONG_TIN_CHUNG/3_XOA_DU_LIEU_CA_NHAN/Tham_khao_nghi_dinh_ve_bao_ve_du_lieu_ca_nhan.pdf\" target=\"_blank\" rel=\"noopener\"> tại đ&acirc;y</a></p>",
      "xmttecom": ""
    },
    "Mở Chặn Cuộc Gọi": {
      "Cuộc Gọi Từ Sale/ UW": {
        "pdf": "4_MO_CHAN_CUOC_GOI/Mo_chan_cuoc_goi_Sale_UW.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Cuộc Gọi Từ Sale/ UW",
        "dieukien": "<p>Kiểm tra ticket RL24/RC24, x&aacute;c định đơn vị đ&atilde; xử l&yacute; y&ecirc;u cầu ngưng mời vay trước đ&oacute;</p>",
        "xmttecom": ""
      },
      "Cuộc Gọi Từ Collx": {
        "pdf": "4_MO_CHAN_CUOC_GOI/Mo_chan_cuoc_goi_Collx.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Cuộc Gọi Từ Collx",
        "dieukien": "",
        "xmttecom": ""
      }
    },
    "Ngưng Mời Vay & Quảng Cáo": {
      "KH Chưa Có HĐ/ Thẻ": {
        "pdf": "",
        "xmttib": "",
        "note": "",
        "displayName": "KH Chưa Có HĐ/ Thẻ",
        "dieukien": "<p><strong>Điều kiện:&nbsp;</strong><br>Chỉ hỗ trợ ngưng t&aacute;c động tr&ecirc;n <span style=\"color: #e03e2d;\">SĐT đăng k&yacute;/ SĐT đang li&ecirc;n hệ/ email KH li&ecirc;n hệ/ email KH y&ecirc;u cầu</span></p>\n<p><strong>*Lưu &yacute;:</strong><br>- Hướng dẫn kiểm tra kết quả DNB <a href=\"file:///T:/DeptData/_CallCenter/CSPORTAL/Website/main/view/plttc_ww06_21-27/documents/H%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20Ki%E1%BB%83m%20tra%20danh%20s%C3%A1ch%20DNB.pdf\" target=\"_blank\" rel=\"noopener\">xem tại đ&acirc;y</a></p>\n<p>- SĐT/Email được add sẽ c&oacute; thời hạn \"vĩnh viễn\" v&agrave; chưa c&oacute; t&iacute;nh năng hủy.<br>- CS phải thao t&aacute;c add SĐT ngay trong cuộc gọi. Nếu add thất bại do lỗi dịch vụ, CS hỗ trợ theo trường hợp \"Kh&ocirc;ng thỏa điều kiện DNB\"</p>",
        "xmttecom": ""
      },
      "KH Đã Có HĐ/ Thẻ": {
        "pdf": "",
        "xmttib": "",
        "note": "",
        "displayName": "KH Đã Có HĐ/ Thẻ",
        "dieukien": "<p><strong>Điều kiện:&nbsp;</strong><br>Chỉ hỗ trợ ngưng t&aacute;c động tr&ecirc;n <span style=\"color: #e03e2d;\">SĐT đăng k&yacute;/ SĐT đang li&ecirc;n hệ/ email KH li&ecirc;n hệ/ email KH y&ecirc;u cầu</span></p>\n<p><strong>*Lưu &yacute;:</strong><br>- Hướng dẫn kiểm tra kết quả DNB <a href=\"file:///T:/DeptData/_CallCenter/CSPORTAL/Website/main/view/plttc_ww06_21-27/documents/H%C6%B0%E1%BB%9Bng%20d%E1%BA%ABn%20Ki%E1%BB%83m%20tra%20danh%20s%C3%A1ch%20DNB.pdf\" target=\"_blank\" rel=\"noopener\">xem tại đ&acirc;y</a></p>\n<p>- SĐT/Email được add sẽ c&oacute; thời hạn \"vĩnh viễn\" v&agrave; chưa c&oacute; t&iacute;nh năng hủy.<br>- CS phải thao t&aacute;c add SĐT ngay trong cuộc gọi. Nếu add thất bại do lỗi dịch vụ, CS hỗ trợ theo trường hợp \"Kh&ocirc;ng thỏa điều kiện DNB\"</p>",
        "xmttecom": ""
      }
    },
    "Khuyến Mãi": {
      "Loan": {
        "Ưu Đãi Thanh Toán": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Ưu Đãi Thanh Toán",
          "dieukien": "",
          "xmttecom": ""
        }
      },
      "Card": {
        "Ưu Đãi Mua Sắm": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Ưu Đãi Mua Sắm",
          "dieukien": "",
          "xmttecom": ""
        },
        "Hoàn Tiền": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Hoàn Tiền",
          "dieukien": "",
          "xmttecom": ""
        },
        "Ưu Đãi Thanh Toán": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Ưu Đãi Thanh Toán",
          "dieukien": "",
          "xmttecom": ""
        },
        "Dành riêng cho NV FEC": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Dành riêng cho NV FEC",
          "dieukien": "",
          "xmttecom": ""
        }
      }
    },
    "Nhầm line/ Rớt cuộc/ Mất tín hiệu": {
      "pdf": "",
      "xmttib": "",
      "note": "",
      "displayName": "Nhầm Line/ Rớt Cuộc/ Mất Tín Hiệu",
      "dieukien": "",
      "xmttecom": ""
    },
    "Yêu cầu khác": {
      "pdf": "",
      "xmttib": "",
      "note": "",
      "displayName": "Yêu Cầu Khác",
      "dieukien": "",
      "xmttecom": ""
    }
  },
  "2. THÔNG TIN SẢN PHẨM": {
    "Vay Mua Xe Máy": {
      "pdf": "Sản Phẩm Vay Mua Xe Máy.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Thông tin sản phẩm > Vay Mua Xe Máy"
    },
    "Vay Mua Điện Máy": {
      "pdf": "Sản Phẩm Vay Mua Điện Máy.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Thông tin sản phẩm > Vay Mua Điện Máy"
    },
    "Vay Tiền Mặt": {
      "pdf": "Sản Phẩm Vay Tiền Mặt.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Thông tin sản phẩm > Vay Tiền Mặt"
    }
  },
  "3. ĐĂNG KÝ VAY": {
    "Vay Mua Xe Máy": {
      "pdf": "Vay Sản Phẩm Vay Mua Xe Máy.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Đăng ký vay > Vay Mua Xe Máy"
    },
    "Vay Mua Điện Máy": {
      "pdf": "Vay Sản Phẩm Vay Mua Điện Máy.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Đăng ký vay > Vay Mua Điện Máy"
    },
    "Vay Tiền Mặt": {
      "pdf": "Vay Sản Phẩm Vay Tiền Mặt.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Đăng ký vay > Vay Tiền Mặt"
    }
  },
  "4. GIẢI NGÂN": {
    "Giải Ngân Tiền Mặt": {
      "pdf": "Giải Ngân Tiền Mặt.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Giải Ngân Tiền Mặt"
    }
  },
  "5. KÊNH THANH TOÁN": {
    "Thanh Toán Trực Tuyến": {
      "pdf": "THANH TOÁN TRỰC TUYẾN.pdf",
      "xmttib": XMTT_1,
      "note": "Thanh toán chuyển khoản qua VPbank được hoàn 5.000vnd vào tháng tiếp theo.",
      "alert": "Thanh toán chuyển khoản qua VPbank được hoàn 5.000vnd vào tháng tiếp theo",
      "displayName": "Kênh thanh toán > Thanh Toán Trực Tuyến"
    },
    "Thanh Toán Tiền Mặt": {
      "pdf": "THANH TOÁN TIỀN MẶT.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Kênh Thanh Toán > Thanh Toán Tiền Mặt"
    },
    "Thanh Toán Qua ATM/CDM": {
      "pdf": "THANH TOÁN QUA ATM CDM.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Kênh Thanh Toán > Thanh Toán Qua ATM/CDM"
    },
    "Trích Nợ Tự Động": {
      "pdf": "TRÍCH NỢ TỰ ĐỘNG.pdf",
      "xmttib": XMTT_1,
      "note": "N/A",
      "displayName": "Kênh Thanh Toán > Trích Nợ Tự Động"
    }
  },
  "6. VẤN ĐỀ THANH TOÁN": {
    "Lịch Trả Nợ": {
      "HĐ FEC|| HĐ Bán Nợ FC|| HĐ Bán Nợ Một Phần Galaxy": {
        "pdf": "LICH_TRA_NO_FEC.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": LTNSlide4,
        "xmttemail": ECLTNSlide4,
        "note": LUUYLTNSlide4,
        "displayName": "Lịch Trả Nợ HĐ FEC/ HĐ Bán Nợ FC/ HĐ Bán Nợ Một Phần Galaxy"
      },
      "HĐ Bán Nợ Toàn Phần Galaxy": {
        "pdf": "VĐTT_BAN_NO_TOAN_PHAN_GALAXY.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": LTNSlide4,
        "xmttemail": ECLTNSlide11,
        "note": LUUYLTNSlide11,
        "displayName": "Lịch Trả Nợ HĐ Bán Nợ Toàn Phần Galaxy"
      },
      "HĐ Bán Nợ FC Sold_Azura": {
        "pdf": "VĐTT_BAN_NO_FC_SOLD_AZURA.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": LUUYLTNSlide11,
        "xmttemail": ECLTNSlide11,
        "note": LTNSlide4,
        "displayName": "Lịch Trả Nợ HĐ bán nợ FC Sold_Azura"
      },
      "HĐ Bán Nợ Welcome Vina": {
        "pdf": "VĐTT_BAN_NO_WELCOMEVINA.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": LTNSlide11,
        "xmttemail": ECLTNSlide11,
        "note": LUUYLTNSlide11,
        "displayName": "Lịch Trả Nợ HĐ Bán Nợ Welcome Vina"
      },
      "HĐ CF/ HĐ FC Sold CF\t": {
        "pdf": "VĐTT_CF_FC_SOLD_CF.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": LTNSlide11,
        "xmttemail": ECLTNSlide11,
        "note": LUUYLTNSlide11,
        "displayName": "Lịch Trả Nợ HĐ bán nợ CF/ HĐ FC Sold CF",
        "tieudeflow": "__VAR_REF____VAR_REF__"
      },
      "HĐ B2": {
        "pdf": "VĐTT_B2.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "CMND/CCCD/SHĐ",
        "note": " •HĐ được ký trước năm 2014 thuộc phạm vi quản lý chung của VPBank và FE\n •Không hiển thị tkhi search ại mục “sau giải ngân” trên Pega hoặc có hiển thị tại mục B2 Contracts\n •Danh sách hợp đồng <u><strong><a href=\"file://deltavn.vn/DeltaShare/DeptData/_CallCenter/CSPORTAL/Website/main/view/plttc_ww06_21-27/documents/DS%20HĐ%20B2.xlsx\">xem tại đây</a></strong></u> ",
        "displayName": "Lịch Trả HĐ B2"
      },
      "HĐ Cash 24": {
        "pdf": "VĐTT_CASH24.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "CMND/CCCD/SHĐ",
        "note": " •<strong>Định nghĩa: </strong>Là hợp đồng được cấp bởi đối tác Ideal Tech (CASH24) thông qua nền tảng số\n •<strong>Dấu hiệu nhận biết: </strong>Không thể kiểm tra được trên Pega. Số HĐ gồm 8 số (ví dụ: 00-00-09-27). \n •<strong>KH muốn biết số HĐ: </strong>CS khai thác CMND/CCCD và cung cấp theo <u><span style=\"color:#0070c0\">danh sách</span></u> ",
        "displayName": "Lịch Trả Nợ HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "LTN_LSTT_KIM_AN.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "CMND/CCCD/SHĐ",
        "note": " •Là hợp đồng được cấp bởi công ty đối tác Kim An\n •Dấu hiệu nhận biết: <strong>FC ROBO KIM AN</strong>\n •Đặc điểm: HĐ thu tiền theo ngày/ tuần và có nv tự liên hệ KH thu tiền ",
        "displayName": "Lịch Trả Nợ Bán Nợ Welcome Vina"
      }
    },
    "Lịch Sử Thanh Toán": {
      "HĐ FEC/ HĐ Bán Nợ FC/ HĐ Bán Nợ Một Phần Galaxy": {
        "pdf": "IB Dung SDT.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Lịch Sử TT HĐ FEC"
      },
      "HĐ Bán Nợ Toàn Phần Galaxy": {
        "pdf": "PDF_LICH_SU_THANH_TOAN_FEC.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "Lịch Sử Thanh Toán HĐ FEC/ HĐ Bán Nợ FC/ HĐ Bán Nợ Một Phần Galaxy"
      },
      "HĐ Bán Nợ FC Sold_Azura": {
        "pdf": "HĐ Kim An.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "Lịch Sử TT Kim An"
      },
      "HĐ Bán Nợ Welcome Vina": {
        "pdf": "HĐ Bán Nợ Một Phần.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Lịch Sử TT Bán Nợ Một Phần"
      },
      "HĐ CF/ HĐ FC Sold CF": {
        "pdf": "HĐ Bán Nợ Galaxy.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Lịch Sử TT Bán Nợ Galaxy"
      },
      "HĐ B2": {
        "pdf": "HĐ Bán Nợ Fc Sold_Azura.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Lịch Sử Thanh Toán HĐ B2"
      },
      "HĐ Cash 24": {
        "pdf": "HĐ Bán Nợ Welcome Vina.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Lịch Sử Thanh Toán Bán Nợ Welcome Vina"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Lịch Sử Thanh Toán HĐ Kim An"
      }
    },
    "Thanh lý Hợp Đồng": {
      "HĐ FEC/ HĐ Bán Nợ FC/ HĐ Bán Nợ Một Phần Galaxy": {
        "pdf": "PDF_TLHD_FEC.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ FEC"
      },
      "HĐ Bán Nợ Toàn Phần Galaxy": {
        "pdf": "PDF_BAN_NO_TOAN_PHAN_GALAXY.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ HĐ Bán Nợ Toàn Phần Galaxy"
      },
      "HĐ Bán Nợ FC Sold_Azura": {
        "pdf": "PDF_BAN_NO_FC_SOLD_AZURA.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "Thanh Lý HĐ HĐ Bán Nợ FC Sold_Azura"
      },
      "HĐ Bán Nợ Welcome Vina": {
        "pdf": "PDF_BAN_NO_WELCOMEVINA.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ Bán Nợ HĐ Bán Nợ Welcome Vina"
      },
      "HĐ CF/ HĐ FC Sold CF": {
        "pdf": "PDF_CF_FC _SOLD_CF.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ HĐ CF/ HĐ FC Sold CF"
      },
      "HĐ B2": {
        "pdf": "PDF_B2.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ HĐ B2"
      },
      "HĐ Cash 24": {
        "pdf": "PDF_CASH24.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thanh Lý HĐ HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "PDF_KIM_AN",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Thanh lý Hợp Đồng HĐ Kim An"
      }
    },
    "Thỏa Thuận Khoản Vay": {
      "HĐ FEC": {
        "pdf": "IB Dung SDT.pdf",
        "xmttib": XMTT_8,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV HĐ FEC"
      },
      "Cash 24": {
        "pdf": "HD Cash 24.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV Cash 24"
      },
      "Kim An": {
        "pdf": "HĐ Kim An.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "Thỏa Thuận KV Kim An"
      },
      "Bán Nợ Một Phần": {
        "pdf": "HĐ Bán Nợ Một Phần.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV Bán Nợ Một Phần"
      },
      "Bán Nợ Galaxy": {
        "pdf": "HĐ Bán Nợ Galaxy.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV Bán Nợ Galaxy"
      },
      "Bán Nợ Fc Sold_Azura": {
        "pdf": "HĐ Bán Nợ Fc Sold_Azura.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV Bán Nợ Fc Sold_Azura"
      },
      "Bán Nợ Welcome Vina": {
        "pdf": "HĐ Bán Nợ Welcome Vina.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Thỏa Thuận KV Bán Nợ Welcome Vina"
      }
    },
    "Tình Trạng Hợp Đồng": {
      "HĐ FEC": {
        "pdf": "IB Dung SDT.pdf",
        "xmttib": XMTT_8,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ FEC"
      },
      "Cash 24": {
        "pdf": "HD Cash 24.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ Cash 24"
      },
      "Kim An": {
        "pdf": "HĐ Kim An.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "Tình Trạng HĐ Kim An"
      },
      "Bán Nợ Một Phần": {
        "pdf": "HĐ Bán Nợ Một Phần.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ Bán Nợ Một Phần"
      },
      "Bán Nợ Galaxy": {
        "pdf": "HĐ Bán Nợ Galaxy.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ Bán Nợ Galaxy"
      },
      "Bán Nợ Fc Sold_Azura": {
        "pdf": "HĐ Bán Nợ Fc Sold_Azura.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ Bán Nợ Fc Sold_Azura"
      },
      "Bán Nợ Welcome Vina": {
        "pdf": "HĐ Bán Nợ Welcome Vina.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Tình Trạng HĐ Bán Nợ Welcome Vina"
      }
    },
    "Đóng Hợp Đồng": {
      "HĐ FEC": {
        "pdf": "IB Dung SDT.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Đóng HĐ FEC"
      },
      "Cash 24": {
        "pdf": "HD Cash 24.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "Đóng HĐ Cash 24"
      },
      "Kim An": {
        "pdf": "HĐ Kim An.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "Đóng HĐ Kim An"
      },
      "Bán Nợ Một Phần": {
        "pdf": "HĐ Bán Nợ Một Phần.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Đóng HĐ Bán Nợ Một Phần"
      },
      "Bán Nợ Galaxy": {
        "pdf": "HĐ Bán Nợ Galaxy.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Đóng HĐ Bán Nợ Galaxy"
      },
      "Bán Nợ Fc Sold_Azura": {
        "pdf": "HĐ Bán Nợ Fc Sold_Azura.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Đóng HĐ Bán Nợ Fc Sold_Azura"
      },
      "Bán Nợ Welcome Vina": {
        "pdf": "HĐ Bán Nợ Welcome Vina.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "Đóng HĐ Bán Nợ Welcome Vina"
      }
    },
    "Lãi/Phí Phát Sinh Sai": {
      "HĐ FEC": {
        "pdf": "IB Dung SDT.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "CIC HĐ FEC"
      },
      "Cash 24": {
        "pdf": "HD Cash 24.pdf",
        "xmttib": XMTT_1,
        "note": "N/A",
        "displayName": "CIC Cash 24"
      },
      "Kim An": {
        "pdf": "HĐ Kim An.pdf",
        "xmtt": XMTT_2,
        "note": "Lưu ý cho hợp đồng Kim An.",
        "displayName": "CIC Kim An"
      },
      "Bán Nợ Một Phần": {
        "pdf": "HĐ Bán Nợ Một Phần.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "CIC Bán Nợ Một Phần"
      },
      "Bán Nợ Galaxy": {
        "pdf": "HĐ Bán Nợ Galaxy.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "CIC Bán Nợ Galaxy"
      },
      "Bán Nợ Fc Sold_Azura": {
        "pdf": "HĐ Bán Nợ Fc Sold_Azura.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "CIC Bán Nợ Fc Sold_Azura"
      },
      "Bán Nợ Welcome Vina": {
        "pdf": "HĐ Bán Nợ Welcome Vina.pdf",
        "xmttib": XMTT_4,
        "note": "N/A",
        "displayName": "CIC Bán Nợ Welcome Vina"
      }
    }
  },
  "7. NHẮC NỢ": {
    "Nhắc Nợ trước hạn": {
      "pdf": "NHAC_NO_TRUOC_HAN.PDF",
      "contentType": "",
      "htmlContent": "",
      "htmlUrl": "",
      "xmttib": "CCCD",
      "xmttemail": "CCCD",
      "xmttchat": "CCCD",
      "note": "",
      "displayName": "Nhắc Nợ Trước Hạn"
    },
    "Nhắc Nợ Nhiều Lần/ Quá 7h-21h/ Nhá Máy": {
      "pdf": "NHAC_NO_NHIEU_LAN.PDF",
      "contentType": "",
      "htmlContent": "",
      "htmlUrl": "",
      "xmttib": "- Đúng SĐT + CCCD + 1A <br>\n- XM không thành công: CCCD/SHĐ/ Điện thoại đăng ký và ghi nhận khiếu nại không cung cấp chi tiết hợp đồng",
      "xmttemail": "N/A",
      "xmttchat": "N/A",
      "note": "",
      "displayName": "Nhắc Nợ Nhiều Lần/ Quá 7h-21h/ Nhá Máy",
      "dieukien": "",
      "xmttecom": ""
    },
    "Yêu Cầu Ngưng Nhắc Nợ": {
      "Số Chính Chủ Đăng Ký HĐ FE CREDIT": {
        "pdf": "NGUNG_NHAC_NO_CHINH_CHU.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "N/A",
        "xmttemail": "N/A",
        "xmttchat": "N/A",
        "note": "",
        "displayName": "Nhắc Nợ Số Chính Chủ Đăng Ký HĐ FE CREDIT",
        "dieukien": "<tr>\n\t\t\t<td style=\"white-space:normal\"><strong><u>Lưu ý nhập liệu:</u></strong><br />\n\t\t\t- Ở Trường \"Số điện thoại đang bị nhắc nợ\": chỉ điền 1 số điện thoại. Nếu KH cần hỗ trợ thêm 1 số khác thì tạo ticket mới<br />\n\t\t\t- Service Case ID: nhập số ticket của lần phản ánh gần nhất<br />\n\t\t\t- Không có dữ liệu: nhập số 0<br />\n\t\t\t<strong>Nhập code:</strong><br />\n\t\t\t- Nhập khiếu nại trên SHĐ bị nhắc nợ.<br />\n\t\t\t=> Trường hợp người bị nhắc nợ không biết:<br />\n\t\t\t+ Nếu người bị nhắc nợ có HĐ tại FE: nhập trên HĐ của người bị nhắc nợ => Ghi rõ: chủ thuê bao có hđ số xxx/ số cmnd xxx tại Fe, bị nhắc nợ ở HĐ khác<br />\n\t\t\t+ Nếu người bị nhắc nợ không có HĐ tại FE: nhập trên SĐT gọi lên</td>\n\t\t</tr>",
        "xmttecom": ""
      },
      "Số Tham Chiếu/ Không Có Thông Tin HĐ": {
        "pdf": "NGUNG_NHAC_NO_THAM_CHIEU.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "N/A",
        "xmttemail": "N/A",
        "xmttchat": "N/A",
        "note": "",
        "displayName": "Nhắc Nợ Số Tham Chiếu/ Không Có Thông Tin HĐ",
        "dieukien": "<tr>\n\t\t\t<td style=\"white-space:normal\"><strong><u>Lưu ý nhập liệu:</u></strong><br />\n\t\t\t- Ở Trường \"Số điện thoại đang bị nhắc nợ\": chỉ điền 1 số điện thoại. Nếu KH cần hỗ trợ thêm 1 số khác thì tạo ticket mới<br />\n\t\t\t- Service Case ID: nhập số ticket của lần phản ánh gần nhất<br />\n\t\t\t- Không có dữ liệu: nhập số 0<br />\n\t\t\t<strong>Nhập code:</strong><br />\n\t\t\t- Nhập khiếu nại trên SHĐ bị nhắc nợ.<br />\n\t\t\t=> Trường hợp người bị nhắc nợ không biết:<br />\n\t\t\t+ Nếu người bị nhắc nợ có HĐ tại FE: nhập trên HĐ của người bị nhắc nợ => Ghi rõ: chủ thuê bao có hđ số xxx/ số cmnd xxx tại Fe, bị nhắc nợ ở HĐ khác<br />\n\t\t\t+ Nếu người bị nhắc nợ không có HĐ tại FE: nhập trên SĐT gọi lên</td>\n\t\t</tr>",
        "xmttecom": ""
      },
      "Khách Hàng Đã Thanh Toán": {
        "pdf": "NGUNG_NHAC_NO_DA_THANH_TOAN.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "Đúng SĐT + CMND/ CCCD + 1A",
        "xmttemail": "N/A",
        "xmttchat": "N/A",
        "note": "",
        "displayName": "Khách Hàng Đã Thanh Toán Vẫn Bị Nhắc Nợ",
        "dieukien": "",
        "xmttecom": ""
      },
      "Đang Trong Quá Trình Xử Lý": {
        "pdf": "NGUNG_NHAC_NO_DANG_XU_LY.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "Đúng chủ HĐ + CCCD/ SHĐ + 1A",
        "xmttemail": "N/A",
        "xmttchat": "N/A",
        "note": "",
        "displayName": "Đang Trong Quá Trình Xử Lý Nhắc Nợ",
        "dieukien": "<p>Kiểm tra ticket đ&atilde; ghi nhận trước đ&oacute;, bao gồm c&aacute;c code sau: <a href=\"pdfile-loan/7_NHAC_NO/Code_Can_Kiem_Tra.pdf\" target=\"_blank\" rel=\"noopener\">xem tại đ&acirc;y</a></p>",
        "xmttecom": ""
      }
    }
  },
  "8. MRC/ YÊU CẦU GIẤY TỜ": {
    "MRC": {
      "HĐ FEC": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ FEC"
      },
      "HĐ Cash 24": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Kim An"
      },
      "HĐ Bán Nợ Một Phần": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Một Phần"
      },
      "HĐ Bán Nợ Galaxy": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Galaxy"
      },
      "HĐ Bán Nợ FC SOLD_AZURA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ FC SOLD_AZURA"
      },
      "HĐ Bán Nợ WELCOME VINA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ WELCOME VINA"
      }
    },
    "Giấy Giải Chấp": {
      "HĐ FEC": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ FEC"
      },
      "HĐ Cash 24": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Kim An"
      },
      "HĐ Bán Nợ Một Phần": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Một Phần"
      },
      "HĐ Bán Nợ Galaxy": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Galaxy"
      },
      "HĐ Bán Nợ FC SOLD_AZURA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ FC SOLD_AZURA"
      },
      "HĐ Bán Nợ WELCOME VINA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ WELCOME VINA"
      }
    },
    "Lịch Thanh Toán": {
      "HĐ FEC": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ FEC"
      },
      "HĐ Cash 24": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Kim An"
      },
      "HĐ Bán Nợ Một Phần": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Một Phần"
      },
      "HĐ Bán Nợ Galaxy": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Galaxy"
      },
      "HĐ Bán Nợ FC SOLD_AZURA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ FC SOLD_AZURA"
      },
      "HĐ Bán Nợ WELCOME VINA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ WELCOME VINA"
      }
    },
    "Lịch Sử Thanh Toán": {
      "HĐ FEC": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ FEC"
      },
      "HĐ Cash 24": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Kim An"
      },
      "HĐ Bán Nợ Một Phần": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Một Phần"
      },
      "HĐ Bán Nợ Galaxy": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Galaxy"
      },
      "HĐ Bán Nợ FC SOLD_AZURA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ FC SOLD_AZURA"
      },
      "HĐ Bán Nợ WELCOME VINA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ WELCOME VINA"
      }
    },
    "Giấy Xác Nhận Thanh Lý": {
      "HĐ FEC": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ FEC"
      },
      "HĐ Cash 24": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Cash 24"
      },
      "HĐ Kim An": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Kim An"
      },
      "HĐ Bán Nợ Một Phần": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Một Phần"
      },
      "HĐ Bán Nợ Galaxy": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ Galaxy"
      },
      "HĐ Bán Nợ FC SOLD_AZURA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ FC SOLD_AZURA"
      },
      "HĐ Bán Nợ WELCOME VINA": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "HĐ Bán Nợ WELCOME VINA"
      }
    }
  },
  "9. BẢO HIỂM": {
    "Phí BH": {
      "Bảo Hiểm Khoản Vay": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Bảo Hiểm Khoản Vay"
      },
      "Bảo Hiểm Banca": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Bảo Hiểm Banca"
      },
      "Bảo Hiểm Sức Khỏe": {
        "pdf": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Bảo Hiểm Sức Khỏe"
      }
    },
    "Quyền lợi": {},
    "Thủ tục bồi thường": {},
    "Đăng ký/ tái tục": {}
  },
  "10. HOÀN TIỀN, ĐIỀU CHỈNH THANH TOÁN": {
    "Kiểm Tra Tiền Dư": {},
    "Hoàn Tiền": {},
    "Điều Chỉnh Thanh Toán": {}
  },
  "11. CẬP NHẬT THÔNG TIN": {
    "Cập Nhật SĐT": {
      "Đã Có Hợp Đồng Vay": {
        "Chưa Cập Nhật Trên FEOL 2.0": {
          "Chưa Có Tài Khoản": {
            "pdf": "CAP_NHAT_SDT/CHUA_CO_TAI_KHOAN_FEOL_2.0.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Chưa Có Tài Khoản",
            "dieukien": "<p><strong>Lưu &yacute;:&nbsp;</strong><br>- Nếu c&oacute; cả Loan v&agrave; Card th&igrave; hỗ trợ theo Card<br>- Kh&ocirc;ng hỗ trợ cập nhật th&ocirc;ng tin cho HĐ b&aacute;n nợ to&agrave;n phần&nbsp;</p>",
            "xmttecom": ""
          },
          "Đã Có Tài Khoản": {
            "pdf": "CAP_NHAT_SDT/DA_CO_TAI_KHOAN_FEOL_2.0.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Hướng dẫn thao t&aacute;c qua FE Online 2.0: Kh&ocirc;ng XMTT<br>C&aacute;c TH c&ograve;n lại: CCCD + 2A + 1B</p>",
            "note": "",
            "displayName": "Cập Nhật SDT Đã Có Tài Khoản FEO 2.0",
            "dieukien": "<p><strong>ĐIỀU KIỆN HỖ TRỢ:</strong> KH cần d&ugrave;ng đ&uacute;ng SĐT cần cập nhật li&ecirc;n hệ tổng đ&agrave;i để XMTT. &nbsp;Nếu HĐ closed: KH cần cung cấp th&ecirc;m th&ocirc;ng tin v&agrave; h&igrave;nh ảnh<br><strong>Lưu &yacute;:</strong><br>- Nếu c&oacute; cả Loan v&agrave; Card th&igrave; hỗ trợ theo Card<br>- Kh&ocirc;ng hỗ trợ cập nhật th&ocirc;ng tin cho HĐ b&aacute;n nợ to&agrave;n phần&nbsp;<br>- Inbound: Nếu qu&aacute; 5 ng&agrave;y l&agrave;m việc kể từ thời điểm nhận ticket XMTT th&agrave;nh c&ocirc;ng gần nhất nhưng KH chưa gửi chứng từ, KH cần thực hiện XMTT lại từ đầu&nbsp;<br>- Ecom: kiểm tra ticket XMTT th&agrave;nh c&ocirc;ng của IB trong v&ograve;ng 4 tuần.</p>",
            "xmttecom": ""
          }
        },
        "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Thành Công": {
          "Thẻ Tín Dụng Chưa Được Kích Hoạt": {
            "pdf": "CAP_NHAT_SDT/THE_TIN_DUNG_CHUA_DUOC_KICH_HOAT.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Thẻ Tín Dụng Chưa Được Kích Hoạt",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Thẻ Tín Dụng Đang Còn Dư Nợ": {
            "pdf": "CAP_NHAT_SDT/THE_TIN_DUNG_DANG_CON_DU_NO.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Thẻ Tín Dụng Đang Còn Dư Nợ",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Thẻ Tín Dụng Đang Bị Khóa": {
            "pdf": "CAP_NHAT_SDT/THE_TIN_DUNG_DANG_BI_KHOA.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Thẻ Tín Dụng Đang Bị Khóa",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Chức Năng Cập Nhật SĐT Không Khả Dụng": {
            "pdf": "CAP_NHAT_SDT/CHUC_NANG_CAP_NHAT_SDT_KHONG_KHA_DUNG.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Chức Năng Cập Nhật SĐT Không Khả Dụng",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Rất Tiếc Đã Xảy Ra Lỗi": {
            "pdf": "CAP_NHAT_SDT/RAT_TIEC_DA_XAY_RA_LOI.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Rất Tiếc Đã Xảy Ra Lỗi",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Tính Năng Này Đã Tạm Thời Bị Khóa": {
            "pdf": "CAP_NHAT_SDT/TINH_NANG_TAM_THOI_BI_KHOA.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttemail": "<p>Kh&ocirc;ng XMTT</p>",
            "xmttchat": "<p>Kh&ocirc;ng XMTT</p>",
            "note": "",
            "displayName": "Tính Năng Này Đã Tạm Thời Bị Khóa",
            "dieukien": Cap_nhat_sdt_feo_khong_thanh_cong,
            "xmttecom": ""
          },
          "Yêu Cầu Của Bạn Không Được Tiếp Tục": {
            "pdf": "CAP_NHAT_SDT/YEU_CAU_CUA_BAN_KHONG_DUOC_TIEP_TUC.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>CCCD + 2A + 1B&nbsp;</p>",
            "note": "",
            "displayName": "Yêu Cầu Của Bạn Không Được Tiếp Tục",
            "dieukien": "<p><strong>ĐIỀU KIỆN HỖ TRỢ:</strong> KH d&ugrave;ng đ&uacute;ng SĐT tr&ecirc;n Pega hoặc SĐT muốn cập nhật gọi l&ecirc;n tổng đ&agrave;i để XMTT. &nbsp;Nếu HĐ closed: KH cần cung cấp th&ecirc;m h&igrave;nh ảnh/ chứng từ<br><strong>Lưu &yacute;:</strong><br>- Inbound: Nếu qu&aacute; 5 ng&agrave;y l&agrave;m việc kể từ thời điểm nhận ticket XMTT th&agrave;nh c&ocirc;ng gần nhất nhưng KH chưa gửi chứng từ, KH cần thực hiện XMTT lại từ đầu.&nbsp;<br>- Ecom: Kiểm tra ticket XMTT th&agrave;nh c&ocirc;ng của IB trong v&ograve;ng 4 tuần.</p>",
            "xmttecom": ""
          },
          "Không Thuộc Các Lỗi Trên": {
            "pdf": "CAP_NHAT_SDT/KHONG_THUOC_CAC_LOI_TREN.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "<p>CMND/CCCD + 2A + 1B</p>",
            "note": "",
            "displayName": "Không Thuộc Các Lỗi Trên",
            "dieukien": "<p><strong>ĐIỀU KIỆN HỖ TRỢ: </strong>KH cần d&ugrave;ng đ&uacute;ng SĐT cần cập nhật li&ecirc;n hệ tổng đ&agrave;i để XMTT. &nbsp;<br><strong>Lưu &yacute;:</strong><br>- Inbound: Nếu qu&aacute; 5 ng&agrave;y l&agrave;m việc kể từ thời điểm nhận ticket XMTT th&agrave;nh c&ocirc;ng gần nhất nhưng KH chưa gửi chứng từ, KH cần thực hiện XMTT lại từ đầu.&nbsp;<br>- Ecom: kiểm tra ticket XMTT th&agrave;nh c&ocirc;ng của IB trong v&ograve;ng 4 tuần.</p>",
            "xmttecom": ""
          }
        },
        "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Đồng Bộ": {
          "pdf": "CAP_NHAT_SDT/DA_CAP_NHAT_TREN_FEOL_2.0_NHUNG_KHONG_DONG_BO.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "note": "",
          "displayName": "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Đồng Bộ",
          "dieukien": "",
          "xmttecom": ""
        }
      },
      "Chưa Có Hợp Đồng Vay": {
        "pdf": "CAP_NHAT_SDT/CHUA_CO_HOP_DONG_VAY.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "<p><strong>TH từ App về Pega:</strong> CCCD + 2A + 1B&nbsp;<br><strong>TH từ Pega về App:</strong> SĐT đ&uacute;ng tr&ecirc;n PEGA</p>",
        "note": "",
        "displayName": "Chưa Có Hợp Đồng Vay",
        "dieukien": "<p><strong>ĐIỀU KIỆN HỖ TRỢ:&nbsp;</strong><br>- TH từ App về Pega: KH cần d&ugrave;ng đ&uacute;ng SĐT cần cập nhật li&ecirc;n hệ tổng đ&agrave;i để XMTT<br>- TH từ Pega về App: KH cần d&ugrave;ng đ&uacute;ng SĐT tr&ecirc;n Pega li&ecirc;n hệ tổng đ&agrave;i để y&ecirc;u cầu hỗ trợ.</p>",
        "xmttecom": ""
      }
    },
    "Cập Nhật Email": {
      "Chưa Cập Nhật Trên FEOL 2.0": {
        "pdf": "",
        "xmttib": "",
        "note": "",
        "displayName": "Chưa Cập Nhật Trên FEOL 2.0",
        "dieukien": "",
        "xmttecom": ""
      },
      "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Thành Công": {
        "Lỗi “Email này trùng với email hiện tại”": {
          "Ký HĐ trước ngày 21/07/2025": {
            "pdf": "",
            "xmttib": "",
            "note": "",
            "displayName": "Ký HĐ trước ngày 21/07/2025",
            "dieukien": "",
            "xmttecom": ""
          },
          "Ký HĐ từ ngày 21/07/2025 về sau": {
            "pdf": "",
            "xmttib": "",
            "note": "",
            "displayName": "Ký HĐ từ ngày 21/07/2025 về sau",
            "dieukien": "",
            "xmttecom": ""
          }
        },
        "Các Lỗi Khác": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Các Lỗi Khác",
          "dieukien": "",
          "xmttecom": ""
        }
      },
      "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Đồng Bộ": {
        "pdf": "",
        "xmttib": "",
        "note": "",
        "displayName": "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Đồng Bộ",
        "dieukien": "",
        "xmttecom": ""
      }
    },
    "Cập Nhật Địa Chỉ": {
      "pdf": "",
      "xmttib": "",
      "note": "",
      "displayName": "Cập Nhật Địa Chỉ",
      "dieukien": "",
      "xmttecom": ""
    },
    "Cập Nhật CMND/ CCCD": {
      "Chưa Cập Nhật Trên FEOL 2.0": {
        "pdf": "",
        "xmttib": "",
        "note": "",
        "displayName": "Chưa Cập Nhật Trên FEOL 2.0",
        "dieukien": "",
        "xmttecom": ""
      },
      "Đã Cập Nhật Trên FEOL 2.0 Nhưng Không Thành Công": {
        "Lỗi Xác Minh Thất Bại": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi Xác Minh Thất Bại",
          "dieukien": "",
          "xmttecom": ""
        },
        "Lỗi Chưa Đủ Tuổi Mở Tài Khoản": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi Chưa Đủ Tuổi Mở Tài Khoản",
          "dieukien": "",
          "xmttecom": ""
        },
        "Lỗi Chụp Ảnh Chưa Đạt Yêu Cầu": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi Chụp Ảnh Chưa Đạt Yêu Cầu",
          "dieukien": "",
          "xmttecom": ""
        },
        "Lỗi CCCD Hết Hạn": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi CCCD Hết Hạn",
          "dieukien": "",
          "xmttecom": ""
        },
        "Lỗi Quá Số Lần Thử Lại": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi Quá Số Lần Thử Lại",
          "dieukien": "",
          "xmttecom": ""
        },
        "Lỗi Khác": {
          "pdf": "",
          "xmttib": "",
          "note": "",
          "displayName": "Lỗi Khác",
          "dieukien": "",
          "xmttecom": ""
        }
      }
    }
  },
  "12. KẾT QUẢ XỬ LÝ YÊU CẦU": {},
  "13. TRA CỨU TỰ ĐỘNG": {
    "FE Online 2.0": {
      "Tính Năng Chung": {
        "Đăng Ký - Đăng Nhập": {
          "pdf": "FEONLINE2.0/dangkytaikhoanFEOL2.0.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Đăng Ký - Đăng Nhập"
        },
        "Xác Thực NFC": {
          "pdf": "FEONLINE2.0/xacthucNFC.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Xác Thực NFC"
        },
        "Đăng Ký Vay": {
          "Đăng Ký Mở Thẻ Tín Dụng": {
            "pdf": "FEONLINE2.0/dangkymothetindung.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Đăng Ký Mở Thẻ Tín Dụng"
          },
          "Đăng Ký Vay Thêm (Topup)": {
            "pdf": "FEONLINE2.0/dangkyvaythem.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Đăng Ký Vay Thêm (Topup)"
          },
          "Đăng Ký Tiền Mặt Linh Hoạt": {
            "pdf": "FEONLINE2.0/dangkytienmatlinhhoat.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Đăng Ký Tiền Mặt Linh Hoạt"
          },
          "Đăng Ký FE Paylater": {
            "pdf": "FEONLINE2.0/dangkyFEPaylater.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Đăng Ký FE Paylater"
          }
        },
        "Thanh Toán Qua Ubank": {
          "pdf": "FEONLINE2.0/thanhtoanquaUbank.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Thanh Toán Qua Ubank"
        },
        "Quét Mã QR Thanh Toán Cho HĐ": {
          "pdf": "FEONLINE2.0/quetmaQRthanhtoanchoHD.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Quét Mã QR Thanh Toán Cho HĐ"
        },
        "Kiểm Tra Giao Dịch KH Vừa Thanh Toán": {
          "pdf": "FEONLINE2.0/kiemtragiaodichvuathanhtoan.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Kiểm Tra Giao Dịch KH Vừa Thanh Toán"
        },
        "Cập Nhật Email": {
          "pdf": "FEONLINE2.0/capnhatemail.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Cập Nhật Email"
        },
        "Cập Nhật CCCD": {
          "pdf": "FEONLINE2.0/capnhatCCCD.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Cập Nhật CCCD"
        },
        "Cập Nhật SĐT": {
          "pdf": "FEONLINE2.0/capnhatSDT.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Cập Nhật SĐT"
        },
        "Trung Tâm Hỗ Trợ": {
          "pdf": "FEONLINE2.0/trungtamhotro.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Trung Tâm Hỗ Trợ"
        },
        "Tra Cứu Kết Quả Xử Lý": {
          "pdf": "FEONLINE2.0/tracuuketquaxuly.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Tra Cứu Kết Quả Xử Lý"
        }
      },
      "Quản Lý Khoản Vay": {
        "pdf": "FEONLINE2.0/quanlykhoanvay.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "FE Online 2.0: Tra Cứu Quản Lý Khoản Vay"
      },
      "Quản Lý Thẻ Tín Dụng": {
        "Thông Tin Thẻ": {
          "pdf": "FEONLINE2.0/thongtinthe.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Thông Tin Thẻ"
        },
        "Trạng Thái Thẻ|| Tình Trạng Giao Phát Thẻ": {
          "pdf": "FEONLINE2.0/quanlythetindung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Trạng Thái Thẻ - Tình Trạng Giao Phát Thẻ"
        },
        "Bản Scan HĐ": {
          "pdf": "FEONLINE2.0/quanlythetindung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Bản Scan HĐ"
        },
        "Thông Tin IPP": {
          "pdf": "FEONLINE2.0/quanlythetindung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Thông Tin IPP"
        },
        "Lịch Sử Giao Dịch/Thanh Toán": {
          "pdf": "FEONLINE2.0/quanlythetindung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Lịch Sử Giao Dịch/Thanh Toán"
        },
        "Dư Nợ, Sao Kê": {
          "pdf": "FEONLINE2.0/quanlythetindung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Dư Nợ, Sao Kê"
        },
        "Nghiệp Vụ Thẻ": {
          "Kích Hoạt Thẻ": {
            "pdf": "FEONLINE2.0/kichhoatthe.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Kích Hoạt Thẻ"
          },
          "Thay Đổi Mã Pin Thẻ ATM": {
            "pdf": "FEONLINE2.0/quanlythetindung.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Thay Đổi Mã Pin Thẻ ATM"
          },
          "Chuyển Đổi Trả Góp (Retail)": {
            "pdf": "FEONLINE2.0/chuyendoitragop.pdf",
            "contentType": "",
            "htmlContent": "",
            "htmlUrl": "",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Chuyển Đổi Trả Góp (Retail)"
          },
          "Tra Cứu/Đổi Điểm Thưởng": {
            "pdf": "diemthuong.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Tra Cứu/Đổi Điểm Thưởng"
          },
          "Rút Tiền Mặt Từ Thẻ Tín Dụng": {
            "pdf": "ruttienmattuthe.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Rút Tiền Mặt Từ Thẻ Tín Dụng"
          },
          "Thanh Toán Trực Tuyến/Thanh Toán Nước Ngoài/Cài Đặt Hạn Mức": {
            "pdf": "tinhnangthanhtoantructuyen.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Thanh Toán Trực Tuyến/Thanh Toán Nước Ngoài/Cài Đặt Hạn Mức"
          },
          "FLEXI BUY - Thanh Toán Linh Hoạt": {
            "pdf": "flexibuy.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "Tra Cứu FLEXI BUY - Thanh Toán Linh Hoạt"
          },
          "Gia Hạn Thẻ": {
            "pdf": "giahanthe.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Gia Hạn Thẻ"
          },
          "Đóng/Mở Khóa A": {
            "pdf": "quanlythetindung.pdf",
            "xmttib": "",
            "xmttemail": "",
            "note": "",
            "displayName": "FE Online 2.0: Tra Cứu Đóng/Mở Khóa A"
          }
        }
      },
      "Quản Lý  Sản Phẩm Tiền Mặt Linh Hoạt (FlexiMoney)": {
        "Thông Tin IPP": {
          "pdf": "FEONLINE2.0/quanlyfleximoney.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Thông Tin IPP (FlexiMoney)"
        },
        "Xem Chi Tiết Hợp Đồng": {
          "pdf": "FEONLINE2.0/quanlyfleximoney.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Xem Chi Tiết Hợp Đồng (FlexiMoney)"
        },
        "Lịch Sử Giao Dịch/Thanh Toán": {
          "pdf": "FEONLINE2.0/quanlyfleximoney.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Tra Cứu Lịch Sử Giao Dịch/Thanh Toán"
        },
        "Tải Bản Sao Kê": {
          "pdf": "FEONLINE2.0/taibansaoke.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Tải Bản Sao Kê (FlexiMoney)"
        },
        "Gia Hạn Thẻ": {
          "pdf": "FEONLINE2.0/giahanthefleximoney.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "FE Online 2.0: Tra Cứu Gia Hạn Thẻ (FlexiMoney)"
        }
      },
      "Quản Lý Tài Khoản Ubank": {
        "pdf": "FEONLINE2.0/quanlytaikhoanUbank.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "xmttemail": "",
        "note": "",
        "displayName": "Tra Cứu Quản Lý Tài Khoản Ubank"
      },
      "Quản Lý FE Paylater": {
        "Đăng Ký Tài Khoản": {
          "pdf": "FEONLINE2.0/quanlyFEPaylater.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Paylater Đăng Ký Tài Khoản"
        },
        "Thanh Toán Hóa Đơn Nước Tại Payoo": {
          "pdf": "FEONLINE2.0/thanhtoanhoadon.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Paylater Thanh Toán Hóa Đơn Nước Tại Payoo"
        },
        "Thanh Toán Dư Nợ": {
          "pdf": "FEONLINE2.0/thanhtoanduno.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Paylater Thanh Toán Dư Nợ"
        },
        "Kiểm Tra Sao Kê": {
          "pdf": "FEONLINE2.0/saokeFEPaylater.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "\n",
          "displayName": "Paylater: Kiểm Tra Sao Kê"
        },
        "Lịch Sử Giao Dịch": {
          "pdf": "FEONLINE2.0/lichsugiaodichFEPaylater.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Paylater: Lịch Sử Giao Dịch"
        },
        "Thông Tin IPP": {
          "pdf": "FEONLINE2.0/lichsugiaodichFEPaylater.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Thông Tin IPP"
        },
        "Tính Năng Thanh Toán Linh Hoạt (Flexibuy)": {
          "pdf": "FEONLINE2.0/tinhnangFlexibuy.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Paylater: Tính Năng Thanh Toán Linh Hoạt (Flexibuy)"
        }
      },
      "Lỗi Ứng Dụng": {
        "Lỗi Đăng Ký Tài Khoản": {
          "pdf": "FEONLINE2.0/loidangkytaikhoan.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Đăng Ký Tài Khoản"
        },
        "Lỗi Đăng Nhập/Không Liên Kết Tài Khoản Thanh Toán": {
          "pdf": "FEONLINE2.0/loidangnhap.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Đăng Nhập/Không Liên Kết Tài Khoản Thanh Toán"
        },
        "Lỗi EKYC/Chụp Hình": {
          "pdf": "FEONLINE2.0/loiEYKC.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi EKYC/Chụp Hình"
        },
        "Lỗi xác thực NFC": {
          "pdf": "FEONLINE2.0/loixacthucNFC.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi xác thực NFC"
        },
        "Lỗi Không Hiển Thị Khoản Vay/Thẻ": {
          "pdf": "FEONLINE2.0/loikohienthikhoanvay.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Không Hiển Thị Khoản Vay/Thẻ"
        },
        "Lỗi Tính Năng Cập Nhật Thông Tin": {
          "pdf": "FEONLINE2.0/loitinhnangcapnhatthongtin.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Tính Năng Cập Nhật Thông Tin"
        },
        "Lỗi Bật/Tắt Tính Năng Thanh Toán Trực Tuyến": {
          "pdf": "FEONLINE2.0/loitinhnangthanhtoantructuyen.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Bật/Tắt Tính Năng Thanh Toán Trực Tuyến"
        },
        "Lỗi Tính Năng TMN": {
          "pdf": "FEONLINE2.0/loitinhnangTMN.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Tính Năng TMN"
        },
        "Yêu Cầu Mở Khóa Thiết Bị": {
          "pdf": "FEONLINE2.0/loitinhnangTMN.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Yêu Cầu Mở Khóa Thiết Bị"
        },
        "Lỗi Màn Hình Trắng/Văng Khỏi Ứng Dụng/Không Ổn Định": {
          "pdf": "FEONLINE2.0/loimanhinhtrang.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Lỗi Màn Hình Trắng/Văng Khỏi Ứng Dụng/Không Ổn Định"
        },
        "Các Lỗi Khác": {
          "pdf": "FEONLINE2.0/xulyloiungdung.pdf",
          "contentType": "",
          "htmlContent": "",
          "htmlUrl": "",
          "xmttib": "",
          "xmttemail": "",
          "note": "",
          "displayName": "Các Lỗi Khác"
        }
      }
    },
    "Zalo (Chatbot)": {
      "Tính Năng Chung": {
        "pdf": "ZALO_CHATBOT/tinhnangchung.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Zalo: Tính Năng Chung",
        "dieukien": "",
        "xmttecom": ""
      },
      "Quản Lý Khoản Vay": {
        "pdf": "ZALO_CHATBOT/quanlykhoanvay.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Zalo: Quản Lý Khoản Vay",
        "dieukien": "",
        "xmttecom": ""
      },
      "Quản Lý Thẻ Tín Dụng": {
        "pdf": "ZALO_CHATBOT/quanlythe.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "Zalo: Quản Lý Thẻ Tín Dụng",
        "dieukien": "",
        "xmttecom": ""
      }
    },
    "Website": {
      "Quản Lý Khoản Vay": {},
      "Quản Lý Thẻ Tín Dụng": {},
      "Lỗi Website": {}
    },
    "SMS": {
      "Tra Cứu Thẻ Tín Dụng": {
        "pdf": "tracuuthe.pdf",
        "contentType": "",
        "htmlContent": "",
        "htmlUrl": "",
        "xmttib": "",
        "note": "",
        "displayName": "SMS: Tra Cứu Thẻ Tín Dụng",
        "dieukien": "",
        "xmttecom": ""
      }
    }
  }
};

window.flowchartDataFeedback = {
  "1. THÁI ĐỘ NHÂN VIÊN": {
    "Thái Độ Nhân Viên Qua Cuộc Gọi": {
      "pdf": "",
      "xmttib": XMTT_1,
      "note": "Ghi nhận góp ý tích cực về Dịch vụ khách hàng của sản phẩm thẻ.",
      "displayName": "Thái Độ Nhân Viên Qua Cuộc Gọi"
    },
    "Thái Độ Nhân Viên SMS/Zalo": {
      "pdf": "",
      "xmttib": XMTT_1,
      "note": "Ghi nhận góp ý tích cực về tính năng sản phẩm thẻ.",
      "displayName": "Thái Độ Nhân Viên SMS/Zalo"
    }
  },
  "2. NGHIỆP VỤ": {
    "Nghiệp Vụ Nhân Viên Sale": {
      "pdf": "",
      "xmttib": XMTT_1,
      "note": "Ghi nhận góp ý tiêu cực về Dịch vụ khách hàng của sản phẩm thẻ.",
      "displayName": "Nghiệp Vụ Nhân Viên Sale"
    },
    "Nghiệp Vụ Nhân Viên DVKH": {
      "pdf": "",
      "xmttib": XMTT_1,
      "note": "Ghi nhận góp ý tiêu cực về tính năng sản phẩm thẻ.",
      "displayName": "Nghiệp Vụ Nhân Viên DVKH"
    }
  }
};


  </script>
  <!-- FLOWCHART_DATA_END -->

  <script>

    document.addEventListener("DOMContentLoaded", () => {

      if (
        typeof window.flowchartData === "undefined" ||
        typeof window.flowchartDataFeedback === "undefined"
      ) {
        alert(
          "Lỗi: Không thể tải dữ liệu điều kiện. Vui lòng kiểm tra các file .js và thử lại."
        );

        return;
      }

      const dynamicFiltersContainer = document.getElementById(
        "dynamic-filters-container"
      );
      const notesResult = document.getElementById("notes-result");
      const pdfViewer = document.getElementById("pdf-viewer");
      const htmlViewer = document.getElementById("html-viewer");
      const sidebarToggle = document.getElementById("sidebar-toggle");
      const mainHeader = document.getElementById("main-header");
      const body = document.body;
      const headerSearch = document.getElementById("header-search");
      const searchResultsContainer = document.getElementById(
        "search-results-container"
      );
      const subHeader = document.getElementById("sub-header");
      const toastContainer = document.getElementById("toast-container");
      const popup = document.getElementById("custom-popup");
      const popupContent = document.getElementById("popup-content");
      const popupCloseBtn = document.getElementById("popup-close-btn");
      const sidebar = document.getElementById("sidebar");

      const FOLDER_MAPS = {
        truyvan: {
          1: "1_THONG_TIN_CHUNG",
          2: "2_THONG_TIN_SAN_PHAM",
          3: "3_DANG_KY_VAY",
          4: "4_GIAI_NGAN",
          5: "5_KENH_THANH_TOAN",
          6: "6_VAN_DE_THANH_TOAN",
          7: "7_NHAC_NO",
          8: "8_MRC_YEUCAUGIAYTO",
          9: "9_BAO_HIEM",
          10: "10_HOANTIEN_DIEUCHINHTHANHTOAN",
          11: "11_CAP_NHAT_THONG_TIN",
          12: "12_KET_QUA_XULYYEUCAU",
          13: "13_TRA_CUU_TU_DONG",
        },
        feedback: {
          1: "A1_KHIEU_NAI_THAI_DO",
          2: "A2_KHIEU_NAI_NGHIEP_VU",
        },
      };

      const LEVEL_LABELS = {
        truyvan: {
          1: "CHỌN VẤN ĐỀ:",
          2: "CHỌN CHI TIẾT VẤN ĐỀ:",
          3: "CHỌN ĐIỀU KIỆN 1:",
          4: "CHỌN ĐIỀU KIỆN 2:",
          5: "CHỌN ĐIỀU KIỆN 3:",
        },
        feedback: {
          1: "Chọn loại góp ý:",
          2: "Chọn chi tiết:",
        },
      };

      // === PAGE_CONFIG ===
      // Cấu hình riêng cho từng trang (LOAN, CARD, OUTBOUND, UBANK)
      // Khi copy sang file khác, chỉ cần sửa phần này
      const PAGE_CONFIG = {
        productName: 'LOAN',                    // Tên sản phẩm: LOAN, CARD, OUTBOUND, UBANK
        defaultPdf: './pdfile-loan/loan.pdf', // PDF mặc định khi load trang
        pageTitle: 'LOAN',               // Tiêu đề trang
        sessionPrefix: 'loan',                   // Prefix cho sessionStorage keys

        // Icon SVG cho sidebar header (copy từ dropdown menu)
        sidebarIcon: `<path d="M1.5 3a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-12a.5.5 0 0 1-.5-.5v-2z"></path>
          <path d="M1 6.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1z"></path>
          <path d="M1 9.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1zm13.5 2.5a.5.5 0 0 0-.5-.5h-13a.5.5 0 0 0 0 1h13a.5.5 0 0 0 .5-.5z"></path>`,

        // Folder mappings cho từng source
        folderMaps: FOLDER_MAPS,

        // Labels cho các level dropdown
        levelLabels: LEVEL_LABELS
      };

      // === FLAT_DATA_CACHE ===
      // Cache dữ liệu đã flatten cho search, tránh chạy lại flattenFlowchart mỗi lần chuyển tab
      const FLAT_DATA_CACHE = {
        truyvan: null,
        feedback: null
      };

      const DEFAULT_CONTENT = {
        type: 'pdf',
        pdf: PAGE_CONFIG.defaultPdf,  // Sử dụng config thay vì hardcode
      };

      const state = {
        activeData: null,           // Dữ liệu flowchart đang hoạt động
        searchSelectedIndex: -1,    // Index của kết quả tìm kiếm đang chọn
        flattenedData: [],          // Dữ liệu đã làm phẳng cho tìm kiếm
        activeSourceName: null,     // Tên nguồn dữ liệu đang chọn (truyvan/feedback)
        isTabActive: false,         // Tab có đang active không
      };

      const dataSources = {
        truyvan: window.flowchartData,       // Dữ liệu truy vấn chính
        feedback: window.flowchartDataFeedback,  // Dữ liệu góp ý
      };

      const isObject = (value) => typeof value === "object" && value !== null;

      const isLeaf = (node) => isObject(node) && (node.pdf !== undefined || node.contentType !== undefined || node.htmlContent !== undefined || node.htmlUrl !== undefined);

      const removeAccents = (str) => {
        if (!str) return "";
        return str
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "")
          .replace(/đ/g, "d")
          .replace(/Đ/g, "D");
      };

      // Hàm chuyển đổi ký hiệu || thành xuống dòng khi hiển thị
      // Dùng cho dropdown items và search results
      const formatDisplayText = (text) => {
        if (!text) return "";
        return text.replace(/\|\|/g, '<br>');
      };

      // Hàm flatten flowchart data cho search
      // Trả về array thay vì gán trực tiếp vào state (cho phép cache)
      // Hỗ trợ node vừa có content (pdf, displayName) vừa có children (group có sub-items)
      function flattenFlowchart(node, path = [], breadcrumb = [], result = []) {
        // Danh sách các key thuộc tính content (không phải children)
        const CONTENT_KEYS = ['displayName', 'pdf', 'note', 'xmttib', 'xmttemail', 'xmttchat',
          'dieukien', 'contentType', 'htmlContent', 'htmlUrl', 'alert', 'tieudeflow', 'xmtt'];

        Object.keys(node).forEach((key) => {
          const newPath = [...path, key];
          const newBreadcrumb = [...breadcrumb, key.replace(/^\d+\.\s*/, "")];
          const childNode = node[key];

          if (!isObject(childNode)) return; // Bỏ qua giá trị không phải object

          // Kiểm tra node có content không (pdf, htmlContent, htmlUrl, contentType)
          const hasContent = childNode.pdf !== undefined ||
            childNode.contentType !== undefined ||
            childNode.htmlContent !== undefined ||
            childNode.htmlUrl !== undefined;

          // Nếu có content → thêm vào search results (dù có children hay không)
          if (hasContent) {
            const displayText = childNode.displayName || newBreadcrumb.join(" > ");
            result.push({
              path: newPath,
              pdfName: childNode.pdf || "",
              displayText: displayText,
              normalizedDisplayText: removeAccents(displayText.toLowerCase()),
              normalizedPdfName: removeAccents((childNode.pdf || "").toLowerCase()),
            });
          }

          // Tìm và duyệt children (các key không phải thuộc tính content)
          Object.keys(childNode).forEach((subKey) => {
            if (!CONTENT_KEYS.includes(subKey) && isObject(childNode[subKey])) {
              // Đây là children → duyệt tiếp
              flattenFlowchart(
                { [subKey]: childNode[subKey] },
                newPath,
                newBreadcrumb,
                result
              );
            }
          });
        });
        return result;
      }


      // Hàm flatten HEADER_PRESETS cho search
      // Trả về array các item từ header presets để search
      function flattenHeaderPresets() {
        const result = [];
        Object.keys(HEADER_PRESETS).forEach((presetKey) => {
          const preset = HEADER_PRESETS[presetKey];
          // Chỉ thêm vào search nếu có displayName
          if (preset.displayName) {
            result.push({
              path: ['__HEADER_PRESET__', presetKey], // Đánh dấu đây là header preset
              pdfName: preset.pdf || "",
              displayText: preset.displayName,
              normalizedDisplayText: removeAccents(preset.displayName.toLowerCase()),
              normalizedPdfName: removeAccents((preset.pdf || "").toLowerCase()),
              isHeaderPreset: true, // Flag để xử lý riêng khi click
              presetKey: presetKey
            });
          }
        });
        return result;
      }

      // Hàm lấy flattened data với cache
      // Nếu đã cache thì dùng lại, không cần chạy lại flattenFlowchart
      // Bao gồm cả HEADER_PRESETS để search được
      function getFlattenedData(sourceName) {
        if (!FLAT_DATA_CACHE[sourceName]) {
          console.log(`[Cache] Building cache for: ${sourceName}`);
          // Flatten flowchart data
          const flowchartFlattened = flattenFlowchart(dataSources[sourceName]);
          // Flatten header presets (chỉ thêm 1 lần cho source đầu tiên)
          const headerFlattened = flattenHeaderPresets();
          // Merge cả 2 nguồn
          FLAT_DATA_CACHE[sourceName] = [...flowchartFlattened, ...headerFlattened];
        } else {
          console.log(`[Cache] Using cached data for: ${sourceName}`);
        }
        return FLAT_DATA_CACHE[sourceName];
      }

      // Xóa cache khi cần (ví dụ khi data thay đổi)
      function clearFlatDataCache(sourceName = null) {
        if (sourceName) {
          FLAT_DATA_CACHE[sourceName] = null;
        } else {
          FLAT_DATA_CACHE.truyvan = null;
          FLAT_DATA_CACHE.feedback = null;
        }
      }

      function switchDataSource(sourceName, shouldActivate = true) {
        if (!dataSources[sourceName]) {

          return;
        }

        state.activeSourceName = sourceName;
        state.activeData = dataSources[sourceName];
        state.isTabActive = shouldActivate;

        document.querySelectorAll(".sidebar-tab-btn").forEach((btn) => {
          const isCurrentSource = btn.dataset.source === sourceName;
          btn.classList.toggle("active", isCurrentSource);

          if (!shouldActivate) {
            btn.classList.add("inactive");
            if (isCurrentSource) {
              btn.classList.add("active");
            }
          } else {
            btn.classList.remove("inactive");
          }
        });

        // Sử dụng cache thay vì chạy lại flattenFlowchart mỗi lần
        state.flattenedData = getFlattenedData(sourceName);

        createFirstLevelDropdown();

        resetResults(true);

        updateLoanLinkWithState();
      }

      function initialize() {
        setupEventListeners();

        const urlParams = new URLSearchParams(window.location.search);
        const sourceParam = urlParams.get('source');
        const initialSource = (sourceParam && dataSources[sourceParam]) ? sourceParam : 'truyvan';
        const compressed = urlParams.get('s');

        if (!sourceParam && !compressed) {
          sessionStorage.removeItem('loanFlowchartState');
          sessionStorage.removeItem('loanSource');
        }

        switchDataSource(initialSource, true);

        if (!restoreStateFromURL()) {

          if (compressed) {
            restoreStateFromSession();
          }
        }

        const hasDropdown = dynamicFiltersContainer.querySelector('select[data-level="1"]');
        if (!hasDropdown) {

          createFirstLevelDropdown();
        }

        updateLoanLinkWithState();
      }

      function updateLoanLinkWithState() {

        const loanLink = document.getElementById('loan-btn');
        if (loanLink) {
          const urlParams = new URLSearchParams(window.location.search);
          const compressed = urlParams.get('s');

          if (compressed) {
            loanLink.href = `loan_v2.html#s=${compressed}`;
          } else {
            loanLink.href = `loan_v2.html`;
          }
        }
      }

      function saveStateToURL(path) {
        const jsonPath = JSON.stringify(path);

        appState.type = 'sidebar';
        appState.sidebar = { source: state.activeSourceName, path: path };

        const compressed = LZString.compressToEncodedURIComponent(jsonPath);
        const url = `${window.location.pathname}#source=${state.activeSourceName}&s=${compressed}`;
        history.pushState(appState.snapshot(), "", url);

        sessionStorage.setItem('loanFlowchartState', jsonPath);
        sessionStorage.setItem('loanSource', state.activeSourceName);

        updateLoanLinkWithState();
      }

      function restoreStateFromURL() {





        let urlParams;
        let isFromHash = false;

        if (window.location.hash && window.location.hash.includes('=')) {

          urlParams = new URLSearchParams(window.location.hash.substring(1));
          isFromHash = true;

        } else {

          urlParams = new URLSearchParams(window.location.search);

        }

        const compressed = urlParams.get('s');      // Dữ liệu đường dẫn đã nén
        const sourceParam = urlParams.get('source'); // Nguồn dữ liệu
        let headerPdf = urlParams.get('pdf');      // PDF từ header
        const presetParam = urlParams.get('preset'); // Preset từ header (hỗ trợ open new tab)

        // Xử lý preset param - cho phép open new tab từ header links
        if (presetParam && window.HEADER_PRESETS && window.HEADER_PRESETS[presetParam]) {
          const preset = window.HEADER_PRESETS[presetParam];
          if (preset.pdf) {
            navigateTo('header-pdf', {
              pdfName: preset.pdf,
              dieukien: preset.dieukien || '',
              note: preset.note || '',
              xmttib: preset.xmttib || '',
              xmttchat: preset.xmttchat || '',
              xmttemail: preset.xmttemail || '',
              displayName: preset.displayName || ''
            }, false);
            return true;
          }
        }

        if (headerPdf) {


          if (sourceParam && dataSources[sourceParam]) {
            switchDataSource(sourceParam, true);
          }

          removeDropdowns(1);
          createFirstLevelDropdown();

          if (history.state && history.state.isHeaderPdf) {


            displayConditionInfo(history.state.dieukien || '');

            const notesResult = document.getElementById("notes-result");
            const xmttIbContent = document.getElementById("xmtt-ib-content");
            const xmttEmailContent = document.getElementById("xmtt-email-content");
            const xmttChatContent = document.getElementById("xmtt-chat-content");

            if (history.state.note && notesResult) {
              notesResult.innerHTML = `<p>${history.state.note}</p>`;
              const notesBox = document.getElementById("notes-box");
              if (notesBox) notesBox.style.display = '';
            }
            if (history.state.xmttib && xmttIbContent) {
              xmttIbContent.innerHTML = `<p>${history.state.xmttib}</p>`;
              const xmttIbBox = document.getElementById("xmtt-ib-box");
              if (xmttIbBox) xmttIbBox.style.display = '';
            }
            if (history.state.xmttchat && xmttChatContent) {
              xmttChatContent.innerHTML = `<p>${history.state.xmttchat}</p>`;
              const xmttChatBox = document.getElementById("xmtt-chat-box");
              if (xmttChatBox) xmttChatBox.style.display = '';
            }
            if (history.state.xmttemail && xmttEmailContent) {
              xmttEmailContent.innerHTML = `<p>${history.state.xmttemail}</p>`;
              const xmttEmailBox = document.getElementById("xmtt-email-box");
              if (xmttEmailBox) xmttEmailBox.style.display = '';
            }
          } else {

            resetResults();
          }

          pdfViewer.src = `./pdfile-loan/${decodeURIComponent(headerPdf)}`;
          pdfViewer.style.display = 'block';
          return true;
        }

        if (compressed) {

          try {

            if (sourceParam && dataSources[sourceParam]) {
              switchDataSource(sourceParam, true);
            }

            const jsonPath = LZString.decompressFromEncodedURIComponent(compressed);
            const path = JSON.parse(jsonPath);

            if (Array.isArray(path)) {
              applySearchResult(path, false);

              sessionStorage.setItem('loanFlowchartState', jsonPath);

              sessionStorage.setItem('loanSource', state.activeSourceName);
              updateLoanLinkWithState();
              return true; // Indicate success
            }
          } catch (e) {

            return false; // Thất bại
          }
        }


        return false; // Không tìm thấy state
      }

      function restoreStateFromSession() {
        const jsonPath = sessionStorage.getItem('loanFlowchartState');
        if (jsonPath) {
          try {
            const path = JSON.parse(jsonPath);

            if (Array.isArray(path) && path.length > 0) {

              applySearchResult(path, true);
            } else if (Array.isArray(path) && path.length === 0) {

            }
          } catch (e) {


            sessionStorage.removeItem('loanFlowchartState');
            sessionStorage.removeItem('loanSource');
          }
        }
      }

      function searchFlowchartData(query) {
        if (!query) return [];

        const queryWords = removeAccents(query.toLowerCase())
          .split(/\s+/)
          .filter(word => word.length > 0);

        if (queryWords.length === 0) return [];

        return state.flattenedData.filter((item) => {
          const searchText = item.normalizedDisplayText + ' ' + item.normalizedPdfName;
          return queryWords.every(word => searchText.includes(word));
        });
      }

      function displaySearchResults(results) {
        searchResultsContainer.innerHTML = "";
        state.searchSelectedIndex = -1; // Reset selected index
        if (results.length === 0) {
          searchResultsContainer.classList.remove("show");
          return;
        }
        results.slice(0, 10).forEach((result, index) => {
          const resultItem = document.createElement("div");
          resultItem.className = "search-result-item";
          resultItem.innerHTML = formatDisplayText(result.displayText);
          resultItem.dataset.path = JSON.stringify(result.path);
          resultItem.dataset.index = index; // Store index for keyboard navigation
          searchResultsContainer.appendChild(resultItem);
        });
        searchResultsContainer.classList.add("show");
      }

      function updateSearchHighlight() {
        const items = searchResultsContainer.querySelectorAll('.search-result-item');
        items.forEach((item, index) => {
          if (index === state.searchSelectedIndex) {
            item.classList.add('selected');

            item.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
          } else {
            item.classList.remove('selected');
          }
        });
      }

      function selectCurrentSearchResult() {
        const items = searchResultsContainer.querySelectorAll('.search-result-item');
        if (state.searchSelectedIndex >= 0 && state.searchSelectedIndex < items.length) {
          const selectedItem = items[state.searchSelectedIndex];
          if (selectedItem?.dataset.path) {
            applySearchResult(JSON.parse(selectedItem.dataset.path));
          }
        }
      }

      function applySearchResult(path, shouldSaveState = true) {

        if (!path || path.length === 0) {

          return;
        }

        // Xử lý đặc biệt cho HEADER_PRESETS
        // Nếu path bắt đầu bằng '__HEADER_PRESET__', trigger click preset
        if (path[0] === '__HEADER_PRESET__') {
          const presetKey = path[1];
          if (HEADER_PRESETS[presetKey]) {
            // Tìm và click button có data-preset tương ứng
            const presetBtn = document.querySelector(`[data-preset="${presetKey}"]`);
            if (presetBtn) {
              presetBtn.click();
            } else {
              // Nếu không tìm thấy button, xử lý trực tiếp
              handleHeaderPresetClick(presetKey, HEADER_PRESETS[presetKey]);
            }
          }
          // Đóng search results
          searchResultsContainer.classList.remove('show');
          headerSearch.value = '';
          return;
        }


        removeDropdowns(1);
        let currentDataNode = state.activeData;
        path.forEach((key, index) => {
          if (!currentDataNode || !currentDataNode[key]) {

            return;
          }
          const level = index + 1;
          const options = Object.keys(currentDataNode);
          createDropdown(options, level, currentDataNode);

          const select = dynamicFiltersContainer.querySelector(
            `select[data-level="${level}"]`
          );
          if (select) {
            select.value = key;
          }

          const customDropdown = dynamicFiltersContainer.querySelector(
            `.custom-dropdown[data-level="${level}"]`
          );
          if (customDropdown) {

            const dropdownText = customDropdown.querySelector('.dropdown-text');
            if (dropdownText) {
              dropdownText.textContent = key;
            }

            const items = customDropdown.querySelectorAll('.dropdown-item');
            items.forEach(item => {
              item.classList.remove('selected');
              if (item.dataset.value === key) {
                item.classList.add('selected');
              }
            });
          }

          currentDataNode = currentDataNode[key];
        });

        if (isLeaf(currentDataNode)) {
          displayResult(currentDataNode);
          if (shouldSaveState) saveStateToURL(path);
        }
        searchResultsContainer.classList.remove("show");
        headerSearch.value = "";
        headerSearch.blur();
      }

      function createFirstLevelDropdown() {
        dynamicFiltersContainer.innerHTML = "";
        createDropdown(Object.keys(state.activeData), 1, state.activeData);
      }

      function createDropdown(options, level, dataNode, parentNode = null) {
        const filterGroup = document.createElement("div");
        filterGroup.className = "filter-group";
        const label = document.createElement("label");
        label.className = "filter-label";

        let labelText = LEVEL_LABELS[state.activeSourceName][level] || `Cấp ${level}:`;
        if (parentNode && parentNode.tieudeflow) {
          labelText = parentNode.tieudeflow;
        }



        label.textContent = labelText;
        filterGroup.appendChild(label);

        const customDropdown = document.createElement("div");
        customDropdown.className = "custom-dropdown";
        customDropdown.dataset.level = level;

        const hiddenSelect = document.createElement("select");
        hiddenSelect.className = "filter-select";
        hiddenSelect.dataset.level = level;
        hiddenSelect.style.display = "none";
        hiddenSelect.innerHTML = '<option value="">-- Chọn --</option>';
        options.forEach((text) => {
          const option = document.createElement("option");
          option.value = text;
          option.textContent = text;
          hiddenSelect.appendChild(option);
        });

        const dropdownHeader = document.createElement("div");
        dropdownHeader.className = "dropdown-header";
        dropdownHeader.innerHTML = '<span class="dropdown-text">-- Chọn --</span><span class="dropdown-arrow">▼</span>';

        const dropdownList = document.createElement("ul");
        dropdownList.className = "dropdown-list";

        // Hàm helper để build path từ các select hiện tại
        const getCurrentPath = () => {
          return Array.from(document.querySelectorAll('.filter-select'))
            .map(s => s.value)
            .filter(Boolean);
        };

        // Hàm helper để build URL từ path
        const buildSidebarUrl = (path) => {
          const compressed = LZString.compressToEncodedURIComponent(JSON.stringify(path));
          return `${window.location.pathname}#source=${state.activeSourceName}&s=${compressed}`;
        };

        const defaultLi = document.createElement("li");
        defaultLi.className = "dropdown-item";
        defaultLi.dataset.value = "";
        defaultLi.textContent = "-- Chọn --";
        dropdownList.appendChild(defaultLi);

        options.forEach((text) => {
          // Dùng a thay vì li để hỗ trợ open new tab
          const li = document.createElement("a");
          li.className = "dropdown-item";
          li.dataset.value = text;
          li.innerHTML = formatDisplayText(text);

          // Tạo href động cho open new tab
          const currentPath = getCurrentPath();
          const newPath = [...currentPath.slice(0, level - 1), text];
          li.href = buildSidebarUrl(newPath);

          dropdownList.appendChild(li);
        });

        customDropdown.appendChild(hiddenSelect);
        customDropdown.appendChild(dropdownHeader);
        customDropdown.appendChild(dropdownList);

        dropdownHeader.addEventListener("click", (e) => {
          e.stopPropagation();

          document.querySelectorAll('.custom-dropdown.open').forEach(dd => {
            if (dd !== customDropdown) dd.classList.remove('open');
          });
          customDropdown.classList.toggle("open");
        });

        dropdownList.addEventListener("click", (e) => {
          // Ngăn navigate khi click thường (chỉ open new tab khi chuột phải)
          e.preventDefault();
          if (e.target.classList.contains("dropdown-item")) {
            const value = e.target.dataset.value;
            const text = e.target.textContent;

            dropdownHeader.querySelector('.dropdown-text').innerHTML = formatDisplayText(text);
            customDropdown.classList.remove("open");

            customDropdown.classList.add("just-selected");
            setTimeout(() => {
              customDropdown.classList.remove("just-selected");
            }, 300);

            dropdownList.querySelectorAll('.dropdown-item').forEach(item => {
              item.classList.remove('selected');
            });
            e.target.classList.add('selected');

            hiddenSelect.value = value;

            const changeEvent = new Event("change", { bubbles: true });
            hiddenSelect.dispatchEvent(changeEvent);
          }
        });

        document.addEventListener("click", (e) => {
          if (!customDropdown.contains(e.target)) {
            customDropdown.classList.remove("open");
          }
        });

        hiddenSelect.addEventListener("change", (e) =>
          handleSelection(e, level, dataNode)
        );

        filterGroup.appendChild(customDropdown);
        dynamicFiltersContainer.appendChild(filterGroup);
      }

      function handleSelection(event, level, parentDataNode) {
        const selectedKey = event.target.value;

        removeDropdowns(level + 1);
        resetResults();

        if (!selectedKey) {

          appState.type = 'sidebar';
          appState.sidebar = { source: state.activeSourceName, path: [] };
          const url = `${window.location.pathname}#source=${state.activeSourceName}`;
          history.pushState(appState.snapshot(), "", url);
          return;
        }
        const selectedNode = parentDataNode[selectedKey];

        const hasContent = isObject(selectedNode) && (
          selectedNode.pdf !== undefined ||
          selectedNode.contentType !== undefined ||
          selectedNode.htmlContent !== undefined ||
          selectedNode.htmlUrl !== undefined ||
          selectedNode.note !== undefined ||
          selectedNode.xmttib !== undefined ||
          selectedNode.xmttemail !== undefined ||
          selectedNode.xmttchat !== undefined ||
          selectedNode.xmtt !== undefined ||
          selectedNode.dieukien !== undefined
        );

        if (hasContent && typeof selectedNode.dieukien === 'string') {
          displayConditionInfo(selectedNode.dieukien);
        }

        const contentKeys = ['pdf', 'contentType', 'htmlContent', 'htmlUrl', 'note', 'xmttib', 'xmttemail', 'xmttchat', 'xmtt', 'dieukien', 'displayName', 'alert', 'tieudeflow'];

        const childKeys = Object.keys(selectedNode).filter(key =>
          !contentKeys.includes(key) && isObject(selectedNode[key])
        );

        if (childKeys.length > 0) {
          createDropdown(childKeys, level + 1, selectedNode, selectedNode);
        }

        const path = Array.from(document.querySelectorAll(".filter-select"))
          .map((s) => s.value)
          .filter(Boolean);

        if (path.length > 0) {
          saveStateToURL(path);

          const hasContentToDisplay = selectedNode.pdf || selectedNode.htmlUrl || selectedNode.htmlContent;

          if (!hasContentToDisplay && childKeys.length > 0) {

          } else if (typeof displayResult === 'function') {

            displayResult(selectedNode, path);
          }
        }

      }

      function displayConditionInfo(conditionText) {
        const dieukienPanel = document.getElementById("dieukien-panel");
        const dieukienResult = document.getElementById("dieukien-result");

        if (conditionText) {

          if (dieukienPanel) dieukienPanel.classList.remove("hidden");
          if (dieukienResult) dieukienResult.innerHTML = `\u003cp\u003e${conditionText}\u003c/p\u003e`;
        } else {

          if (dieukienPanel) dieukienPanel.classList.add("hidden");
          if (dieukienResult) dieukienResult.innerHTML = "\u003cp\u003eĐiều kiện sẽ hiển thị ở đây khi chọn\u003c/p\u003e";
        }

        updatePopupIfOpen();
      }

      function repositionPopup() {
        if (popup.classList.contains("hidden")) {
          return;
        }
        const subHeaderRect = subHeader.getBoundingClientRect();
        const mainHeaderHeight = mainHeader.offsetHeight;
        const sidebarWidth = sidebar.offsetWidth;
        const leftOffset = 5;
        const rightOffset = 20;
        const totalHorizontalMargin = leftOffset + rightOffset;
        popup.style.top = mainHeaderHeight + "px";
        popup.style.left = sidebarWidth + leftOffset + "px";
        popup.style.width = `calc(100vw - ${sidebarWidth}px - ${totalHorizontalMargin}px)`;

      }

      function openPopup(targetBoxId) {
        const sourceBox = document.getElementById(targetBoxId);
        const sourceContent = sourceBox.querySelector(".box-content");
        if (!sourceBox || !sourceContent) {

          return;
        }
        popupContent.innerHTML = "";
        const clonedContent = sourceContent.cloneNode(true);
        popupContent.appendChild(clonedContent);
        popup.classList.remove("hidden");
        repositionPopup();
      }

      function closePopup() {
        popup.classList.add("hidden");
        setTimeout(() => {
          popupContent.innerHTML = "";
        }, 300);
      }

      function updatePopupIfOpen() {

        if (!popup.classList.contains("hidden")) {

          const xmttIbBox = document.getElementById("xmtt-ib-box");
          const xmttEmailBox = document.getElementById("xmtt-email-box");
          const xmttChatBox = document.getElementById("xmtt-chat-box");
          const notesBox = document.getElementById("notes-box");
          const dieukienBox = document.getElementById("dieukien-box");

          const popupHasXmttIb = popupContent.querySelector("#xmtt-ib-content");
          const popupHasXmttEmail = popupContent.querySelector("#xmtt-email-content");
          const popupHasXmttChat = popupContent.querySelector("#xmtt-chat-content");
          const popupHasNotes = popupContent.querySelector("#notes-result");
          const popupHasDieukien = popupContent.querySelector("#dieukien-result");

          let sourceBox = null;
          if (popupHasXmttIb) {
            sourceBox = xmttIbBox;
          } else if (popupHasXmttEmail) {
            sourceBox = xmttEmailBox;
          } else if (popupHasXmttChat) {
            sourceBox = xmttChatBox;
          } else if (popupHasNotes) {
            sourceBox = notesBox;
          } else if (popupHasDieukien) {
            sourceBox = dieukienBox;
          }

          if (sourceBox) {
            const sourceContent = sourceBox.querySelector(".box-content");
            if (sourceContent) {

              popupContent.innerHTML = "";
              const clonedContent = sourceContent.cloneNode(true);
              popupContent.appendChild(clonedContent);
            }
          }
        }
      }

      /**
       * Centralized application state - Single Source of Truth
       * Tất cả navigation state được quản lý tại đây
       */
      const appState = {
        type: null,        // 'sidebar' | 'header-pdf'

        sidebar: {
          source: null,
          path: []         // Array of selections
        },

        headerPdf: {
          pdfName: null,
          dieukien: '',
          note: '',
          xmttib: '',
          xmttchat: '',
          xmttemail: '',
          displayName: '' // Tên hiển thị trên title
        },

        snapshot() {
          return {
            type: this.type,
            sidebar: { ...this.sidebar, path: [...this.sidebar.path] },
            headerPdf: { ...this.headerPdf }
          };
        },

        restore(snapshot) {
          if (!snapshot) return;
          this.type = snapshot.type;
          this.sidebar = snapshot.sidebar ? { ...snapshot.sidebar, path: [...(snapshot.sidebar.path || [])] } : { source: null, path: [] };
          this.headerPdf = snapshot.headerPdf ? { ...snapshot.headerPdf } : { pdfName: null };
        }
      };

      /**
       * Unified Navigation API - Điểm duy nhất để navigate
       * @param {string} type - 'sidebar' | 'header-pdf'
       * @param {Object} data - Navigation data
       * @param {boolean} createHistory - Có tạo history entry không
       */
      function navigateTo(type, data, createHistory = true) {


        appState.type = type;

        if (type === 'sidebar') {
          appState.sidebar = data;
          appState.headerPdf = { pdfName: null }; // Clear header state
        } else if (type === 'header-pdf') {
          appState.headerPdf = data;

        }

        renderState(appState);

        if (createHistory) {
          const url = buildUrlFromState(appState);
          const state = appState.snapshot();

          history.pushState(state, "", url);

        }
      }

      /**
       * Restore state và render UI
       * @param {Object} state - State snapshot từ history
       */
      function restoreState(state) {
        if (!state) {

          return;
        }



        if (state.type) {


          appState.restore(state);
          renderState(appState);
        } else if (state.isHeaderPdf || state.pdf) {


          renderHeaderPdfState({
            pdfName: state.pdf,
            dieukien: state.dieukien || '',
            note: state.note || '',
            xmttib: state.xmttib || '',
            xmttchat: state.xmttchat || '',
            xmttemail: state.xmttemail || '',
            displayName: state.displayName || '' // Thêm displayName khi restore
          });
        } else if (state.path && Array.isArray(state.path)) {


          if (state.source && dataSources[state.source]) {
            switchDataSource(state.source, true);
          }
          applySearchResult(state.path, false);
        } else if (state.source) {


          if (dataSources[state.source]) {
            switchDataSource(state.source, true);
          }
        } else {


          restoreStateFromURL();
        }
      }

      /**
       * Render UI based on current app state
       * @param {Object} state - Current app state
       */
      function renderState(state) {
        if (state.type === 'sidebar') {
          renderSidebarState(state.sidebar);
        } else if (state.type === 'header-pdf') {
          renderHeaderPdfState(state.headerPdf);
        }
      }

      /**
       * Render header PDF state
       */
      function renderHeaderPdfState(pdfState) {

        removeDropdowns(1);
        createFirstLevelDropdown();

        // Cập nhật title theo displayName
        if (pdfState.displayName) {
          document.title = 'LOAN - ' + pdfState.displayName;
        } else {
          document.title = 'LOAN';
        }

        pdfViewer.src = `./pdfile-loan/${pdfState.pdfName}`;
        pdfViewer.style.display = 'block';
        htmlViewer.style.display = 'none';

        displayConditionInfo(pdfState.dieukien || '');

        const subHeader = document.getElementById("sub-header");
        const notesBox = document.getElementById("notes-box");
        const notesResult = document.getElementById("notes-result");
        const xmttIbBox = document.getElementById("xmtt-ib-box");
        const xmttIbContent = document.getElementById("xmtt-ib-content");
        const xmttEmailBox = document.getElementById("xmtt-email-box");
        const xmttEmailContent = document.getElementById("xmtt-email-content");
        const xmttChatBox = document.getElementById("xmtt-chat-box");
        const xmttChatContent = document.getElementById("xmtt-chat-content");

        const hasContent = pdfState.note || pdfState.xmttib || pdfState.xmttchat || pdfState.xmttemail;

        if (hasContent) {
          if (subHeader) subHeader.style.display = '';

          if (pdfState.note && notesResult) {
            notesResult.innerHTML = `<p>${pdfState.note}</p>`;
            if (notesBox) notesBox.style.display = '';
          } else {
            if (notesBox) notesBox.style.display = 'none';
          }

          if (pdfState.xmttib && xmttIbContent) {
            xmttIbContent.innerHTML = `<p>${pdfState.xmttib}</p>`;
            if (xmttIbBox) xmttIbBox.style.display = '';
          } else {
            if (xmttIbBox) xmttIbBox.style.display = 'none';
          }

          if (pdfState.xmttchat && xmttChatContent) {
            xmttChatContent.innerHTML = `<p>${pdfState.xmttchat}</p>`;
            if (xmttChatBox) xmttChatBox.style.display = '';
          } else {
            if (xmttChatBox) xmttChatBox.style.display = 'none';
          }

          if (pdfState.xmttemail && xmttEmailContent) {
            xmttEmailContent.innerHTML = `<p>${pdfState.xmttemail}</p>`;
            if (xmttEmailBox) xmttEmailBox.style.display = '';
          } else {
            if (xmttEmailBox) xmttEmailBox.style.display = 'none';
          }
        } else {

          if (subHeader) subHeader.style.display = 'none';
          if (notesBox) notesBox.style.display = 'none';
          if (xmttIbBox) xmttIbBox.style.display = 'none';
          if (xmttChatBox) xmttChatBox.style.display = 'none';
          if (xmttEmailBox) xmttEmailBox.style.display = 'none';
        }

        if (window.initXmttResize) {

          setTimeout(() => window.initXmttResize(true), 10);
        }
      }

      /**
       * Render sidebar state
       */
      function renderSidebarState(sidebarState) {
        if (!sidebarState.path || sidebarState.path.length === 0) {

          if (sidebarState.source && dataSources[sidebarState.source]) {
            switchDataSource(sidebarState.source, true);
          }
          return;
        }

        if (sidebarState.source && dataSources[sidebarState.source]) {
          switchDataSource(sidebarState.source, true);
        }
        applySearchResult(sidebarState.path, false);
      }

      /**
       * Build URL từ app state
       */
      function buildUrlFromState(state) {
        if (state.type === 'header-pdf') {
          return `${window.location.pathname}#pdf=${encodeURIComponent(state.headerPdf.pdfName)}`;
        } else if (state.type === 'sidebar') {
          const compressed = LZString.compressToEncodedURIComponent(JSON.stringify(state.sidebar.path));
          return `${window.location.pathname}#source=${state.sidebar.source}&s=${compressed}`;
        }
        return window.location.pathname;
      }

      function setupEventListeners() {

        document.getElementById('sidebar-tabs').addEventListener('click', (e) => {
          const source = e.target.dataset.source;

          if (e.target.matches('.sidebar-tab-btn')) {

            if (source !== state.activeSourceName || !state.isTabActive) {

              appState.type = 'sidebar';
              appState.sidebar = { source: source, path: [] };
              const url = `${window.location.pathname}#source=${source}`;
              history.pushState(appState.snapshot(), "", url);

              sessionStorage.removeItem('loanFlowchartState');

              switchDataSource(source, true);
            }

            else if (source === state.activeSourceName && state.isTabActive) {

              removeDropdowns(1);
              createFirstLevelDropdown();
              resetResults(true);

              appState.type = 'sidebar';
              appState.sidebar = { source: source, path: [] };
              const url = `${window.location.pathname}#source=${source}`;
              history.pushState(appState.snapshot(), "", url);

              sessionStorage.removeItem('loanFlowchartState');
            }
          }
        });

        sidebarToggle.addEventListener("click", () => {
          body.classList.toggle("sidebar-collapsed");
          setTimeout(repositionPopup, 300);
        });

        headerSearch.addEventListener("input", (e) =>
          displaySearchResults(searchFlowchartData(e.target.value))
        );
        headerSearch.addEventListener("focus", (e) => {
          if (e.target.value)
            displaySearchResults(searchFlowchartData(e.target.value));
        });

        headerSearch.addEventListener("keydown", (e) => {
          const items = searchResultsContainer.querySelectorAll('.search-result-item');
          const isSearchOpen = searchResultsContainer.classList.contains('show');

          if (!isSearchOpen || items.length === 0) return;

          if (e.key === 'ArrowDown') {
            e.preventDefault();
            state.searchSelectedIndex = Math.min(state.searchSelectedIndex + 1, items.length - 1);
            updateSearchHighlight();
          } else if (e.key === 'ArrowUp') {
            e.preventDefault();
            state.searchSelectedIndex = Math.max(state.searchSelectedIndex - 1, -1);
            updateSearchHighlight();
          } else if (e.key === 'Enter') {
            e.preventDefault();
            if (state.searchSelectedIndex >= 0) {
              selectCurrentSearchResult();
            } else if (items.length > 0) {

              state.searchSelectedIndex = 0;
              selectCurrentSearchResult();
            }
          } else if (e.key === 'Escape') {
            searchResultsContainer.classList.remove('show');
            state.searchSelectedIndex = -1;
          }
        });

        searchResultsContainer.addEventListener("mousedown", (e) => {
          const item = e.target.closest(".search-result-item");
          if (item?.dataset.path)
            applySearchResult(JSON.parse(item.dataset.path));
        });

        searchResultsContainer.addEventListener("mousemove", (e) => {
          const item = e.target.closest(".search-result-item");
          if (item && item.dataset.index !== undefined) {
            state.searchSelectedIndex = parseInt(item.dataset.index);
            updateSearchHighlight();
          }
        });

        document.addEventListener("click", (e) => {
          if (
            !headerSearch.contains(e.target) &&
            !searchResultsContainer.contains(e.target)
          ) {
            searchResultsContainer.classList.remove("show");
            state.searchSelectedIndex = -1;
          }
        });

        window.addEventListener("popstate", (e) => {





          restoreState(e.state || history.state);
        });

        window.addEventListener("hashchange", () => {

          if (!history.state || !history.state.type) {

            restoreStateFromURL(); // Fallback cho external links
          } else {

          }
        });

        window.lastProcessedUrl = window.location.href;
        let urlCheckInterval = null;

        function isPdfVisible() {
          const pdfViewer = document.getElementById('pdf-viewer');
          if (!pdfViewer) return false;
          const style = window.getComputedStyle(pdfViewer);
          return style.display !== 'none' && pdfViewer.src && pdfViewer.src !== '';
        }

        function checkUrlChange() {

          if (history.state && history.state.type) {

            return;
          }

          if (!isPdfVisible()) {

            return;
          }

          const currentUrl = window.location.href;
          if (currentUrl !== window.lastProcessedUrl) {

            window.lastProcessedUrl = currentUrl;
            restoreStateFromURL();
          }
        }

        function startUrlPolling() {

          if (urlCheckInterval) return;



          urlCheckInterval = setInterval(checkUrlChange, 300);
        }

        function stopUrlPolling() {
          if (urlCheckInterval) {

            clearInterval(urlCheckInterval);
            urlCheckInterval = null;
          }
        }

        let pollTimeout = null;
        document.addEventListener('mousemove', () => {
          startUrlPolling();

          checkUrlChange();

          clearTimeout(pollTimeout);
          pollTimeout = setTimeout(stopUrlPolling, 5000);
        });

        window.addEventListener('focus', () => {
          checkUrlChange();
          startUrlPolling();
        });

        window.addEventListener('blur', stopUrlPolling);

        document.addEventListener('visibilitychange', () => {
          if (!document.hidden) {
            checkUrlChange();
            startUrlPolling();
          } else {
            stopUrlPolling();
          }
        });

        window.addEventListener('pageshow', () => {
          checkUrlChange();
          startUrlPolling();
        });

        document.addEventListener('click', (e) => {


          checkUrlChange();
          startUrlPolling();
        }, true);


        startUrlPolling();

        document.querySelectorAll(".expand-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            openPopup(btn.dataset.target);
          });
        });

        popupCloseBtn.addEventListener("click", closePopup);

        window.addEventListener("resize", repositionPopup);

        document.querySelector('.header-tabs').addEventListener('click', (e) => {
          if (e.target.classList.contains('pdf-link-btn')) {
            const pdfName = e.target.getAttribute('data-pdf');

            if (pdfName) {

              const firstSelect = dynamicFiltersContainer.querySelector('select[data-level="1"]');
              if (firstSelect) {
                firstSelect.value = ""; // Reset về "-- Chọn --"
              }
              removeDropdowns(2); // Xóa cấp 2 trở lên

              document.getElementById("xmtt-ib-content").innerHTML = "<p>...</p>";
              const emailContent = document.getElementById("xmtt-email-content");
              if (emailContent) emailContent.innerHTML = "<p>...</p>";
              const chatContent = document.getElementById("xmtt-chat-content");
              if (chatContent) chatContent.innerHTML = "<p>...</p>";
              notesResult.innerHTML = "<p>Thông báo và lưu ý sẽ hiển thị ở đây</p>";
              const dieukienPanel = document.getElementById("dieukien-panel");
              if (dieukienPanel) dieukienPanel.classList.add("hidden");

              pdfViewer.src = `./pdfile-loan/${pdfName}`;
              pdfViewer.style.display = 'block';
              htmlViewer.style.display = 'none';

              history.pushState({ source: state.activeSourceName, headerPdf: pdfName }, "", `${window.location.pathname}?source=${state.activeSourceName}&pdf=${encodeURIComponent(pdfName)}`);
            }
          }
        });

        const scrollToTopBtn = document.getElementById('scroll-to-top');
        const scrollToBottomBtn = document.getElementById('scroll-to-bottom');

        if (scrollToTopBtn && scrollToBottomBtn) {
          scrollToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
          });

          scrollToBottomBtn.addEventListener('click', () => {
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
          });
        }

      }

      function displayResult(resultObject) {
        // Cập nhật title theo displayName của kết quả được chọn
        if (resultObject.displayName) {
          document.title = 'LOAN - ' + resultObject.displayName;
        } else {
          document.title = 'LOAN';
        }

        const subHeader = document.getElementById("sub-header");
        const xmttIbBox = document.getElementById("xmtt-ib-box");
        const xmttEmailBox = document.getElementById("xmtt-email-box");
        const xmttChatBox = document.getElementById("xmtt-chat-box");
        const notesBox = document.getElementById("notes-box");
        const xmttIbContent = document.getElementById("xmtt-ib-content");
        const xmttEmailContent = document.getElementById("xmtt-email-content");
        const xmttChatContent = document.getElementById("xmtt-chat-content");

        if (resultObject.hideSubHeader === true) {

          if (subHeader) subHeader.style.display = 'none';
        } else {

          const hasAnyContent = resultObject.xmttib || resultObject.xmttemail ||
            resultObject.xmttchat || resultObject.note || resultObject.xmtt;

          if (hasAnyContent) {
            if (subHeader) subHeader.style.display = '';
          } else {
            if (subHeader) subHeader.style.display = 'none';
          }

          if (resultObject.hideXmttIb === true || !resultObject.xmttib) {
            if (xmttIbBox) xmttIbBox.style.display = 'none';
          } else {
            if (xmttIbBox) xmttIbBox.style.display = '';
            xmttIbContent.innerHTML = `<p>${resultObject.xmttib}</p>`;
          }

          if (resultObject.hideXmttEmail === true || !resultObject.xmttemail) {
            if (xmttEmailBox) xmttEmailBox.style.display = 'none';
          } else {
            if (xmttEmailBox) xmttEmailBox.style.display = '';
            if (xmttEmailContent)
              xmttEmailContent.innerHTML = `<p>${resultObject.xmttemail}</p>`;
          }

          if (resultObject.hideXmttChat === true || !resultObject.xmttchat) {
            if (xmttChatBox) xmttChatBox.style.display = 'none';
          } else {
            if (xmttChatBox) xmttChatBox.style.display = '';
            if (xmttChatContent)
              xmttChatContent.innerHTML = `<p>${resultObject.xmttchat}</p>`;
          }

          if (resultObject.hideNotes === true || !resultObject.note) {
            if (notesBox) notesBox.style.display = 'none';
          } else {
            if (notesBox) notesBox.style.display = '';
            notesResult.innerHTML = `<p>${resultObject.note}</p>`;
          }

          if (resultObject.xmtt) {

            if (xmttIbBox) xmttIbBox.style.display = '';
            if (xmttEmailBox) xmttEmailBox.style.display = '';
            if (xmttChatBox) xmttChatBox.style.display = '';
            xmttIbContent.innerHTML = `<p>${resultObject.xmtt}</p>`;
            if (xmttEmailContent)
              xmttEmailContent.innerHTML = `<p>${resultObject.xmtt}</p>`;
            if (xmttChatContent)
              xmttChatContent.innerHTML = `<p>${resultObject.xmtt}</p>`;
            if (subHeader) subHeader.style.display = '';
          }
        }

        displayConditionInfo(resultObject.dieukien);

        updatePopupIfOpen();

        const contentType = resultObject.contentType || (resultObject.pdf ? 'pdf' : null);

        pdfViewer.style.display = 'none';
        htmlViewer.style.display = 'none';
        pdfViewer.src = '';
        htmlViewer.innerHTML = '';

        if (contentType === 'html' && resultObject.htmlContent) {

          htmlViewer.innerHTML = resultObject.htmlContent;
          htmlViewer.style.display = 'block';
        } else if (contentType === 'htmlUrl' && resultObject.htmlUrl) {

          pdfViewer.src = resultObject.htmlUrl;
          pdfViewer.style.display = 'block';
        } else if (resultObject.pdf) {

          const firstLevelSelect = dynamicFiltersContainer.querySelector(
            'select[data-level="1"]'
          );
          const categoryIndexMatch = firstLevelSelect?.value.match(/^(\d+)/);
          const folderMap = FOLDER_MAPS[state.activeSourceName];
          let folderName =
            categoryIndexMatch && folderMap
              ? folderMap[categoryIndexMatch[1]]
              : null;

          if (!folderName && firstLevelSelect?.value) {
            // Fallback: If value matches a value in folderMap
            if (folderMap && Object.values(folderMap).includes(firstLevelSelect.value)) {
              folderName = firstLevelSelect.value;
            } else {
              // Fallback: Use value as folder name (sanitized if needed, or raw)
              // This supports keys that ARE the folder name (e.g. "1_THONG_TIN_CHUNG")
              folderName = firstLevelSelect.value;
            }
          }
          const baseFolder =
            state.activeSourceName === "feedback"
              ? "pdfile-loan-fb"
              : "pdfile-loan";

          if (folderName) {
            pdfViewer.src = `./${baseFolder}/${folderName}/${resultObject.pdf}`;
          } else {

            pdfViewer.src = `./${baseFolder}/${resultObject.pdf}`;
          }
          pdfViewer.style.display = 'block';
        }

        if (resultObject.alert) {
          (Array.isArray(resultObject.alert)
            ? resultObject.alert
            : [resultObject.alert]
          ).forEach((msg) => showNotification(msg));
        }

        if (typeof window.updateXmttHandleVisibility === 'function') {
          window.updateXmttHandleVisibility();
        }
      }

      function showNotification(message) {
        if (!toastContainer) return;
        const toast = document.createElement("div");
        toast.className = "notification-toast show";
        toast.innerHTML = `<p>${message}</p><button class="toast-close">✕</button>`;
        toast.querySelector(".toast-close").onclick = () => {
          toast.classList.remove("show");
          setTimeout(() => toast.remove(), 400);
        };
        toastContainer.appendChild(toast);
      }

      function resetResults(showDefault = false) {
        // Reset title về mặc định khi không có kết quả
        document.title = 'LOAN';

        const xmttIbBox = document.getElementById("xmtt-ib-box");
        const xmttEmailBox = document.getElementById("xmtt-email-box");
        const xmttChatBox = document.getElementById("xmtt-chat-box");
        const notesBox = document.getElementById("notes-box");
        const subHeader = document.getElementById("sub-header");

        if (xmttIbBox) xmttIbBox.style.display = 'none';
        if (xmttEmailBox) xmttEmailBox.style.display = 'none';
        if (xmttChatBox) xmttChatBox.style.display = 'none';
        if (notesBox) notesBox.style.display = 'none';

        if (subHeader) subHeader.style.display = 'none';

        document.getElementById("xmtt-ib-content").innerHTML = "";
        const emailContent = document.getElementById("xmtt-email-content");
        if (emailContent) emailContent.innerHTML = "";
        const chatContent = document.getElementById("xmtt-chat-content");
        if (chatContent) chatContent.innerHTML = "";
        notesResult.innerHTML = "";

        const dieukienPanel = document.getElementById("dieukien-panel");
        if (dieukienPanel) dieukienPanel.classList.add("hidden");

        if (showDefault) {
          showDefaultContent();
        } else {

          pdfViewer.src = "";
          pdfViewer.style.display = 'none';
          htmlViewer.innerHTML = "";
          htmlViewer.style.display = 'none';
        }
      }

      function showDefaultContent() {
        if (!DEFAULT_CONTENT) return;

        if (DEFAULT_CONTENT.type === 'pdf' && DEFAULT_CONTENT.pdf) {
          pdfViewer.src = DEFAULT_CONTENT.pdf;
          pdfViewer.style.display = 'block';
          htmlViewer.style.display = 'none';
        } else if (DEFAULT_CONTENT.type === 'html' && DEFAULT_CONTENT.htmlUrl) {
          pdfViewer.src = DEFAULT_CONTENT.htmlUrl;
          pdfViewer.style.display = 'block';
          htmlViewer.style.display = 'none';
        } else if (DEFAULT_CONTENT.type === 'html' && DEFAULT_CONTENT.htmlContent) {
          htmlViewer.innerHTML = DEFAULT_CONTENT.htmlContent;
          htmlViewer.style.display = 'block';
          pdfViewer.style.display = 'none';
        } else {
          pdfViewer.src = "";
          pdfViewer.style.display = 'none';
          htmlViewer.innerHTML = "";
          htmlViewer.style.display = 'none';
        }
      }

      /**
       * Hiển thị thông tin từ header PDF link vào các box XMTT, Notes, Điều kiện
       * Hàm này được sử dụng khi click vào các link PDF trong header (có class .pdf-link-btn)
       * @param {Object} data - Object chứa dieukien, note, xmttib, xmttchat, xmttemail
       */
      function showHeaderInfo(data) {
        const subHeader = document.getElementById('sub-header');
        const dieukienPanel = document.getElementById('dieukien-panel');

        const xmttIbBox = document.getElementById('xmtt-ib-box');
        const xmttChatBox = document.getElementById('xmtt-chat-box');
        const xmttEmailBox = document.getElementById('xmtt-email-box');
        const notesBox = document.getElementById('notes-box');

        const xmttIbContent = document.getElementById('xmtt-ib-content');
        const xmttChatContent = document.getElementById('xmtt-chat-content');
        const xmttEmailContent = document.getElementById('xmtt-email-content');
        const notesResult = document.getElementById('notes-result');
        const dieukienResult = document.getElementById('dieukien-result');

        if (xmttIbBox) xmttIbBox.style.display = 'none';
        if (xmttChatBox) xmttChatBox.style.display = 'none';
        if (xmttEmailBox) xmttEmailBox.style.display = 'none';
        if (notesBox) notesBox.style.display = 'none';
        if (dieukienPanel) dieukienPanel.classList.add('hidden');

        let hasAnyBox = false;

        if (data.xmttib) {
          if (xmttIbBox) xmttIbBox.style.display = '';
          xmttIbContent.innerHTML = `<p>${data.xmttib}</p>`;
          hasAnyBox = true;
        }

        if (data.xmttchat) {
          if (xmttChatBox) xmttChatBox.style.display = '';
          xmttChatContent.innerHTML = `<p>${data.xmttchat}</p>`;
          hasAnyBox = true;
        }

        if (data.xmttemail) {
          if (xmttEmailBox) xmttEmailBox.style.display = '';
          xmttEmailContent.innerHTML = `<p>${data.xmttemail}</p>`;
          hasAnyBox = true;
        }

        if (data.note) {
          if (notesBox) notesBox.style.display = '';
          notesResult.innerHTML = `<p>${data.note}</p>`;
          hasAnyBox = true;
        }

        if (subHeader && hasAnyBox) {
          subHeader.style.display = '';
        } else if (subHeader) {
          subHeader.style.display = 'none';
        }

        if (data.dieukien) {
          if (dieukienPanel) dieukienPanel.classList.remove('hidden');
          dieukienResult.innerHTML = `<p>${data.dieukien}</p>`;
        }

        if (typeof window.updateXmttHandleVisibility === 'function') {
          window.updateXmttHandleVisibility();
        }
      }

      /**
       * Xử lý sự kiện click vào PDF link trong header
       * Đọc data attributes và hiển thị thông tin vào các box tương ứng
       */
      document.addEventListener('click', function (e) {

        const btn = e.target.closest('.pdf-link-btn');
        if (!btn) return;

        const isInHeader = btn.closest('#main-header');
        if (!isInHeader) return;

        e.preventDefault();

        // Lấy preset key từ data-preset
        const presetKey = btn.dataset.preset;
        let pdfName = btn.dataset.pdf;
        let dieukien = btn.dataset.dieukien || '';
        let note = btn.dataset.note || '';
        let xmttib = btn.dataset.xmttib || '';
        let xmttchat = btn.dataset.xmttchat || '';
        let xmttemail = btn.dataset.xmttemail || '';
        let displayName = '';

        // Nếu có preset key, lấy thông tin từ HEADER_PRESETS
        if (presetKey && window.HEADER_PRESETS && window.HEADER_PRESETS[presetKey]) {
          const preset = window.HEADER_PRESETS[presetKey];
          pdfName = preset.pdf || pdfName;
          dieukien = preset.dieukien || dieukien;
          note = preset.note || note;
          xmttib = preset.xmttib || xmttib;
          xmttchat = preset.xmttchat || xmttchat;
          xmttemail = preset.xmttemail || xmttemail;
          displayName = preset.displayName || '';
        }

        if (!pdfName) return; // Không có PDF name thì không làm gì

        navigateTo('header-pdf', {
          pdfName: pdfName,
          dieukien: dieukien,
          note: note,
          xmttib: xmttib,
          xmttchat: xmttchat,
          xmttemail: xmttemail,
          displayName: displayName // Truyền displayName để cập nhật title
        });

        if (typeof window.lastProcessedUrl !== 'undefined') {
          window.lastProcessedUrl = window.location.href;
        }
      });

      /**
       * APPROACH 3 & 4: Session Storage Sync & Auto-Restore
       * Liên tục backup state vào sessionStorage và auto-restore khi cần
       */

      function syncStateToSessionStorage() {
        try {
          const state = {
            url: window.location.href,
            search: window.location.search,
            hash: window.location.hash,
            timestamp: Date.now()
          };
          sessionStorage.setItem('appLastState', JSON.stringify(state));
        } catch (e) {

        }
      }

      window.addEventListener('beforeunload', () => {
        syncStateToSessionStorage();
      });

      window.addEventListener('popstate', () => {
        syncStateToSessionStorage();
      });

      (function autoRestoreState() {
        try {
          const urlParams = new URLSearchParams(window.location.search);
          const hasParams = urlParams.toString().length > 0;

          if (!hasParams) {
            const savedStateStr = sessionStorage.getItem('appLastState');
            if (savedStateStr) {
              const savedState = JSON.parse(savedStateStr);
              const timeDiff = Date.now() - savedState.timestamp;

              if (timeDiff < 5000 && savedState.search) {


                window.location.replace(window.location.pathname + savedState.search);
                return; // Stop execution, page will reload
              }
            }
          }

          if (hasParams) {
            syncStateToSessionStorage();
          }
        } catch (e) {

        }
      })();

      /**
       * APPROACH 2: Hash-Based State Management
       * ✨ DISABLED: Conflicts with new navigateTo() system
       * syncStateToHash() tạo format #state=... cũ, không tương thích với format mới #pdf=... và #source=...&s=...
       */
      function syncStateToHash() {


      }

      function restoreStateFromHash() {


        return false;
      }

      if (!restoreStateFromHash()) {

      }

      function removeDropdowns(startLevel) {
        dynamicFiltersContainer
          .querySelectorAll(".filter-group")
          .forEach((group) => {
            const select = group.querySelector("select");
            if (parseInt(select.dataset.level) >= startLevel) group.remove();
          });
      }

      initialize();
    });
  </script>

  <!-- Initialize OverlayScrollbars for custom scrollbar -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      try {
        if (typeof OverlayScrollbarsGlobal !== 'undefined') {
          const { OverlayScrollbars } = OverlayScrollbarsGlobal;
          OverlayScrollbars(document.body, {
            scrollbars: { theme: 'os-theme-dark', autoHide: 'never', visibility: 'visible' }
          });
          document.querySelectorAll('.box-content, #dieukien-result').forEach(function (el) {
            OverlayScrollbars(el, {
              scrollbars: { theme: 'os-theme-dark', autoHide: 'never', visibility: 'visible' }
            });
          });
        }
      } catch (e) {

      }
    });
  </script>

  <script>

    var LZString = function () { var r = String.fromCharCode, o = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$", e = {}; function t(r, o) { if (!e[r]) { e[r] = {}; for (var n = 0; n < r.length; n++)e[r][r.charAt(n)] = n } return e[r][o] } var i = { compressToBase64: function (r) { if (null == r) return ""; var n = i._compress(r, 6, function (r) { return o.charAt(r) }); switch (n.length % 4) { default: case 0: return n; case 1: return n + "==="; case 2: return n + "=="; case 3: return n + "=" } }, decompressFromBase64: function (r) { return null == r ? "" : "" == r ? null : i._decompress(r.length, 32, function (n) { return t(o, r.charAt(n)) }) }, compressToUTF16: function (o) { return null == o ? "" : i._compress(o, 15, function (o) { return r(o + 32) }) + " " }, decompressFromUTF16: function (r) { return null == r ? "" : "" == r ? null : i._decompress(r.length, 16384, function (o) { return r.charCodeAt(o) - 32 }) }, compressToUint8Array: function (r) { for (var o = i.compress(r), n = new Uint8Array(2 * o.length), e = 0, t = o.length; e < t; e++) { var s = o.charCodeAt(e); n[2 * e] = s >>> 8, n[2 * e + 1] = s % 256 } return n }, decompressFromUint8Array: function (o) { if (null == o) return i.decompress(o); for (var n = new Array(o.length / 2), e = 0, t = n.length; e < t; e++)n[e] = 256 * o[2 * e] + o[2 * e + 1]; var s = []; return n.forEach(function (o) { s.push(r(o)) }), i.decompress(s.join("")) }, compressToEncodedURIComponent: function (r) { return null == r ? "" : i._compress(r, 6, function (r) { return n.charAt(r) }) }, decompressFromEncodedURIComponent: function (r) { return null == r ? "" : "" == r ? null : (r = r.replace(/ /g, "+"), i._decompress(r.length, 32, function (o) { return t(n, r.charAt(o)) })) }, compress: function (o) { return i._compress(o, 16, function (o) { return r(o) }) }, _compress: function (r, o, n) { if (null == r) return ""; var e, t, i, s = {}, u = {}, a = "", p = "", c = "", l = 2, f = 3, h = 2, d = [], m = 0, v = 0; for (i = 0; i < r.length; i += 1)if (a = r.charAt(i), Object.prototype.hasOwnProperty.call(s, a) || (s[a] = f++, u[a] = !0), p = c + a, Object.prototype.hasOwnProperty.call(s, p)) c = p; else { if (Object.prototype.hasOwnProperty.call(u, c)) { if (c.charCodeAt(0) < 256) { for (e = 0; e < h; e++)m <<= 1, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++; for (t = c.charCodeAt(0), e = 0; e < 8; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1 } else { for (t = 1, e = 0; e < h; e++)m = m << 1 | t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t = 0; for (t = c.charCodeAt(0), e = 0; e < 16; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1 } 0 == --l && (l = Math.pow(2, h), h++), delete u[c] } else for (t = s[c], e = 0; e < h; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1; 0 == --l && (l = Math.pow(2, h), h++), s[p] = f++, c = String(a) } if ("" !== c) { if (Object.prototype.hasOwnProperty.call(u, c)) { if (c.charCodeAt(0) < 256) { for (e = 0; e < h; e++)m <<= 1, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++; for (t = c.charCodeAt(0), e = 0; e < 8; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1 } else { for (t = 1, e = 0; e < h; e++)m = m << 1 | t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t = 0; for (t = c.charCodeAt(0), e = 0; e < 16; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1 } 0 == --l && (l = Math.pow(2, h), h++), delete u[c] } else for (t = s[c], e = 0; e < h; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1; 0 == --l && (l = Math.pow(2, h), h++) } for (t = 2, e = 0; e < h; e++)m = m << 1 | 1 & t, v == o - 1 ? (v = 0, d.push(n(m)), m = 0) : v++, t >>= 1; for (; ;) { if (m <<= 1, v == o - 1) { d.push(n(m)); break } v++ } return d.join("") }, decompress: function (r) { return null == r ? "" : "" == r ? null : i._decompress(r.length, 32768, function (o) { return r.charCodeAt(o) }) }, _decompress: function (o, n, e) { var t, i, s, u, a, p, c, l = [], f = 4, h = 4, d = 3, m = "", v = [], g = { val: e(0), position: n, index: 1 }; for (t = 0; t < 3; t += 1)l[t] = t; for (s = 0, a = Math.pow(2, 2), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; switch (s) { case 0: for (s = 0, a = Math.pow(2, 8), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; c = r(s); break; case 1: for (s = 0, a = Math.pow(2, 16), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; c = r(s); break; case 2: return "" }for (l[3] = c, i = c, v.push(c); ;) { if (g.index > o) return ""; for (s = 0, a = Math.pow(2, d), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; switch (c = s) { case 0: for (s = 0, a = Math.pow(2, 8), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; l[h++] = r(s), c = h - 1, f--; break; case 1: for (s = 0, a = Math.pow(2, 16), p = 1; p != a;)u = g.val & g.position, g.position >>= 1, 0 == g.position && (g.position = n, g.val = e(g.index++)), s |= (u > 0 ? 1 : 0) * p, p <<= 1; l[h++] = r(s), c = h - 1, f--; break; case 2: return v.join("") }if (0 == f && (f = Math.pow(2, d), d++), l[c]) m = l[c]; else { if (c !== h) return null; m = i + i.charAt(0) } v.push(m), l[h++] = i + m.charAt(0), i = m, 0 == --f && (f = Math.pow(2, d), d++) } } }; return i }();
  </script>

  <!-- Resizable XMTT Boxes Script -->
  <!-- Resizable XMTT Boxes Script -->
  <script>

    window.initXmttResize = function (forceReset = false) {

      if (typeof window._internalInitXmttResize === 'function') {
        window._internalInitXmttResize(forceReset);
      }
    };

    document.addEventListener('DOMContentLoaded', function () {
      const xmttRow = document.getElementById('xmtt-row');
      if (!xmttRow) return;

      const boxes = xmttRow.querySelectorAll('.sub-header-box');
      const handles = xmttRow.querySelectorAll('.resize-handle');

      if (boxes.length !== 3 || handles.length !== 2) return;

      let isResizing = false;
      let currentHandle = null;
      let startX = 0;
      let startFlexValues = [];
      let visibleBoxes = [];
      let visibleHandles = [];
      const minFlex = 0.15; // Minimum flex ratio (15%)
      const handleWidth = 8; // Width of resize handle

      function getVisibleBoxes() {
        return Array.from(boxes).filter(box => {

          return box.style.display !== 'none';
        });
      }

      function getVisibleHandles() {
        const visible = [];
        handles.forEach((handle, index) => {

          if (handle.style.display !== 'none') {
            visible.push({ handle, index });
          }
        });
        return visible;
      }

      window._internalInitXmttResize = function (forceReset) {

        visibleBoxes = getVisibleBoxes();

        updateHandleVisibility(forceReset);
      };

      function setFlexValues(values) {
        const total = values.reduce((a, b) => a + b, 0);
        visibleBoxes.forEach((box, i) => {
          const normalizedFlex = values[i] / total;
          box.style.flex = `${normalizedFlex} 1 0`;
        });
      }

      function updateHandleVisibility(forceReset) {
        visibleBoxes = getVisibleBoxes();
        const currentVisibleCount = visibleBoxes.length;

        if (currentVisibleCount <= 1) {
          xmttRow.classList.add('single-box');
        } else {
          xmttRow.classList.remove('single-box');
        }

        if (forceReset || currentVisibleCount > 0) {
          const hasFlexSet = visibleBoxes.every(b => b.style.flexGrow);
          if (forceReset || !hasFlexSet) {
            const equalFlex = 1 / Math.max(1, currentVisibleCount);
            visibleBoxes.forEach(box => {
              box.style.flex = `${equalFlex} 1 0`;
            });
          }
        }

        handles.forEach(h => h.style.display = 'none');

        if (currentVisibleCount < 2) return;

        const visibleIndices = [];
        boxes.forEach((box, idx) => {
          if (box.style.display !== 'none') visibleIndices.push(idx);
        });

        for (let i = 0; i < visibleIndices.length - 1; i++) {
          const leftIdx = visibleIndices[i];
          const rightIdx = visibleIndices[i + 1];

          if (leftIdx === 0) handles[0].style.display = '';
          else if (leftIdx === 1) handles[1].style.display = '';
        }
      }

      handles.forEach((handle, handleIndex) => {
        handle.addEventListener('mousedown', function (e) {
          visibleBoxes = getVisibleBoxes();
          visibleHandles = getVisibleHandles();

          if (visibleBoxes.length < 2) return;

          let visibleSplitIndex = -1;

          const currentVisibleHandleObj = visibleHandles.find(vh => vh.handle === handle);
          if (!currentVisibleHandleObj) return;

          const gapIndex = visibleHandles.indexOf(currentVisibleHandleObj);

          isResizing = true;
          currentHandle = gapIndex; // 0 means gap between visibleBox[0] and visibleBox[1]
          startX = e.clientX;

          const totalWidth = xmttRow.offsetWidth - (visibleHandles.length * handleWidth);
          startFlexValues = visibleBoxes.map(box => box.offsetWidth / totalWidth);

          document.body.classList.add('resizing');
          xmttRow.classList.add('resizing');
          e.preventDefault();
        });
      });

      window.addEventListener('mousemove', function (e) {
        if (!isResizing || currentHandle === null) return;

        const totalWidth = xmttRow.offsetWidth - (visibleHandles.length * handleWidth);
        const deltaX = e.clientX - startX;
        const deltaPercent = deltaX / totalWidth;

        const leftBoxIndex = currentHandle;
        const rightBoxIndex = currentHandle + 1;

        if (!visibleBoxes[leftBoxIndex] || !visibleBoxes[rightBoxIndex]) return;

        const newLeftFlex = startFlexValues[leftBoxIndex] + deltaPercent;
        const newRightFlex = startFlexValues[rightBoxIndex] - deltaPercent;

        if (newLeftFlex >= minFlex && newRightFlex >= minFlex) {

          const newFlexValues = [...startFlexValues];
          newFlexValues[leftBoxIndex] = newLeftFlex;
          newFlexValues[rightBoxIndex] = newRightFlex;

          setFlexValues(newFlexValues);
        }
      });

      window.addEventListener('mouseup', function () {
        if (isResizing) {
          isResizing = false;
          currentHandle = null;
          document.body.classList.remove('resizing');
          xmttRow.classList.remove('resizing');
        }
      });

      const resizeObserver = new ResizeObserver(() => {
        if (!isResizing) window._internalInitXmttResize();
      });
      resizeObserver.observe(xmttRow);

      window._internalInitXmttResize(true);
    });

    window.addEventListener('load', () => {
      if (window.initXmttResize) window.initXmttResize(true);
    });

    // === APPLY PRESETS ===
    // Tự động apply preset vào data attributes khi DOM ready
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('[data-preset]').forEach(el => {
        const preset = HEADER_PRESETS[el.dataset.preset];
        if (!preset) return;

        // Apply tất cả properties từ preset vào data-* attributes
        if (preset.pdf) el.dataset.pdf = preset.pdf;
        if (preset.contentType) el.dataset.contentType = preset.contentType;
        if (preset.htmlContent) el.dataset.htmlContent = preset.htmlContent;
        if (preset.htmlUrl) el.dataset.htmlUrl = preset.htmlUrl;
        if (preset.dieukien) el.dataset.dieukien = preset.dieukien;
        if (preset.note) el.dataset.note = preset.note;
        if (preset.alert) el.dataset.alert = preset.alert;
        if (preset.xmttib) el.dataset.xmttib = preset.xmttib;
        if (preset.xmttchat) el.dataset.xmttchat = preset.xmttchat;
        if (preset.xmttemail) el.dataset.xmttemail = preset.xmttemail;
        if (preset.xmtt) el.dataset.xmtt = preset.xmtt;
        if (preset.displayName) el.dataset.displayName = preset.displayName;
        if (preset.tieudeflow) el.dataset.tieudeflow = preset.tieudeflow;
      });
    });
  </script>


  <!-- AUTO-INJECTED CUSTOM POPUP LOGIC -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // 1. Create Modal Markup if not exists
      if (!document.getElementById('custom-popup-modal')) {
        const modalHtml = `
                <div id="custom-popup-modal" class="custom-modal-overlay">
                    <div class="custom-modal-content">
                        <div class="custom-modal-header">
                            <h3>Chi tiết</h3>
                            <span class="custom-modal-close" style="font-size: 28px; cursor: pointer;">&times;</span>
                        </div>
                        <div class="custom-modal-body" id="custom-popup-body">
                            <!-- Content -->
                        </div>
                    </div>
                </div>
            `;
        document.body.insertAdjacentHTML('beforeend', modalHtml);

        // Close event
        const closeBtn = document.querySelector('.custom-modal-close');
        if (closeBtn) {
          closeBtn.addEventListener('click', function () {
            document.getElementById('custom-popup-modal').classList.remove('show');
          });
        }

        // Click outside to close
        const modal = document.getElementById('custom-popup-modal');
        if (modal) {
          modal.addEventListener('click', function (e) {
            if (e.target === this) {
              this.classList.remove('show');
            }
          });
        }
      }

      // 2. Delegate click event for popups
      document.body.addEventListener('click', function (e) {
        const target = e.target.closest('.custom-popup');
        if (target) {
          let content = target.getAttribute('data-popup-content');
          if (content) {
            try {
              content = decodeURIComponent(content);
            } catch (e) {
              // console.warn('Content not encoded:', e);
            }

            const body = document.getElementById('custom-popup-body');
            const modal = document.getElementById('custom-popup-modal');
            if (body && modal) {
              body.innerHTML = content;
              modal.classList.add('show');
            }
          }
        }
      });
    });
  </script>
</body>

</html>